import{m as re,a,i as Q,s as Pe,c as l,R as E,b as t,S as ae,Q as ke,F as C,r as j,t as Ce,f as d,d as we,o as $e,D as le,z as se,E as je,A as Be,l as Ee,w as Ue,e as H,u as Ae,h as f,p as D,n as ie,q as Re}from"./vendor-tiptap-BMQcrX0l.js";import{t as De}from"./tippy.esm-CnBRltuW.js";const Se={emits:["pagination-change-page"],props:{data:{type:Object,default:()=>{}},limit:{type:Number,default:0},keepLength:{type:Boolean,default:!1}},computed:{isApiResource(){return!!this.data.meta},currentPage(){var n;return this.isApiResource?this.data.meta.current_page:(n=this.data.current_page)!=null?n:null},firstPageUrl(){var n,c,r,i,g;return(g=(i=(c=this.data.first_page_url)!=null?c:(n=this.data.meta)==null?void 0:n.first_page_url)!=null?i:(r=this.data.links)==null?void 0:r.first)!=null?g:null},from(){var n;return this.isApiResource?this.data.meta.from:(n=this.data.from)!=null?n:null},lastPage(){var n;return this.isApiResource?this.data.meta.last_page:(n=this.data.last_page)!=null?n:null},lastPageUrl(){var n,c,r,i,g;return(g=(i=(c=this.data.last_page_url)!=null?c:(n=this.data.meta)==null?void 0:n.last_page_url)!=null?i:(r=this.data.links)==null?void 0:r.last)!=null?g:null},nextPageUrl(){var n,c,r,i,g;return(g=(i=(c=this.data.next_page_url)!=null?c:(n=this.data.meta)==null?void 0:n.next_page_url)!=null?i:(r=this.data.links)==null?void 0:r.next)!=null?g:null},perPage(){var n;return this.isApiResource?this.data.meta.per_page:(n=this.data.per_page)!=null?n:null},prevPageUrl(){var n,c,r,i,g;return(g=(i=(c=this.data.prev_page_url)!=null?c:(n=this.data.meta)==null?void 0:n.prev_page_url)!=null?i:(r=this.data.links)==null?void 0:r.prev)!=null?g:null},to(){var n;return this.isApiResource?this.data.meta.to:(n=this.data.to)!=null?n:null},total(){var n;return this.isApiResource?this.data.meta.total:(n=this.data.total)!=null?n:null},pageRange(){if(this.limit===-1)return 0;if(this.limit===0)return this.lastPage;for(var n=this.currentPage,c=this.keepLength,r=this.lastPage,i=this.limit,g=n-i,y=n+i,_=(i+2)*2,v=(i+2)*2-1,k=[],x=[],m,h=1;h<=r;h++)(h===1||h===r||h>=g&&h<=y||c&&h<_&&n<_-2||c&&h>r-v&&n>r-v+2)&&k.push(h);return k.forEach(function(P){m&&(P-m===2?x.push(m+1):P-m!==1&&x.push("...")),x.push(P),m=P}),x}},methods:{previousPage(){this.selectPage(this.currentPage-1)},nextPage(){this.selectPage(this.currentPage+1)},selectPage(n){n==="..."||n===this.currentPage||this.$emit("pagination-change-page",n)}},render(){return this.$slots.default({data:this.data,limit:this.limit,computed:{isApiResource:this.isApiResource,currentPage:this.currentPage,firstPageUrl:this.firstPageUrl,from:this.from,lastPage:this.lastPage,lastPageUrl:this.lastPageUrl,nextPageUrl:this.nextPageUrl,perPage:this.perPage,prevPageUrl:this.prevPageUrl,to:this.to,total:this.total,pageRange:this.pageRange},prevButtonEvents:{click:n=>{n.preventDefault(),this.previousPage()}},nextButtonEvents:{click:n=>{n.preventDefault(),this.nextPage()}},pageButtonEvents:n=>({click:c=>{c.preventDefault(),this.selectPage(n)}})})}},ze=(n,c)=>{const r=n.__vccOpts||n;for(const[i,g]of c)r[i]=g;return r},Oe={compatConfig:{MODE:3},inheritAttrs:!1,emits:["pagination-change-page"],components:{RenderlessPagination:Se},props:{data:{type:Object,default:()=>{}},limit:{type:Number,default:0},keepLength:{type:Boolean,default:!1},itemClasses:{type:Array,default:()=>["bg-white","text-gray-500","border-gray-300","hover:bg-gray-50"]},activeClasses:{type:Array,default:()=>["bg-blue-50","border-blue-500","text-blue-600"]}},methods:{onPaginationChangePage(n){this.$emit("pagination-change-page",n)}}},qe=["disabled"],Fe=t("span",{class:"sr-only"},"Previous",-1),Ie=t("svg",{class:"w-5 h-5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})],-1),Ne=["aria-current","disabled"],Ge=["disabled"],Qe=t("span",{class:"sr-only"},"Next",-1),Ve=t("svg",{class:"w-5 h-5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})],-1);function Je(n,c,r,i,g,y){const _=re("RenderlessPagination");return a(),Q(_,{data:r.data,limit:r.limit,"keep-length":r.keepLength,onPaginationChangePage:y.onPaginationChangePage},{default:Pe(v=>[v.computed.total>v.computed.perPage?(a(),l("nav",E({key:0},n.$attrs,{class:"inline-flex -space-x-px rounded-md shadow-sm isolate ltr:flex-row rtl:flex-row-reverse","aria-label":"Pagination"}),[t("button",E({class:["relative inline-flex items-center px-2 py-2 text-sm font-medium border rounded-l-md focus:z-20 disabled:opacity-50",r.itemClasses],disabled:!v.computed.prevPageUrl},ae(v.prevButtonEvents,!0)),[ke(n.$slots,"prev-nav",{},()=>[Fe,Ie])],16,qe),(a(!0),l(C,null,j(v.computed.pageRange,(k,x)=>(a(),l("button",E({class:["relative inline-flex items-center px-4 py-2 text-sm font-medium border focus:z-20",[k==v.computed.currentPage?r.activeClasses:r.itemClasses,k==v.computed.currentPage?"z-30":""]],"aria-current":v.computed.currentPage?"page":null,key:x},ae(v.pageButtonEvents(k),!0),{disabled:k===v.computed.currentPage}),Ce(k),17,Ne))),128)),t("button",E({class:["relative inline-flex items-center px-2 py-2 text-sm font-medium border rounded-r-md focus:z-20 disabled:opacity-50",r.itemClasses],disabled:!v.computed.nextPageUrl},ae(v.nextButtonEvents,!0)),[ke(n.$slots,"next-nav",{},()=>[Qe,Ve])],16,Ge)],16)):d("",!0)]),_:3},8,["data","limit","keep-length","onPaginationChangePage"])}const Ke=ze(Oe,[["render",Je]]),We={key:0,class:"flex flex-col gap-4 w-full"},Xe={class:"flex gap-2 justify-between items-center"},Ye=["innerHTML"],Ze={key:1,class:"flex flex-col gap-4 w-full"},et={class:"flex gap-2 justify-between items-center flex-wrap"},tt={class:"flex gap-1 items-center flex-wrap"},nt=["innerHTML"],at={key:0,class:"bg-base-200 flex items-stretch gap-1 rounded-xl"},lt=["aria-label","title"],st=["title"],it=["aria-label"],rt=["href"],ot={key:1},ut=["aria-label","title"],dt=["innerHTML"],ct=["innerHTML"],pt=["innerHTML"],ft={key:0,class:"flex gap-2 items-center"},vt={key:0,class:"btn2"},gt={key:1},ht=["title"],mt={key:2},yt={key:0,class:"btn2"},bt=["title"],xt=["innerHTML"],kt=["title"],wt=["innerHTML"],Lt={key:3},Mt=["title"],_t=["innerHTML"],Tt=["title"],Ht=["innerHTML"],Pt={key:4,class:"join"},Ct=["href"],$t=["innerHTML"],jt={key:0},Bt=["innerHTML"],Et={key:0,class:"dropdown-menu absolute mt-2 flex flex-col gap-1 right-0 bg-base-200 shadow-sm p-2 rounded z-10",role:"menu",id:"templates-submenu"},Ut=["href"],At=["innerHTML"],Rt={href:"https://docs.kanka.io/en/latest/guides/archetypes.html",class:"flex flex-no-wrap gap-2 px-2 py-1 items-center"},Dt=["innerHTML"],St={key:1,class:"flex gap-2 items-center"},zt={class:"join"},Ot=["innerHTML"],qt=["innerHTML"],Ft={key:2},It=["innerHTML"],Nt={class:"flex gap-1 items-start"},Gt=["href"],Qt={class:"block text-center p-4 h-12 bg-box"},Vt=["innerHTML"],Jt=["href"],Kt={class:""},Wt=["innerHTML"],Xt={key:0,class:"flex items-center justify-end gap-1 h-12"},Yt={key:1,class:"flex items-center"},Zt=["innerHTML"],en=["innerHTML"],tn=["innerHTML"],nn=["innerHTML"],an=["href"],ln=["innerHTML"],sn={key:0,class:"m-0"},rn={href:"https://docs.kanka.io/en/latest/guides/templates.html",class:"px-2 py-2 hover:bg-base-200 rounded-xl flex items-center gap-1.5 transition-all duration-150 text-base-content text-sm"},on=["innerHTML"],un=["innerHTML"],dn=["innerHTML"],cn=["innerHTML"],pn=["innerHTML"],fn=["innerHTML"],vn=["innerHTML"],gn=["action"],hn=["value"],mn=["value"],yn=we({__name:"Explorer",props:{api:{},module:{},mode:{}},setup(n){const c=n,r=f([]),i=f(),g=f(),y=f(),_=f(),v=f(),k=f(),x=f(),m=f({}),h=f(0),P=f(0),U=f(),S=f(!0),A=f(!1),z=f(!1),T=f(!1),o=f(!0),b=f([]),O=f(),w=f(),ue=f(),de=f(),I=f(),ce=f(),V=f(),$=f(!1),u=f({}),pe=f(!1),B=f("grid");$e(()=>{B.value=c.mode,fetch(c.api).then(s=>s.json()).then(s=>{me(s),h.value=s.filters.unfilteredCount,P.value=s.filters.count,U.value=s.filters.urls,u.value=s.i18n,o.value=s.nested,i.value=s.parent,b.value=s.templates,y.value=s.permissions,pe.value=s.bookmarkable,m.value=s.urls,v.value=s.entityType,ye()})});const fe=()=>{$.value=!$.value,r.value.forEach(s=>{s.selected=!1})},Le=()=>{if(!r.value.length)return;const s=!r.value[0].selected;r.value.forEach(e=>{e.selected=s})},ve=()=>{window.openDialog("datagrid-filters",U.value.form)},R=s=>{I.value?._tippy?.hide();let e=te();if(e.length===0)return;let M=new URL(s,window.location.origin),L=M.searchParams;e.forEach(p=>{L.append("entities[]",p)}),window.openDialog("primary-dialog",M.toString())},ge=()=>{T.value=!0;let s=c.api;o.value=!o.value,N(ne(s,"n",o.value?"1":"0"));const e=new URL(window.location.href);e.searchParams.set("n",o.value?1:0),window.history.pushState({},"",e)},he=()=>{let s=c.api;F()?B.value="table":B.value="grid",N(ne(s,"m",B.value));const e=new URL(window.location.href);e.searchParams.set("m",B.value),window.history.pushState({},"",e)},Me=async(s=1)=>{z.value=!0,N(ne(c.api,"page",s))},N=s=>{fetch(s).then(e=>e.json()).then(e=>{me(e),ye()})},me=s=>{r.value=[],k.value=s.entities,s.entities.data.forEach(e=>{r.value.push(e)}),g.value=s.csrf,x.value=s.order},ye=()=>{S.value=!1,z.value=!1,T.value=!1,A.value=!1};let J=[];const be=()=>{J.forEach(s=>{const e=s.props.content;e instanceof Element&&V.value&&V.value.appendChild(e),s.destroy()}),J=[]},K=(s,e,M="bottom")=>{if(!s.value||!e.value)return;const L=De(s.value,{content:e.value,theme:"kanka-dropdown",placement:M,interactive:!0,trigger:"click",allowHTML:!0,arrow:!0,zIndex:890});J.push(L)},W=()=>{be(),K(O,w,"bottom"),K(ue,de,"bottom-end"),K(I,ce,"bottom-end")};le(S,s=>{s||se(W)}),le(A,(s,e)=>{e&&!s&&se(W)}),le($,()=>{se(W)}),je(()=>{be()});const X=s=>{O.value?._tippy?.hide(),A.value=!0;let e=new URL(c.api,window.location.origin),M=e.searchParams;M.set("order",s),ee(s)?M.set("desc","1"):M.delete("desc"),e=e.toString(),N(e);const L=new URL(window.location.href);L.searchParams.set("order",s),ee(s)?L.searchParams.set("desc","1"):L.searchParams.delete("desc"),window.history.pushState({},"",L)},Y=s=>{let e="flex items-center gap-2 px-2";return G(s)?e+" font-extrabold":e},Z=s=>ee(s)?"fa-regular fa-arrow-down-z-a":"fa-fa-regular fa-arrow-down-a-z",G=s=>x.value[s],ee=s=>x.value[s]==="ASC";Be(()=>{window.ajaxTooltip()});const xe=()=>{I.value?._tippy?.hide(),te().length!==0&&_.value.submit()},_e=()=>{window.openDialog("primary-dialog",m.value.bookmark)},Te=()=>{R(m.value.delete)},te=()=>{let s=[];return r.value.filter(e=>e.selected).forEach(e=>{s.push(e.id)}),s},q=()=>y.value,He=()=>F()?"entities-grid flex flex-wrap gap-3 lg:gap-5 w-full":"entities-grid flex flex-col gap-1 w-full",F=()=>B.value==="grid",ne=(s,e,M)=>{let L=new URL(s,window.location.origin);return L.searchParams.set(e,M),L.toString()};return(s,e)=>{const M=re("entities-entity"),L=Ee("click-outside");return S.value?(a(),l("div",We,[t("div",Xe,[t("h1",{class:"grow text-2xl category-title truncate",innerHTML:c.module},null,8,Ye),e[18]||(e[18]=t("div",{class:"flex gap-2 items-center"},[t("button",{class:"btn2 btn-disabled",disabled:"disabled"},[t("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"})])],-1))]),e[19]||(e[19]=t("div",{class:"flex gap-2 items-start"},[t("div",{class:"rounded shadow-xs w-[47%] xs:w-[25%] sm:w-48 aspect-square flex items-center justify-center text-xl text-neutral-content"},[t("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"})])],-1))])):(a(),l("div",Ze,[t("div",et,[t("div",tt,[t("h1",{class:"grow text-2xl category-title truncate",innerHTML:c.module},null,8,nt),P.value>0?(a(),l("div",at,[t("div",{class:"flex items-center rounded-xl gap-2 hover:bg-base-300 px-2 py-2 cursor-pointer","aria-label":u.value.filters,title:u.value.filters,onClick:ve},[...e[20]||(e[20]=[t("i",{class:"fa-regular fa-filter hover:bg-base-300","aria-label":"Filter"},null,-1),t("span",{class:"rounded bg-primary text-primary-content px-2 text-sm"},"1",-1)])],8,lt),pe.value?(a(),l("div",{key:0,class:"flex items-center justify-center rounded-xl gap-2 hover:bg-base-300 px-3 py-2 cursor-pointer hover:text-primary",title:u.value.bookmark,onClick:_e},[t("i",{class:"fa-regular fa-bookmark","aria-label":u.value.bookmark},null,8,it)],8,st)):d("",!0),e[22]||(e[22]=t("div",{class:"w-0 h-auto my-2 border-base-content border-l"},null,-1)),t("a",{class:"flex items-center rounded-xl gap-2 hover:bg-base-300 px-2 py-2 text-base-content hover:text-primary",href:U.value.clear},[...e[21]||(e[21]=[t("i",{class:"fa-regular fa-eraser","aria-label":"Clear"},null,-1)])],8,rt)])):(a(),l("div",ot,[t("i",{class:"fa-regular fa-filter text-lg rounded-lg hover:text-primary-content cursor-pointer px-2 py-1 hover:bg-primary","aria-label":u.value.filters,title:u.value.filters,onClick:ve},null,8,ut)])),q()&&!$.value?(a(),l("button",{key:2,onClick:e[0]||(e[0]=p=>fe()),class:"rounded-full border-primary text-primary border px-3 py-1 text-xs uppercase hover:bg-primary hover:text-primary-content",innerHTML:u.value.select},null,8,dt)):d("",!0),q()&&$.value?(a(),l("button",{key:3,onClick:e[1]||(e[1]=p=>fe()),class:"rounded-full bg-primary text-primary-content px-3 py-1 text-xs uppercase",innerHTML:u.value.done},null,8,ct)):d("",!0),q()&&$.value?(a(),l("button",{key:4,onClick:e[2]||(e[2]=p=>Le()),class:"rounded-full border-primary text-primary border px-3 py-1 text-xs uppercase hover:bg-primary hover:text-primary-content",innerHTML:u.value.selectAll},null,8,pt)):d("",!0)]),$.value?(a(),l("div",St,[t("div",zt,[y.value.admin?(a(),l("button",{key:0,class:"btn2 btn-primary join-item btn-bulk-batch",onClick:e[7]||(e[7]=p=>R(m.value.batch))},[e[35]||(e[35]=t("i",{class:"fa-regular fa-pencil","aria-hidden":"true"},null,-1)),t("span",{class:"hidden md:inline",innerHTML:u.value.bulkEdit},null,8,Ot)])):(a(),l("button",{key:1,class:"btn2 join-item btn-primary",onClick:e[8]||(e[8]=p=>xe())},[e[36]||(e[36]=t("i",{class:"fa-regular fa-print","aria-hidden":"true"},null,-1)),t("span",{class:"hidden md:inline",innerHTML:u.value.bulkPrint},null,8,qt)])),q()?(a(),l("div",Ft,[t("button",{ref_key:"actionsBtn",ref:I,type:"button",class:"btn2 btn-primary join-item","aria-expanded":"false","aria-label":"Actions","aria-haspopup":"menu"},[e[37]||(e[37]=t("i",{class:"fa-regular fa-caret-down","aria-hidden":"true"},null,-1)),t("span",{class:"sr-only",innerHTML:u.value.actions},null,8,It)],512)])):d("",!0)])])):(a(),l("div",ft,[A.value?(a(),l("button",vt,[...e[23]||(e[23]=[t("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"},null,-1)])])):(a(),l("div",gt,[t("button",{ref_key:"orderBtn",ref:O,class:"btn2",title:u.value.order},[...e[24]||(e[24]=[t("i",{class:"fa-regular fa-arrow-down-a-z","aria-hidden":"true"},null,-1)])],8,ht)])),v.value.is_nested?(a(),l("div",mt,[T.value?(a(),l("button",yt,[...e[25]||(e[25]=[t("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"},null,-1)])])):d("",!0),o.value&&!T.value?(a(),l("button",{key:1,onClick:e[3]||(e[3]=p=>ge()),class:"btn2",title:u.value.flatten},[e[26]||(e[26]=t("i",{class:"fa-regular fa-boxes-stacked","aria-hidden":"true"},null,-1)),t("span",{class:"sr-only",innerHTML:u.value.flatten},null,8,xt)],8,bt)):T.value?d("",!0):(a(),l("button",{key:2,onClick:e[4]||(e[4]=p=>ge()),class:"btn2",title:u.value.nest},[e[27]||(e[27]=t("i",{class:"fa-regular fa-layer-group","aria-hidden":"true"},null,-1)),t("span",{class:"sr-only",innerHTML:u.value.nest},null,8,wt)],8,kt))])):d("",!0),v.value.has_table?(a(),l("div",Lt,[F()?(a(),l("button",{key:0,onClick:e[5]||(e[5]=p=>he()),class:"btn2",title:u.value.layout_table},[e[28]||(e[28]=t("i",{class:"fa-regular fa-list-ul","aria-hidden":"true"},null,-1)),t("span",{class:"sr-only",innerHTML:u.value.layout_table},null,8,_t)],8,Mt)):(a(),l("button",{key:1,onClick:e[6]||(e[6]=p=>he()),class:"btn2",title:u.value.layout_grid},[e[29]||(e[29]=t("i",{class:"fa-regular fa-grid-2","aria-hidden":"true"},null,-1)),t("span",{class:"sr-only",innerHTML:u.value.layout_grid},null,8,Ht)],8,Tt))])):d("",!0),q()&&y.value.create?(a(),l("div",Pt,[t("a",{href:m.value.create,class:"btn2 btn-primary join-item btn-new-entity"},[e[30]||(e[30]=t("i",{class:"fa-regular fa-plus","aria-hidden":"true"},null,-1)),t("span",{class:"hidden md:inline",innerHTML:v.value.singular},null,8,$t)],8,Ct),y.value.template?(a(),l("div",jt,[t("button",{ref_key:"templateBtn",ref:ue,type:"button",class:"btn2 btn-primary join-item","aria-expanded":"false","aria-label":"Create from template","aria-haspopup":"menu","aria-controls":"templates-submenu"},[e[31]||(e[31]=t("i",{class:"fa-regular fa-caret-down","aria-hidden":"true"},null,-1)),t("span",{class:"sr-only",innerHTML:u.value.actions},null,8,Bt)],512),s.templating?Ue((a(),l("div",Et,[(a(!0),l(C,null,j(b.value,p=>(a(),l("a",{href:p.url,key:p.id,class:"new-entity-from-template text-base-content flex items-center gap-2 px-2 py-1"},[e[32]||(e[32]=t("i",{class:"fa-regular fa-star","aria-hidden":"true"},null,-1)),t("span",{innerHTML:p.name},null,8,At)],8,Ut))),128)),e[34]||(e[34]=t("hr",{class:"m-0"},null,-1)),t("a",Rt,[e[33]||(e[33]=t("i",{class:"fa-regular fa-external-link","aria-hidden":"true"},null,-1)),t("span",{class:"text-nowrap",innerHTML:u.value.templates},null,8,Dt)])])),[[L,s.onClickOutside]]):d("",!0)])):d("",!0)])):d("",!0)]))]),t("div",Nt,[t("div",{class:H(He())},[i.value&&F()?(a(),l("a",{key:0,href:i.value.urls.parent,class:"entity w-[47%] xs:w-[25%] sm:w-48 overflow-hidden rounded flex flex-col shadow-xs hover:shadow-md sm text-link"},[e[38]||(e[38]=t("div",{class:"w-46 flex items-center justify-center grow text-6xl"},[t("i",{class:"fa-regular fa-arrow-left","aria-hidden":"true"})],-1)),t("div",Qt,[t("span",{innerHTML:i.value.links.back},null,8,Vt)])],8,Gt)):i.value&&!F()?(a(),l("a",{key:1,href:i.value.urls.parent,class:"rounded-xl flex bg-base-100 shadow-xs items-center gap-4 py-2 px-4 overflow-hidden text-link"},[e[39]||(e[39]=t("div",{class:""},[t("i",{class:"fa-regular fa-arrow-left","aria-hidden":"true"})],-1)),t("div",Kt,[t("span",{innerHTML:i.value.links.back},null,8,Wt)])],8,Jt)):d("",!0),(a(!0),l(C,null,j(r.value,p=>(a(),Q(M,{key:p.id,entity:p,"is-parent":!1,i18n:u.value,selecting:$.value,layout:B.value,nesting:o.value},null,8,["entity","i18n","selecting","layout","nesting"]))),128))],2)]),(a(),l("div",Xt,[z.value?(a(),l("div",Yt,[...e[40]||(e[40]=[t("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"},null,-1)])])):(a(),Q(Ae(Ke),{key:0,data:k.value,itemClasses:["bg-base-200","text-base-content","border-none","hover:bg-base-300"],activeClasses:["bg-base-100","border-none","text-base-content"],onPaginationChangePage:Me},null,8,["data"]))])),r.value.length===0?(a(),l("p",{key:1,class:"help-text italic",innerHTML:u.value.noResults},null,8,Zt)):d("",!0),t("div",{ref_key:"hiddenMenus",ref:V,style:{display:"none"}},[t("div",{ref_key:"orderMenu",ref:w,class:"flex flex-col gap-1"},[t("button",{onClick:e[9]||(e[9]=p=>X("name")),class:H([Y("name"),"px-2 py-2 hover:bg-base-200 rounded-xl flex items-center gap-1.5 text-sm transition-all duration-150 text-base-content"])},[G("name")?(a(),l("i",{key:0,class:H(Z("name"))},null,2)):d("",!0),t("span",{innerHTML:u.value.fields.name},null,8,en)],2),t("button",{onClick:e[10]||(e[10]=p=>X("type")),class:H([Y("type"),"px-2 py-2 hover:bg-base-200 rounded-xl flex items-center gap-1.5 text-sm transition-all duration-150 text-base-content"])},[G("type")?(a(),l("i",{key:0,class:H(Z("type"))},null,2)):d("",!0),t("span",{innerHTML:u.value.fields.type},null,8,tn)],2),t("button",{onClick:e[11]||(e[11]=p=>X("is_private")),class:H([Y("is_private"),"px-2 py-2 hover:bg-base-200 rounded-xl flex items-center gap-1.5 text-sm transition-all duration-150 text-base-content"])},[G("is_private")?(a(),l("i",{key:0,class:H(Z("is_private"))},null,2)):d("",!0),t("span",{innerHTML:u.value.fields.is_private},null,8,nn)],2)],512),t("div",{ref_key:"templateMenu",ref:de,class:"flex flex-col gap-1"},[(a(!0),l(C,null,j(b.value,p=>(a(),l("a",{href:p.url,key:p.id,class:"px-2 py-2 hover:bg-base-200 rounded-xl flex items-center gap-1.5 text-sm transition-all duration-150 text-base-content"},[e[41]||(e[41]=t("i",{class:"fa-regular fa-star","aria-hidden":"true"},null,-1)),t("span",{innerHTML:p.name},null,8,ln)],8,an))),128)),b.value.length>0?(a(),l("hr",sn)):d("",!0),t("a",rn,[e[42]||(e[42]=t("i",{class:"fa-regular fa-external-link","aria-hidden":"true"},null,-1)),t("span",{class:"text-nowrap",innerHTML:u.value.templates},null,8,on)])],512),y.value?(a(),l("div",{key:0,ref_key:"actionsMenu",ref:ce,class:"flex flex-col gap-1"},[y.value?.admin?(a(),l("button",{key:0,onClick:e[12]||(e[12]=p=>R(m.value.permissions)),class:"flex items-center gap-2 px-2 py-1 cursor-pointer text-nowrap hover:text-primary"},[e[43]||(e[43]=t("i",{class:"fa-regular fa-lock","aria-hidden":"true"},null,-1)),t("span",{innerHTML:u.value.bulkPermissions},null,8,un)])):d("",!0),y.value?.admin?(a(),l("button",{key:1,onClick:e[13]||(e[13]=p=>R(m.value.transform)),class:"flex items-center gap-2 px-2 py-1 cursor-pointer text-nowrap hover:text-primary"},[e[44]||(e[44]=t("i",{class:"fa-regular fa-exchange-alt","aria-hidden":"true"},null,-1)),t("span",{innerHTML:u.value.bulkTransform},null,8,dn)])):d("",!0),t("button",{onClick:e[14]||(e[14]=p=>R(m.value.copy)),class:"flex items-center gap-2 px-2 py-1 cursor-pointer text-nowrap hover:text-primary"},[e[45]||(e[45]=t("i",{class:"fa-regular fa-clone","aria-hidden":"true"},null,-1)),t("span",{innerHTML:u.value.bulkCopy},null,8,cn)]),y.value?.admin?(a(),l("button",{key:2,onClick:e[15]||(e[15]=p=>R(m.value.template)),class:"flex items-center gap-2 px-2 py-1 cursor-pointer text-nowrap hover:text-primary"},[e[46]||(e[46]=t("i",{class:"fa-regular fa-table","aria-hidden":"true"},null,-1)),t("span",{innerHTML:u.value.bulkTemplate},null,8,pn)])):d("",!0),y.value?.admin?(a(),l("button",{key:3,onClick:e[16]||(e[16]=p=>xe()),class:"flex items-center gap-2 px-2 py-1 cursor-pointer text-nowrap hover:text-primary"},[e[47]||(e[47]=t("i",{class:"fa-regular fa-print","aria-hidden":"true"},null,-1)),t("span",{innerHTML:u.value.bulkPrint},null,8,fn)])):d("",!0),y.value?.delete?(a(),l("button",{key:4,onClick:e[17]||(e[17]=p=>Te()),class:"flex items-center gap-2 px-2 py-1 cursor-pointer text-error hover:bg-error hover:text-error-content rounded"},[e[48]||(e[48]=t("i",{class:"fa-regular fa-trash-can","aria-hidden":"true"},null,-1)),t("span",{innerHTML:u.value.bulkDelete},null,8,vn)])):d("",!0)],512)):d("",!0)],512),t("form",{method:"POST",action:m.value.print,ref_key:"printForm",ref:_},[(a(!0),l(C,null,j(te(),p=>(a(),l("input",{type:"hidden",name:"model[]",value:p},null,8,hn))),256)),t("input",{type:"hidden",name:"_token",value:g.value},null,8,mn)],8,gn)]))}}}),bn=["data-stack"],xn=["href","title"],kn=["title"],wn=["aria-label"],Ln={key:0,class:"fa-regular fa-check","aria-label":"selected"},Mn=["href","data-id","data-url","innerHTML"],_n=["data-stack"],Tn=["href","title"],Hn=["title"],Pn=["aria-label"],Cn={key:0,class:"fa-regular fa-check","aria-label":"selected"},$n=["href","data-id","data-url","innerHTML"],jn={class:"flex items-center gap-4"},Bn={key:0,class:"w-5 h-5 cursor-pointer border rounded-full text-center"},En={key:0,class:"fa-regular fa-check","aria-label":"selected"},Un=["href","title"],An=["href","data-id","data-url","innerHTML"],Rn={class:"text-neutral-content lg:w-40 truncate"},Dn=["innerHTML"],Sn={class:"flex items-center gap-4 justify-between"},zn={class:"flex items-center gap-1"},On=["href","innerHTML","title"],qn=["aria-label","title"],Fn=["title"],In=["innerHTML"],Nn={key:4,class:"text-center"},Gn={key:5,class:"flex flex-col gap-1 pl-2"},Qn=we({__name:"Entity",props:{entity:{},isParent:{type:Boolean},selecting:{type:Boolean},i18n:{},layout:{},nesting:{type:Boolean}},setup(n){const c=f(!1),r=f(null),i=n,g=()=>{let o="entity overflow-hidden rounded shadow-xs hover:shadow-md w-[47%] xs:w-[25%] sm:w-48 aspect-square flex flex-col bg-box";return i.isParent&&(o+="shadow-lg stacking-parent font-bold"),o},y=()=>{let o="rounded-xl flex bg-base-100 shadow-xs items-center gap-4 py-2 px-4 overflow-hidden justify-between";return i.isParent&&(o+=" shadow-lg stacking-parent"),i.selecting&&(o+=" cursor-pointer"),o},_=()=>({backgroundImage:"url('"+i.entity.images.thumb+"')"}),v=()=>!(!T()&&!i.nesting),k=()=>i.entity.children&&!T()&&!c.value&&!r.value,x=()=>{let o={};return o["data-entity"]=i.entity.id,o["data-entity-type"]=i.entity.entityType.code,o["data-type"]=i.entity.type,i.entity.attributes.forEach(b=>{o[`data-${b}`]=!0}),o},m=()=>i.entity.children>0,h=o=>{i.selecting?P():o.target&&o.target.href&&(window.location.href=o.target.href)},P=()=>{i.entity.selected=!i.entity.selected},U=()=>{let o="rounded rounded-full opacity-80 h-6 w-6 absolute left-1.5 top-1.5 border border-primary flex items-center justify-center text-xl";return i.entity.selected?o+" bg-primary text-primary-content":o+" bg-base-100 "},S=()=>{c.value=!0,fetch(i.entity.urls.children_api).then(o=>o.json()).then(o=>{A(o),c.value=!1})},A=o=>{r.value=[],o.entities.data.forEach(b=>{r.value.push(b)})},z=o=>" tag rounded-full text-xs flex items-center justify-center badge cursor-pointer hover:shadow-xs "+o.colour,T=()=>i.layout==="grid";return(o,b)=>{const O=re("Entity",!0);return a(),l(C,null,[T()&&m()?(a(),l("div",{key:0,class:"stack inline-grid items-center align-items-end w-[47%] xs:w-[25%] sm:w-48","data-stack":n.entity.children},[t("div",E({class:"entity overflow-hidden rounded shadow-xs hover:shadow-md aspect-square w-full flex flex-col bg-box"},x()),[t("a",{href:n.entity.urls.children,title:n.entity.name,class:"block avatar grow relative cover-background overflow-hidden text-center text-link",style:ie(_()),onClick:D(h,["prevent"])},[n.entity.is_private&&!n.selecting?(a(),l("div",{key:0,class:"bubble-private absolute left-1.5 top-1.5 text-xs shadow-xs flex justify-center align-items-center items-center aspect-square rounded-full w-6 h-6 bg-box opacity-80 text-base-content",title:n.i18n.is_private},[t("i",{class:"fa-regular fa-lock","aria-label":n.i18n.is_private},null,8,wn)],8,kn)):n.selecting?(a(),l("div",{key:1,class:H(U())},[n.entity.selected?(a(),l("i",Ln)):d("",!0)],2)):d("",!0)],12,xn),t("a",{href:n.entity.urls.show,class:"block text-center relative truncate h-12 p-4 text-link","data-toggle":"tooltip-ajax","data-id":n.entity.id,"data-url":n.entity.urls.tooltip,innerHTML:n.entity.name,onClick:D(h,["prevent"])},null,8,Mn)],16),(a(!0),l(C,null,j(n.entity.children,w=>(a(),l("div",{class:"entity entity-stack bg-base-300 w-full overflow-hidden rounded aspect-square flex flex-col shadow-xs",title:"{{ __('datagrids.tooltips.nested') }}","data-stack":w},[...b[1]||(b[1]=[t("div",{class:"block grow"},null,-1),t("div",{class:"block h-12 p-4 bg-box"},null,-1)])],8,_n))),256))],8,bn)):T()?(a(),l("div",E({key:1,class:g()},x()),[t("a",{href:n.entity.urls.show,class:"block avatar grow relative cover-background",style:ie(_()),title:n.entity.name,onClick:D(h,["prevent"])},[n.entity.is_private&&!n.selecting?(a(),l("div",{key:0,class:"bubble-private absolute left-1.5 top-1.5 text-xs shadow-xs flex justify-center align-items-center items-center aspect-square rounded-full w-6 h-6 bg-box opacity-80 text-base-content",title:n.i18n.is_private},[t("i",{class:"fa-regular fa-lock","aria-label":n.i18n.is_private},null,8,Pn)],8,Hn)):n.selecting?(a(),l("div",{key:1,class:H(U())},[n.entity.selected?(a(),l("i",Cn)):d("",!0)],2)):d("",!0)],12,Tn),t("a",{href:n.entity.urls.show,class:"block text-center relative truncate h-12 p-4 text-link","data-toggle":"tooltip-ajax","data-id":n.entity.id,"data-url":n.entity.urls.tooltip,innerHTML:n.entity.name,onClick:D(h,["prevent"])},null,8,$n)],16)):(a(),l("div",E({key:2,class:y()},x(),{onClick:h}),[t("div",jn,[n.selecting?(a(),l("div",Bn,[n.entity.selected?(a(),l("i",En)):d("",!0)])):d("",!0),t("a",{href:n.entity.urls.show,class:"block avatar w-8 h-8 rounded-full relative cover-background",style:ie(_()),title:n.entity.name,onClick:D(h,["prevent"])},null,12,Un),t("a",{href:n.entity.urls.show,class:"truncate lg:w-40 text-link","data-toggle":"tooltip-ajax","data-id":n.entity.id,"data-url":n.entity.urls.tooltip,innerHTML:n.entity.name,onClick:D(h,["prevent"])},null,8,An),t("div",Rn,[t("span",{innerHTML:n.entity.type},null,8,Dn)])]),t("div",Sn,[t("div",zn,[(a(!0),l(C,null,j(n.entity.tags,w=>(a(),l("a",{href:w.urls.show,class:H(z(w)),innerHTML:w.shortname,title:w.name},null,10,On))),256))]),n.entity.is_private?(a(),l("i",{key:0,class:"fa-regular fa-lock","aria-label":n.i18n.is_private,title:n.i18n.is_private},null,8,qn)):d("",!0)])],16)),v()&&k()?(a(),l("div",{key:3,onClick:b[0]||(b[0]=w=>S()),title:n.entity.name,class:"flex items-center justify-center gap-2 cursor-pointer text-xs p-0.5 hover:bg-base-200 rounded-xl","aria-label":"Show children"},[b[2]||(b[2]=t("i",{class:"fa-regular fa-angles-down","aria-hidden":"true"},null,-1)),t("span",{innerHTML:n.entity.children},null,8,In)],8,Fn)):d("",!0),c.value?(a(),l("span",Nn,[...b[3]||(b[3]=[t("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"},null,-1)])])):d("",!0),v()&&r.value?(a(),l("div",Gn,[(a(!0),l(C,null,j(r.value,w=>(a(),Q(O,{key:w.id,entity:w,"is-parent":!1,i18n:n.i18n,selecting:n.selecting,layout:n.layout,nesting:n.nesting},null,8,["entity","i18n","selecting","layout","nesting"]))),128))])):d("",!0)],64)}}}),oe=Re({});oe.component("entities-explorer",yn);oe.component("entities-entity",Qn);oe.mount("#entities-explorer");

const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/GalleryDialog-B9r70C_H.js","assets/vendor-tiptap-BMQcrX0l.js","assets/index-D5GkNzM3.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/GalleryDialog-DSssiTYx.css","assets/SourceEditor-DHxMdGsf.js","assets/SourceEditor-BKF0zshA.css"])))=>i.map(i=>d[i]);
import{_ as oe}from"./preload-helper-I4rgV-VL.js";import{d as z,o as ne,E as se,a as m,i as N,s as ge,k as W,u as x,T as ke,n as J,e as y,U as Ce,y as D,h as S,V as Fe,W as Ae,X,Y as le,Z as me,_ as re,D as pe,c as b,F as U,r as G,b as n,g as B,t as ee,f as R,$ as be,a0 as he,a1 as ve,a2 as ye,a3 as xe,a4 as ie,a5 as Le,a6 as Te,a7 as Me,w as K,v as Q,p as h,B as te,j as $e,a8 as He,a9 as Ee,aa as Ie,ab as Se,ac as Re,ad as Be,ae as De,af as Pe,ag as Ue,ah as je,ai as ze,aj as Ne,ak as Oe,al as Ke,am as Ve,an as qe,P as ae}from"./vendor-tiptap-BMQcrX0l.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as We}from"./index-D5GkNzM3.js";const Ge=z({__name:"TableWrapper",props:{editor:{},node:{},getPos:{type:Function},selected:{type:Boolean}},setup(e){const s=e,t=S(!1),r=()=>{const o=s.getPos(),{from:d,to:c}=s.editor.state.selection,u=s.node.nodeSize;t.value=d>=o&&c<=o+u},a=D(()=>{const o=s.node.attrs.class||"",d=["table-wrapper"];return t.value&&d.push("is-active"),o.includes("table-left")?d.push("table-wrapper-left"):o.includes("table-right")&&d.push("table-wrapper-right"),d});return ne(()=>{s.editor.on("selectionUpdate",r),s.editor.on("focus",r),r()}),se(()=>{s.editor.off("selectionUpdate",r),s.editor.off("focus",r)}),(o,d)=>(m(),N(x(Ce),{class:y(a.value)},{default:ge(()=>[W(x(ke),{as:"table",class:y(e.node.attrs.class||"table table-striped"),style:J(e.node.attrs.style)},null,8,["class","style"])]),_:1},8,["class"]))}}),Ze=Y(Ge,[["__scopeId","data-v-014780ce"]]),Je=Fe.extend({addAttributes(){return{...this.parent?.(),class:{default:null,parseHTML:e=>e.getAttribute("class"),renderHTML:e=>e.class?{class:e.class}:{}},style:{default:null,parseHTML:e=>e.getAttribute("style"),renderHTML:e=>e.style?{style:e.style}:{}}}},renderHTML({HTMLAttributes:e}){return["table",X(this.options.HTMLAttributes,e),["tbody",0]]},addNodeView(){return Ae(Ze)}}),Qe=new re("mention"),Xe=le.create({name:"mention",addOptions(){return{HTMLAttributes:{},renderLabel({options:e,node:s}){return s.attrs.label||s.attrs.name||s.attrs.id},suggestion:{char:"@",pluginKey:Qe,command:({editor:e,range:s,props:t})=>{e.view.state.selection.$to.nodeAfter?.text?.startsWith(" ")&&(s.to+=1);const o=t.section==="entities"?t.mention:t.inject;e.chain().focus().insertContentAt(s,[{type:"text",text:o},{type:"text",text:" "}]).run(),window.getSelection()?.collapseToEnd()},allow:({state:e,range:s})=>{const t=e.doc.resolve(s.from),r=e.schema.nodes[this.name];return!!t.parent.type.contentMatch.matchType(r)}}}},group:"inline",inline:!0,selectable:!0,atom:!0,draggable:!0,addAttributes(){return{id:{default:null,parseHTML:e=>e.getAttribute("data-id"),renderHTML:e=>e.id?{"data-id":e.id}:{}},label:{default:null,parseHTML:e=>e.getAttribute("data-label"),renderHTML:e=>({})},name:{default:null,parseHTML:e=>e.getAttribute("data-name"),renderHTML:e=>e.name?{"data-name":e.name}:{}},mention:{default:null,parseHTML:e=>e.getAttribute("data-mention"),renderHTML:e=>{if(!e.mention)return{};const s=[`${e.mention}`];return e.label&&s.push(e.label),e.config&&s.push(e.config),{"data-mention":`[${s.join("|")}]`}}},image:{default:null,parseHTML:e=>e.getAttribute("data-image"),renderHTML:e=>({})},entity:{default:null,parseHTML:e=>e.getAttribute("data-entity"),renderHTML:e=>({})},url:{default:null,parseHTML:e=>e.getAttribute("data-url"),renderHTML:e=>({})},config:{default:null,parseHTML:e=>e.getAttribute("data-config"),renderHTML:e=>e.config?{"data-config":e.config}:{"data-config":""}}}},parseHTML(){return[{tag:"span[data-mention]"}]},renderHTML({node:e,HTMLAttributes:s}){const t=this.options.renderLabel({options:this.options,node:e}),r=[];if(e.attrs.image&&r.push(["img",{src:e.attrs.image,class:"inline-block w-4 h-4 rounded-full object-cover mr-1 align-middle",alt:t}]),r.push(t),e.attrs.config){const o=e.attrs.config.split("|").find(d=>d.startsWith("alias:"));if(o){const d=o.split(":")[1],c=e.attrs.entity.aliases.find(u=>u.id===parseInt(d));c&&(r.push(["i",{class:"fa-regular fa-masks-theater"}]),r.push(`(${c.name})`))}}return["a",X({"data-type":"mention"},this.options.HTMLAttributes,s),["span",{class:"rounded-xl bg-base-200 hover:bg-base-300 text-base-content px-2 py-0.5 inline-flex items-center gap-1 cursor-pointer"},...r]]},renderText({node:e}){return e.attrs.mention||`[${e.attrs.label}]`},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:e,state:s})=>{let t=!1;const{selection:r}=s,{empty:a,anchor:o}=r;return a?(s.doc.nodesBetween(o-1,o,(d,c)=>{if(d.type.name===this.name)return t=!0,e.insertText(this.options.suggestion.char||"",c,c+d.nodeSize),!1}),t):!1})}},addProseMirrorPlugins(){return[me({editor:this.editor,...this.options.suggestion})]}}),Ye={class:"mention-list bg-base-100 shadow-lg rounded-lg z-50 max-h-[300px] overflow-y-auto"},_e={class:"section-header px-3 py-1 text-xs font-semibold text-neutral-content/70 bg-base-200/50 flex items-center gap-2"},et=["onClick"],tt={class:"flex gap-2 items-center"},nt={key:0,class:"fa-regular fa-plus text-success","aria-hidden":"true"},st=["src","alt"],lt=["innerHTML"],rt=["innerHTML"],it=["innerHTML"],ot={key:1,class:"px-3 py-2 text-neutral-content text-xs"},at={key:0},ut={key:1},dt={key:2},ct=z({__name:"MentionList",props:{items:{},command:{type:Function},loading:{type:Boolean},query:{}},setup(e,{expose:s}){const t=e,r=S(0);pe(()=>t.items,()=>{r.value=0});const a={entities:{label:"Entities",icon:"fa-regular fa-bookmark"},posts:{label:"Posts",icon:"fa-regular fa-newspaper"},attributes:{label:"Attributes",icon:"fa-regular fa-heart"},new:{label:"Create New",icon:"fa-regular fa-plus"}},o=D(()=>["entities","posts","attributes","new"].map(L=>({key:L,label:a[L].label,icon:a[L].icon,items:t.items.filter(p=>p.section===L)})).filter(L=>L.items.length>0)),d=D(()=>t.query.length<3),c=D(()=>!d.value&&t.loading),u=D(()=>!d.value&&!t.loading&&t.items.length===0),A=({event:$})=>$.key==="ArrowUp"?(k(),!0):$.key==="ArrowDown"?(w(),!0):$.key==="Enter"?(C(),!0):!1,k=()=>{r.value=(r.value+t.items.length-1)%t.items.length},w=()=>{r.value=(r.value+1)%t.items.length},C=()=>{F(r.value)},F=$=>{const L=t.items[$];L&&t.command(L)},H=($,L)=>{let p=0;for(const M of o.value){if(M.key===$)return p+L;p+=M.items.length}return p};return s({onKeyDown:A}),($,L)=>(m(),b("div",Ye,[e.items.length?(m(!0),b(U,{key:0},G(o.value,p=>(m(),b("div",{key:p.key,class:"mention-section"},[n("div",_e,[n("i",{class:y(p.icon),"aria-hidden":"true"},null,2),B(" "+ee(p.label),1)]),(m(!0),b(U,null,G(p.items,(M,g)=>(m(),b("button",{key:M.id??`${p.key}-${g}`,onClick:f=>F(H(p.key,g)),class:y(["mention-item flex items-center gap-2 w-full text-left px-3 py-2 hover:bg-base-200 text-xs justify-between cursor-pointer",{"bg-base-200":H(p.key,g)===r.value}])},[n("div",tt,[p.key==="new"?(m(),b("i",nt)):M.image?(m(),b("img",{key:1,src:M.image,alt:M.name,loading:"lazy",class:"w-6 h-6 rounded-full object-cover"},null,8,st)):R("",!0),n("span",{class:"mention-name",innerHTML:M.name},null,8,lt)]),M.type?(m(),b("span",{key:0,class:"mention-type text-neutral-content",innerHTML:M.type},null,8,rt)):R("",!0),M.value?(m(),b("span",{key:1,class:"text-neutral-content",innerHTML:M.value},null,8,it)):R("",!0)],10,et))),128))]))),128)):(m(),b("div",ot,[d.value?(m(),b("span",at," Type at least 3 characters ")):c.value?(m(),b("span",ut,[...L[0]||(L[0]=[n("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true"},null,-1),B(" Loading... ",-1)])])):u.value?(m(),b("span",dt," No results ")):R("",!0)]))]))}}),ft=Y(ct,[["__scopeId","data-v-d6739cd7"]]),ue=(e,s)=>{he({getBoundingClientRect:()=>xe(e.view,e.state.selection.from,e.state.selection.to)},s,{placement:"bottom-start",strategy:"absolute",middleware:[ve(),ye()]}).then(({x:r,y:a,strategy:o})=>{s.style.width="max-content",s.style.position=o,s.style.left=`${r}px`,s.style.top=`${a}px`})},gt=(e,s)=>{let t=null;return{char:"@",items:async({query:r})=>{if(r.length<3)return[];t&&t.abort(),t=new AbortController;try{const a=new URL(e);a.searchParams.set("q",r);const o=await fetch(a.toString(),{signal:t.signal});if(!o.ok)return[];const d=await o.json(),c=[];return d.entities?.length&&d.entities.forEach(u=>{c.push({id:u.id,name:u.name,image:u.image,url:u.url,aliases:u.aliases,mention:u.mention,type:u.type,section:"entities"})}),d.posts?.length&&d.posts.forEach(u=>{c.push({id:u.id,name:u.name,inject:u.inject,section:"posts"})}),d.attributes?.length&&d.attributes.forEach(u=>{c.push({id:u.id,name:u.name,value:u.value,inject:u.inject,section:"attributes"})}),d.new?.length&&d.new.forEach(u=>{c.push({name:u.name,type:u.type,inject:u.inject,section:"new"})}),c}catch(a){return a.name==="AbortError"?[]:(console.error("Error fetching mentions:",a),[])}},render:()=>{let r;return{onStart:a=>{r=new be(ft,{props:{items:a.items,command:o=>{s&&o.section==="entities"&&s({id:parseInt(o.id),name:o.name,type:o.type,image:o.image,url:o.url,aliases:o.aliases}),a.command(o)},loading:a.query&&a.query.length>=3,query:a.query||""},editor:a.editor}),a.clientRect&&(r.element.style.position="absolute",document.body.appendChild(r.element),ue(a.editor,r.element))},onUpdate(a){const o=a.query&&a.query.length>=3&&a.items.length===0,d=c=>{s&&c.section==="entities"&&s({id:parseInt(c.id),name:c.name,type:c.type,image:c.image,url:c.url,aliases:c.aliases}),a.command(c)};r.updateProps({items:a.items,command:d,loading:o,query:a.query||""}),a.clientRect&&ue(a.editor,r.element)},onKeyDown(a){return a.event.key==="Escape"?(r.destroy(),!0):r.ref?.onKeyDown(a)},onExit(){r.destroy()}}}}},mt=new re("mentionParser"),pt=ie.create({name:"mentionParser",addOptions(){return{entities:[]}},addProseMirrorPlugins(){return[new Le({key:mt,appendTransaction:(e,s,t)=>{if(!e.some(u=>u.docChanged))return null;const a="value"in this.options.entities?this.options.entities.value:this.options.entities||[],o=t.tr;let d=!1;const c=/\[([a-zA-Z_]+):(\d+)(?:\|[^\]]+)?\]/g;return t.doc.descendants((u,A)=>{if(u.isText&&u.text){const k=u.text;let w;const C=[];for(;(w=c.exec(k))!==null;){const F=w[0],H=w[1],$=w[2];if(H==="post")continue;const L=`${H}:${$}`;let p,M;const g=F.indexOf("|");if(g!==-1){const f=F.substring(g+1,F.length-1).split("|"),l=[];for(const i of f)i.includes(":")?l.push(i):p||(p=i);l.length>0&&(M=l.join("|"))}C.push({start:A+w.index,end:A+w.index+w[0].length,mention:L,module:H,id:$,customLabel:p,config:M})}for(let F=C.length-1;F>=0;F--){const{start:H,end:$,mention:L,module:p,id:M,customLabel:g,config:f}=C[F],l=o.mapping.map(H),i=o.mapping.map($);if(o.doc.resolve(l),o.doc.nodeAt(l)?.type.name!=="mention"){const T=t.schema.nodes.mention;if(T){const I=a.find(q=>q.id===parseInt(M)),P=I?I.name:`${p}:${M}`,O=g||"",j=I?.image||null,V=I?.url||null;console.log("parsed",L,P,f);const Z=T.create({id:M,name:I?I.name:`${p}:${M}`,label:O,mention:L,image:j,url:V,config:f||null,entity:I});o.replaceWith(l,i,Z),d=!0}}}}}),d?o:null}})]}}),bt=new re("slashCommand"),ht=ie.create({name:"slashCommand",addOptions(){return{suggestion:{char:"/",pluginKey:bt,command:({editor:e,range:s,props:t})=>{e.chain().focus().deleteRange(s).run(),t.command(e)}}}},addProseMirrorPlugins(){return[me({editor:this.editor,...this.options.suggestion})]}}),vt={class:"slash-command-list bg-base-100 shadow-lg rounded-lg z-50 max-h-[300px] overflow-y-auto min-w-[200px]"},yt=["onClick"],xt={class:"w-6 h-6 rounded bg-base-200 flex items-center justify-center"},wt={class:"flex flex-col"},kt={class:"font-medium text-sm"},Ct={class:"text-xs text-neutral-content"},Ft={key:1,class:"px-3 py-2 text-neutral-content text-sm"},At=z({__name:"SlashCommandList",props:{items:{},command:{type:Function}},setup(e,{expose:s}){const t=e,r=S(0);pe(()=>t.items,()=>{r.value=0});const a=({event:A})=>A.key==="ArrowUp"?(o(),!0):A.key==="ArrowDown"?(d(),!0):A.key==="Enter"?(c(),!0):!1,o=()=>{r.value=(r.value+t.items.length-1)%t.items.length},d=()=>{r.value=(r.value+1)%t.items.length},c=()=>{u(r.value)},u=A=>{const k=t.items[A];k&&t.command(k)};return s({onKeyDown:a}),(A,k)=>(m(),b("div",vt,[e.items.length?(m(!0),b(U,{key:0},G(e.items,(w,C)=>(m(),b("button",{key:w.title,onClick:F=>u(C),class:y(["slash-command-item flex items-center gap-2 w-full text-left px-3 py-2 hover:bg-base-300 text-sm cursor-pointer",{"bg-base-300":C===r.value}])},[n("div",xt,[n("i",{class:y([w.icon,"text-xs"]),"aria-hidden":"true"},null,2)]),n("div",wt,[n("span",kt,ee(w.title),1),n("span",Ct,ee(w.description),1)])],10,yt))),128)):(m(),b("div",Ft," No commands found "))]))}}),Lt=Y(At,[["__scopeId","data-v-aa19753b"]]),de=(e,s)=>{he({getBoundingClientRect:()=>xe(e.view,e.state.selection.from,e.state.selection.to)},s,{placement:"bottom-start",strategy:"absolute",middleware:[ve(),ye()]}).then(({x:r,y:a,strategy:o})=>{s.style.width="max-content",s.style.position=o,s.style.left=`${r}px`,s.style.top=`${a}px`})},Tt=`
  <table class="table table-striped table-bordered" style="width: 200px;">
    <thead>
        <tr>
            <th>a</th>
            <th>b</th>
        </tr>
    </thead>
    <tbody>
        <tr>
          <td>1</td>
          <td>2</td>
        </tr>
        <tr>
          <td>3</td>
          <td>4</td>
        </tr>
    </tbody>
  </table>`,Mt=[{title:"Source",description:"Edit raw HTML source",icon:"fa-regular fa-code",command:e=>{window.dispatchEvent(new CustomEvent("tiptap:source-mode"))}},{title:"Gallery",description:"Insert an image from gallery",icon:"fa-regular fa-images",searchTerms:["image","photo","picture","media"],command:e=>{e.commands.openGallery()}},{title:"Insert Media",description:"Upload an image from your device",icon:"fa-regular fa-upload",searchTerms:["image","photo","picture","media","upload","file"],command:e=>{e.commands.uploadMedia()}},{title:"Table",description:"Insert a table",icon:"fa-regular fa-table",command:e=>{e.chain().focus().insertContent(Tt,{parseOptions:{preserveWhitespace:!0}}).run()}},{title:"Heading 1",description:"Huge heading",icon:"fa-regular fa-heading",command:e=>{e.chain().focus().toggleHeading({level:1}).run()}},{title:"Heading 2",description:"Large heading",icon:"fa-regular fa-heading",command:e=>{e.chain().focus().toggleHeading({level:2}).run()}},{title:"Heading 3",description:"Medium heading",icon:"fa-regular fa-heading",command:e=>{e.chain().focus().toggleHeading({level:3}).run()}},{title:"Bullet List",description:"Create a bullet list",icon:"fa-regular fa-list-ul",command:e=>{e.chain().focus().toggleBulletList().run()}},{title:"Numbered List",description:"Create a numbered list",icon:"fa-regular fa-list-ol",command:e=>{e.chain().focus().toggleOrderedList().run()}},{title:"Task List",description:"Create a checklist",icon:"fa-regular fa-square-check",searchTerms:["checkbox","checklist","todo","task"],command:e=>{e.chain().focus().toggleTaskList().run()}},{title:"Quote",description:"Insert a quote block",icon:"fa-regular fa-quote-right",command:e=>{e.chain().focus().toggleBlockquote().run()}},{title:"Code Block",description:"Insert a code block",icon:"fa-regular fa-code",command:e=>{e.chain().focus().toggleCodeBlock().run()}},{title:"Horizontal Rule",description:"Insert a divider",icon:"fa-regular fa-minus",command:e=>{e.chain().focus().setHorizontalRule().run()}}],$t=()=>({items:({query:e})=>{const s=e.toLowerCase();return Mt.filter(t=>t.title.toLowerCase().includes(s)||t.searchTerms?.some(r=>r.includes(s)))},render:()=>{let e;return{onStart:s=>{e=new be(Lt,{props:{items:s.items,command:s.command},editor:s.editor}),s.clientRect&&(e.element.style.position="absolute",document.body.appendChild(e.element),de(s.editor,e.element))},onUpdate(s){e.updateProps({items:s.items,command:s.command}),s.clientRect&&de(s.editor,e.element)},onKeyDown(s){return s.event.key==="Escape"?(e.destroy(),!0):e.ref?.onKeyDown(s)},onExit(){e.destroy()}}}}),Ht=ie.create({name:"gallery",addOptions(){return{galleryUrl:""}},addCommands(){return{openGallery:()=>({editor:e})=>{const s=new CustomEvent("tiptap:open-gallery",{detail:{editor:e,galleryUrl:this.options.galleryUrl}});return window.dispatchEvent(s),!0},uploadMedia:()=>({editor:e})=>{const s=this.options.galleryUrl,t=document.createElement("input");return t.type="file",t.accept="image/png,image/jpg,image/jpeg,image/gif,image/webp",t.onchange=async()=>{const r=t.files?.[0];if(!r)return;const a=new FormData;a.append("file",r);try{const o=await We.post(s,a);o.status===200&&o.data&&e.chain().focus().setImage({src:o.data.src,"data-uuid":o.data.uuid}).run()}catch(o){if(o.response?.status===204||o.response?.data){const d=o.response?.data?.errors||o.response?.data||"Upload failed";window.showToast(d,"error")}else window.showToast("Upload failed","error")}},t.click(),!0}}}}),Et=Te.extend({name:"image",addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null},"data-gallery-uuid":{default:null},class:{default:null,parseHTML:e=>(e.getAttribute("class")||"").split(/\s+/).filter(r=>!["note-float-left","note-float-right","float-left","float-right"].includes(r)).join(" ").trim()||null},width:{default:null,parseHTML:e=>{const t=(e.getAttribute("style")||"").match(/width:\s*(\d+(?:\.\d+)?)px/);if(t)return parseFloat(t[1]);const r=e.getAttribute("width");return r?parseFloat(r):null},renderHTML:()=>({})},height:{default:null,parseHTML:e=>{const t=(e.getAttribute("style")||"").match(/height:\s*(\d+(?:\.\d+)?)px/);if(t)return parseFloat(t[1]);const r=e.getAttribute("height");return r?parseFloat(r):null},renderHTML:()=>({})},widthStyle:{default:null,parseHTML:e=>{const t=(e.getAttribute("style")||"").match(/width:\s*(\d+%)/);return t?t[1]:null},renderHTML:()=>({})},floatStyle:{default:null,parseHTML:e=>{const t=(e.getAttribute("style")||"").match(/float:\s*(left|right)/);if(t)return t[1];const r=e.getAttribute("class")||"";return r.includes("note-float-left")||r.includes("float-left")?"left":r.includes("note-float-right")||r.includes("float-right")?"right":null},renderHTML:()=>({})}}},renderHTML({node:e,HTMLAttributes:s}){const{width:t,height:r,widthStyle:a,floatStyle:o}=e.attrs,d=[];a?d.push(`width: ${a}`):t!=null&&d.push(`width: ${typeof t=="number"?`${t}px`:t}`),!a&&r!=null&&d.push(`height: ${typeof r=="number"?`${r}px`:r}`),o&&(d.push(`float: ${o}`),o==="left"&&d.push("margin-right: 0.5rem"),o==="right"&&d.push("margin-left: 0.5rem"));const c=d.length>0?{style:d.join("; ")}:{};return["img",X(this.options.HTMLAttributes,s,c)]},addCommands(){return{...this.parent?.(),setImageWidth:e=>({commands:s})=>s.updateAttributes("image",{widthStyle:e,width:null,height:null}),setImageFloat:e=>({commands:s})=>s.updateAttributes("image",{floatStyle:e})}},addNodeView(){if(!this.options.resize?.enabled||typeof document>"u")return null;const{directions:e,minWidth:s,minHeight:t,alwaysPreserveAspectRatio:r}=this.options.resize;return({node:a,getPos:o,HTMLAttributes:d,editor:c})=>{const u=document.createElement("img");Object.entries(d).forEach(([C,F])=>{if(F!=null)switch(C){case"width":case"height":break;default:u.setAttribute(C,F);break}}),u.src=d.src;const A=(C,F)=>{const{widthStyle:H,floatStyle:$}=C;H?(F.style.width=H,u.style.width="100%",u.style.height="auto"):F.style.width="",F.style.float=$||"",F.style.marginRight=$==="left"?"0.5rem":"",F.style.marginLeft=$==="right"?"0.5rem":""},k=new Me({element:u,editor:c,node:a,getPos:o,onResize:(C,F)=>{u.style.width=`${C}px`,u.style.height=`${F}px`},onCommit:(C,F)=>{const H=o();H!==void 0&&this.editor.chain().setNodeSelection(H).updateAttributes(this.name,{width:C,height:F,widthStyle:null}).run()},onUpdate:C=>C.type!==a.type?!1:(A(C.attrs,k.dom),!0),options:{directions:e,min:{width:s,height:t},preserveAspectRatio:r===!0}}),w=k.dom;return w.style.visibility="hidden",w.style.pointerEvents="none",u.onload=()=>{w.style.visibility="",w.style.pointerEvents=""},A(a.attrs,w),k}}}),It=le.create({name:"iframe",group:"block",atom:!0,addOptions(){return{allowFullscreen:!0,HTMLAttributes:{class:"iframe-wrapper relative overflow-hidden max-w-full h-fit"}}},addAttributes(){return{src:{default:null,parseHTML:e=>e.getAttribute("src")},frameborder:{default:0,parseHTML:e=>e.getAttribute("frameborder")||0},allowfullscreen:{default:this.options.allowFullscreen,parseHTML:e=>e.hasAttribute("allowfullscreen")},width:{default:"100%",parseHTML:e=>e.getAttribute("width")||"100%"},height:{default:315,parseHTML:e=>e.getAttribute("height")||315},allow:{default:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",parseHTML:e=>e.getAttribute("allow")},title:{default:null,parseHTML:e=>e.getAttribute("title")},style:{default:null,parseHTML:e=>e.getAttribute("style")}}},parseHTML(){return[{tag:"iframe"}]},renderHTML({HTMLAttributes:e}){return["div",this.options.HTMLAttributes,["iframe",e]]},addCommands(){return{setIframe:e=>({tr:s,dispatch:t})=>{const{selection:r}=s,a=this.type.create(e);return t&&s.replaceRangeWith(r.from,r.to,a),!0}}}}),St=le.create({name:"div",group:"block",content:"block+",defining:!0,addAttributes(){return{class:{default:null,parseHTML:e=>e.getAttribute("class")},style:{default:null,parseHTML:e=>e.getAttribute("style")}}},parseHTML(){return[{tag:"div"}]},renderHTML({HTMLAttributes:e}){return["div",X(e),0]}}),Rt={class:"flex items-center gap-2 text-xs text-neutral-content px-2"},Bt=["placeholder"],Dt=["href"],Pt={key:1,class:"text-neutral-content flex items-center gap-1"},Ut=z({__name:"MentionBubbleMenu",props:{editor:{},mentions:{}},setup(e,{expose:s}){const t=e,r=S(null),a=S(""),o=S(null),d=S(""),c=S(!1);s({syncLabel:()=>{const g=t.editor.getAttributes("mention");g?.entity&&(a.value=g?.label||"")}});const A=()=>{t.editor.chain().focus().deleteSelection().run()},k=()=>{},w=()=>{let g=a.value.trim();const l=t.editor.getAttributes("mention")?.id,i=t.mentions.find(v=>v.id===parseInt(l));g===i?.name&&(g=""),t.editor.chain().focus().updateAttributes("mention",{label:g}).run(),a.value=""},C=g=>{const f=g.relatedTarget;f&&f.closest(".bubble-menu")||w()},F=g=>{g.key==="Enter"?(g.preventDefault(),w()):g.key==="Escape"&&(g.preventDefault(),a.value="",t.editor.commands.focus())},H=()=>{const g=t.editor.getAttributes("mention");d.value=g?.config||"",c.value=!0,setTimeout(()=>{o.value?.focus(),o.value?.select()},10)},$=()=>{const g=d.value.trim();t.editor.chain().focus().updateAttributes("mention",{config:g||null}).run(),c.value=!1,d.value=""},L=g=>{const f=g.relatedTarget;f&&f.closest(".bubble-menu")||$()},p=()=>{t.editor.chain().focus().updateAttributes("mention",{config:null}).run(),c.value=!1,d.value=""},M=g=>{g.key==="Enter"?(g.preventDefault(),$()):g.key==="Escape"&&(g.preventDefault(),c.value=!1,d.value="",t.editor.commands.focus())};return(g,f)=>(m(),b("div",Rt,[c.value?(m(),b(U,{key:0},[K(n("input",{ref_key:"mentionConfigInput",ref:o,"onUpdate:modelValue":f[0]||(f[0]=l=>d.value=l),type:"text",placeholder:"page:abilities|anchor:#ability-1",class:"p-0 px-1 rounded text-xs outline-none focus:ring-1 focus:ring-primary min-w-[250px]",onBlur:L,onKeydown:M},null,544),[[Q,d.value]]),e.editor.getAttributes("mention").config?(m(),b("button",{key:0,onClick:h(p,["prevent"]),class:"hover:text-warning",title:"Clear config"},[...f[2]||(f[2]=[n("i",{class:"fa-regular fa-times"},null,-1)])])):R("",!0)],64)):(m(),b(U,{key:1},[e.editor.getAttributes("mention").entity?(m(),b(U,{key:0},[K(n("input",{ref_key:"mentionLabelInput",ref:r,"onUpdate:modelValue":f[1]||(f[1]=l=>a.value=l),type:"text",placeholder:e.editor.getAttributes("mention").entity.name,class:"p-0 px-1 rounded text-xs outline-none focus:ring-1 focus:ring-primary min-w-[150px]",onFocus:k,onBlur:C,onKeydown:F},null,40,Bt),[[Q,a.value]]),e.editor.getAttributes("mention").url?(m(),b("a",{key:0,class:"text-link",href:e.editor.getAttributes("mention").url,title:"Go to entity"},[...f[3]||(f[3]=[n("i",{class:"fa-regular fa-external-link-alt","aria-hidden":"true"},null,-1)])],8,Dt)):R("",!0)],64)):(m(),b("span",Pt,[...f[4]||(f[4]=[n("i",{class:"fa-regular fa-exclamation-triangle","aria-hidden":"true"},null,-1),B(" Unknown entity ",-1)])])),n("button",{onClick:h(H,["prevent"]),class:y(["hover:text-primary",{"text-primary":e.editor.getAttributes("mention").config}]),title:"Customize mention"},[...f[5]||(f[5]=[n("i",{class:"fa-regular fa-cog","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:h(A,["prevent"]),class:"hover:text-error",title:"Remove mention"},[...f[6]||(f[6]=[n("i",{class:"fa-regular fa-trash","aria-hidden":"true"},null,-1)])])],64))]))}}),jt={class:"flex gap-2 items-center text-xs text-neutral-content px-2"},zt=["href"],Nt=z({__name:"LinkBubbleMenu",props:{editor:{}},setup(e,{expose:s}){const t=e,r=S(null),a=S("");s({openLinkInput:()=>{const k=t.editor.getAttributes("link").href||"";a.value=k,setTimeout(()=>{r.value?.focus()},10)}});const d=()=>{if(!a.value){u();return}let k=a.value;/^https?:\/\//i.test(k)||(k="https://"+k),t.editor.chain().focus().extendMarkRange("link").setLink({href:k}).run(),u()},c=()=>{t.editor.chain().focus().extendMarkRange("link").unsetLink().run(),u()},u=()=>{a.value="",t.editor.commands.focus()},A=k=>{k.key==="Enter"?(k.preventDefault(),d()):k.key==="Escape"&&(k.preventDefault(),u())};return(k,w)=>(m(),b("div",jt,[K(n("input",{ref_key:"linkInputRef",ref:r,"onUpdate:modelValue":w[0]||(w[0]=C=>e.editor.getAttributes("link").href=C),type:"text",placeholder:"Enter URL...",class:"p-0 px-1 rounded text-xs outline-none focus:ring-1 focus:ring-primary min-w-[200px]",onKeydown:A},null,544),[[Q,e.editor.getAttributes("link").href]]),e.editor.isActive("link")?(m(),b("a",{key:0,href:e.editor.getAttributes("link").href,target:"_blank",class:"hover:text-base-content",title:"Open in a new window"},[...w[1]||(w[1]=[n("i",{class:"fa-regular fa-external-link-alt"},null,-1)])],8,zt)):R("",!0),e.editor.isActive("link")?(m(),b("button",{key:1,onClick:h(c,["prevent"]),class:"hover:text-error",title:"Remove link"},[...w[2]||(w[2]=[n("i",{class:"fa-regular fa-unlink","aria-label":"Removal icon"},null,-1)])])):R("",!0)]))}}),E=e=>{const s="px-2 py-1 rounded-lg hover:bg-base-200 block hover:text-base-content ",t=e?"bg-base-300 border-primary text-base-content":"text-neutral-content ";return s+" "+t},Ot={class:"flex gap-1 items-center text-xs text-neutral-content px-2"},Kt=z({__name:"TableBubbleMenu",props:{editor:{}},setup(e){const s=e,t=()=>{const{selection:l}=s.editor.state,{$from:i}=l;for(let v=i.depth;v>0;v--){const T=i.node(v);if(T.type.name==="table")return{node:T,pos:i.before(v)}}return null},r=()=>(t()?.node.attrs.class||"").split(" ").filter(Boolean),a=l=>r().includes(l),o=D(()=>a("table-bordered")),d=D(()=>a("table-striped")),c=D(()=>a("table-left")),u=D(()=>a("table-right")),A=l=>{const i=t();if(!i)return;l.some(T=>T.startsWith("table-"))&&!l.includes("table")&&l.unshift("table");const{tr:v}=s.editor.state;v.setNodeMarkup(i.pos,void 0,{...i.node.attrs,class:l.join(" ")||null}),s.editor.view.dispatch(v)},k=(l,i=[])=>{const v=r(),T=v.filter(I=>!i.includes(I));v.includes(l)?A(T.filter(I=>I!==l)):A([...T,l])},w=()=>k("table-bordered"),C=()=>k("table-striped"),F=()=>k("table-left",["table-right"]),H=()=>k("table-right",["table-left"]),$=()=>{s.editor.chain().focus().addColumnAfter().run()},L=()=>{s.editor.chain().focus().addRowAfter().run()},p=()=>{s.editor.chain().focus().deleteTable().run()},M=()=>{s.editor.chain().focus().deleteRow().run()},g=()=>{s.editor.chain().focus().deleteColumn().run()},f=()=>{s.editor.chain().focus().toggleHeaderRow().run()};return(l,i)=>(m(),b("div",Ot,[n("button",{onClick:h($,["prevent"]),class:y(x(E)(!1)),title:"Add column"},[...i[0]||(i[0]=[n("i",{class:"fa-regular fa-table-columns","aria-hidden":"true"},null,-1),n("i",{class:"fa-regular fa-plus text-[8px]","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:h(L,["prevent"]),class:y(x(E)(!1)),title:"Add row"},[...i[1]||(i[1]=[n("i",{class:"fa-regular fa-table-rows","aria-hidden":"true"},null,-1),n("i",{class:"fa-regular fa-plus text-[8px]","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:h(g,["prevent"]),class:y(x(E)(!1)),title:"Delete column"},[...i[2]||(i[2]=[n("i",{class:"fa-regular fa-table-columns","aria-hidden":"true"},null,-1),n("i",{class:"fa-regular fa-minus text-[8px]","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:h(M,["prevent"]),class:y(x(E)(!1)),title:"Delete row"},[...i[3]||(i[3]=[n("i",{class:"fa-regular fa-table-rows","aria-hidden":"true"},null,-1),n("i",{class:"fa-regular fa-minus text-[8px]","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:h(f,["prevent"]),class:y(x(E)(!1)),title:"Toggle header row"},[...i[4]||(i[4]=[n("i",{class:"fa-regular fa-heading","aria-hidden":"true"},null,-1)])],2),i[10]||(i[10]=n("span",{class:"w-px h-4 bg-base-content/20 mx-1"},null,-1)),n("button",{onClick:h(w,["prevent"]),class:y(x(E)(o.value)),title:"Toggle bordered"},[...i[5]||(i[5]=[n("i",{class:"fa-regular fa-border-all","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:h(C,["prevent"]),class:y(x(E)(d.value)),title:"Toggle striped"},[...i[6]||(i[6]=[n("i",{class:"fa-regular fa-bars","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:h(F,["prevent"]),class:y(x(E)(c.value)),title:"Align left"},[...i[7]||(i[7]=[n("i",{class:"fa-regular fa-align-left","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:h(H,["prevent"]),class:y(x(E)(u.value)),title:"Align right"},[...i[8]||(i[8]=[n("i",{class:"fa-regular fa-align-right","aria-hidden":"true"},null,-1)])],2),i[11]||(i[11]=n("span",{class:"w-px h-4 bg-base-content/20 mx-1"},null,-1)),n("button",{onClick:h(p,["prevent"]),class:"hover:text-error px-2 py-1",title:"Delete table"},[...i[9]||(i[9]=[n("i",{class:"fa-regular fa-trash","aria-hidden":"true"},null,-1)])])]))}}),Vt={class:"flex gap-1 items-center text-xs text-neutral-content px-2"},qt={class:"flex items-center gap-0.5 border-r border-base-300 pr-2 mr-1"},Wt={class:"flex items-center gap-0.5 border-r border-base-300 pr-2 mr-1"},Gt=z({__name:"ImageBubbleMenu",props:{editor:{}},setup(e){const s=e,t=c=>{s.editor.commands.setImageWidth(c)},r=c=>{s.editor.commands.setImageFloat(c)},a=()=>{s.editor.chain().focus().deleteSelection().run()},o=()=>s.editor.getAttributes("image").widthStyle||null,d=()=>s.editor.getAttributes("image").floatStyle||null;return(c,u)=>(m(),b("div",Vt,[n("div",qt,[n("button",{onClick:u[0]||(u[0]=h(A=>t("25%"),["prevent"])),class:y(x(E)(o()==="25%")),title:"25% width"}," 25% ",2),n("button",{onClick:u[1]||(u[1]=h(A=>t("50%"),["prevent"])),class:y(x(E)(o()==="50%")),title:"50% width"}," 50% ",2),n("button",{onClick:u[2]||(u[2]=h(A=>t("100%"),["prevent"])),class:y(x(E)(o()==="100%")),title:"100% width"}," 100% ",2),n("button",{onClick:u[3]||(u[3]=h(A=>t(null),["prevent"])),class:y(x(E)(o()===null)),title:"Reset width"},[...u[7]||(u[7]=[n("i",{class:"fa-regular fa-undo","aria-hidden":"true"},null,-1)])],2)]),n("div",Wt,[n("button",{onClick:u[4]||(u[4]=h(A=>r("left"),["prevent"])),class:y(x(E)(d()==="left")),title:"Float left"},[...u[8]||(u[8]=[n("i",{class:"fa-regular fa-align-left","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:u[5]||(u[5]=h(A=>r("right"),["prevent"])),class:y(x(E)(d()==="right")),title:"Float right"},[...u[9]||(u[9]=[n("i",{class:"fa-regular fa-align-right","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:u[6]||(u[6]=h(A=>r(null),["prevent"])),class:y(x(E)(d()===null)),title:"No float"},[...u[10]||(u[10]=[n("i",{class:"fa-regular fa-align-justify","aria-hidden":"true"},null,-1)])],2)]),n("button",{onClick:h(a,["prevent"]),class:"hover:text-error px-2 py-1",title:"Delete image"},[...u[11]||(u[11]=[n("i",{class:"fa-regular fa-trash","aria-hidden":"true"},null,-1)])])]))}}),Zt={class:"relative"},Jt=["title"],Qt={class:"absolute top-full left-0 mt-1 bg-base-100 shadow-lg rounded-lg p-3 z-50 w-[220px]"},Xt={key:0,class:"mb-2"},Yt={class:"flex flex-wrap gap-1"},_t=["onMousedown","title"],en={class:"mb-2"},tn={class:"grid grid-cols-7 gap-1"},nn=["onMousedown","title"],sn={class:"mb-2"},ln=["onKeydown"],_="recent_colors",ce=10,fe=z({__name:"ColorPicker",props:{currentColor:{},icon:{},title:{}},emits:["select"],setup(e,{emit:s}){const t=e,r=s,a=Math.random().toString(36).substring(7),o=S(!1),d=S(""),c=S([]),u=["#000000","#434343","#666666","#999999","#cccccc","#efefef","#ffffff","#FB0300","#FF9900","#FFFF01","#00FF00","#00FFFF","#0000FF","#9900FF","#FB3533","#FFAD33","#FFFF34","#33FF33","#33FFFF","#3333FF","#AD33FF","#FC6866","#FFC266","#FFFF67","#66FF66","#66FFFF","#6666FF","#C266FF","#FD9B99","#FFD699","#FFFF9A","#99FF99","#99FFFF","#9999FF","#D699FF","#FECECC","#FFEBCC","#FFFFCD","#CCFFCC","#CCFFFF","#CCCCFF","#EBCCFF","#FEE1E0","#FFF3E0","#FFFFE1","#E0FFE0","#E0FFFF","#E0E0FF","#F3E0FF","#FFF5F4","#FFF9F4","#FFFFF5","#F4FFF4","#F4FFFF","#F4F4FF","#F9F4FF"],A=()=>document.cookie.split(";").reduce((g,f)=>{const[l,i]=f.split("=").map(v=>v.trim());return l&&i&&(g[l]=decodeURIComponent(i)),g},{}),k=(g,f,l=30)=>{const i=new Date;i.setTime(i.getTime()+l*24*60*60*1e3),document.cookie=`${g}=${encodeURIComponent(f)}; expires=${i.toUTCString()}; path=/`},w=()=>{const g=A();c.value=g[_]?JSON.parse(g[_]):[]},C=g=>{c.value=[g,...c.value.filter(f=>f!==g)],c.value.length>ce&&(c.value=c.value.slice(0,ce)),k(_,JSON.stringify(c.value))},F=g=>{C(g),r("select",g),o.value=!1},H=()=>{d.value&&/^#[0-9A-Fa-f]{6}$/.test(d.value)&&(F(d.value),d.value="")},$=()=>{r("select",null),o.value=!1},L=g=>{g.detail!==a&&(o.value=!1)},p=()=>{o.value||(window.dispatchEvent(new CustomEvent("colorpicker:close",{detail:a})),w()),o.value=!o.value},M=D(()=>!!t.currentColor);return ne(()=>{w(),window.addEventListener("colorpicker:close",L)}),se(()=>{window.removeEventListener("colorpicker:close",L)}),(g,f)=>(m(),b("div",Zt,[n("button",{onClick:h(p,["prevent"]),class:y([x(E)(M.value),"flex items-center gap-0.5"]),title:e.title},[n("i",{class:y(e.icon),"aria-hidden":"true"},null,2),e.currentColor?(m(),b("span",{key:0,class:"w-2 h-2 rounded-full border border-base-300",style:J({backgroundColor:e.currentColor})},null,4)):R("",!0)],10,Jt),K(n("div",Qt,[c.value.length>0?(m(),b("div",Xt,[f[1]||(f[1]=n("div",{class:"text-xs text-neutral-content mb-1"},"Recent",-1)),n("div",Yt,[(m(!0),b(U,null,G(c.value,l=>(m(),b("button",{key:l,onMousedown:h(i=>F(l),["prevent"]),class:"w-5 h-5 rounded border border-base-300 hover:scale-110 transition-transform",style:J({backgroundColor:l}),title:l},null,44,_t))),128))])])):R("",!0),n("div",en,[f[2]||(f[2]=n("div",{class:"text-xs text-neutral-content mb-1"},"Colors",-1)),n("div",tn,[(m(),b(U,null,G(u,l=>n("button",{key:l,onMousedown:h(i=>F(l),["prevent"]),class:"w-5 h-5 rounded border border-base-300 hover:scale-110 transition-transform",style:J({backgroundColor:l}),title:l},null,44,nn)),64))])]),n("div",sn,[K(n("input",{"onUpdate:modelValue":f[0]||(f[0]=l=>d.value=l),type:"text",placeholder:"#000000",maxlength:"7",class:"w-full p-1 text-xs rounded border border-base-300 outline-none focus:ring-1 focus:ring-primary",onKeydown:$e(h(H,["prevent"]),["enter"]),onBlur:H},null,40,ln),[[Q,d.value]])]),n("button",{onMousedown:h($,["prevent"]),class:"w-full text-xs text-neutral-content hover:text-error py-1 flex items-center justify-center gap-1 cursor-pointer"},[...f[3]||(f[3]=[n("i",{class:"fa-regular fa-eraser","aria-hidden":"true"},null,-1),B(" Remove color ",-1)])],32)],512),[[te,o.value]])]))}}),rn={class:"relative"},on={key:0,class:"text-xs"},an=["innerHTML"],un={key:0,class:"fa-regular fa-check"},dn={key:0,class:"fa-regular fa-check"},cn={key:0,class:"fa-regular fa-check"},fn={key:0,class:"fa-regular fa-check"},gn={key:0,class:"fa-regular fa-check"},mn={key:0,class:"fa-regular fa-check"},pn={class:"flex items-center gap-0.5 border-r border-base-300 pr-2 mr-1"},bn={class:"flex items-center gap-0.5 border-r border-base-300 pr-2 mr-1"},hn={class:"relative"},vn={key:0,class:"fa-regular fa-check"},yn={key:0,class:"fa-regular fa-check"},xn=z({__name:"TextBubbleMenu",props:{editor:{}},emits:["openLink"],setup(e,{emit:s}){const t=e,r=s,a=S(!1),o=S(!1),d=D(()=>t.editor.getAttributes("textStyle").color||null),c=D(()=>t.editor.getAttributes("highlight").color||null),u=f=>{f?t.editor.chain().focus().setColor(f).run():t.editor.chain().focus().unsetColor().run()},A=f=>{f?t.editor.chain().focus().setHighlight({color:f}).run():t.editor.chain().focus().unsetHighlight().run()},k=D(()=>!t.editor||t.editor.isActive("paragraph")?"fa-regular fa-paragraph":"fa-regular fa-heading"),w=()=>t.editor.isActive("heading",{level:1})?"1":t.editor.isActive("heading",{level:2})?"2":t.editor.isActive("heading",{level:3})?"3":t.editor.isActive("heading",{level:4})?"4":t.editor.isActive("heading",{level:5})?"5":0,C=f=>{f===null?t.editor.chain().focus().setParagraph().run():t.editor.chain().focus().toggleHeading({level:f}).run(),a.value=!1},F=()=>{a.value=!a.value},H=()=>{a.value=!1},$=D(()=>t.editor?t.editor.isActive("bulletList")?"fa-regular fa-list-ul":t.editor.isActive("orderedList")?"fa-regular fa-list-ol":"fa-regular fa-list-ul":"fa-regular fa-list-ol"),L=f=>{f==="bullet"?t.editor.chain().focus().toggleBulletList().run():t.editor.chain().focus().toggleOrderedList().run(),o.value=!1},p=()=>{o.value=!o.value},M=()=>{o.value=!1},g=()=>{t.editor.chain().focus().unsetAllMarks().clearNodes().run()};return(f,l)=>(m(),b(U,null,[n("div",rn,[n("button",{onClick:h(F,["prevent"]),class:y([x(E)(!1),"flex items-center gap-0.5"]),onBlur:H},[n("i",{class:y(k.value)},null,2),e.editor.isActive("heading")?(m(),b("sub",on,[n("span",{innerHTML:w()},null,8,an)])):R("",!0),l[16]||(l[16]=n("i",{class:"fa-regular fa-chevron-down","aria-label":"Toggle paragraph styles"},null,-1))],34),K(n("div",{class:"absolute top-full left-0 mt-1 bg-base-100 shadow-lg rounded-lg py-1 z-50 min-w-[200px]",onMousedown:l[6]||(l[6]=h(()=>{},["prevent"]))},[n("button",{onClick:l[0]||(l[0]=h(i=>C(null),["prevent"])),class:y(["block w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content text-xs flex items-center justify-between gap-1",{"text-semibold text-base-content":e.editor.isActive("paragraph")}])},[l[17]||(l[17]=B(" Paragraph ",-1)),e.editor.isActive("paragraph")?(m(),b("i",un)):R("",!0)],2),n("button",{onClick:l[1]||(l[1]=h(i=>C(1),["prevent"])),class:y(["block w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content flex items-center justify-between gap-1 text-[1.4rem]",{"font-semibold text-base-content":e.editor.isActive("heading",{level:1})}])},[l[18]||(l[18]=B(" Heading 1 ",-1)),e.editor.isActive("heading",{level:1})?(m(),b("i",dn)):R("",!0)],2),n("button",{onClick:l[2]||(l[2]=h(i=>C(2),["prevent"])),class:y(["block w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content flex items-center justify-between gap-1 text-[1.3rem]",{"font-semibold text-base-content":e.editor.isActive("heading",{level:2})}])},[l[19]||(l[19]=B(" Heading 2 ",-1)),e.editor.isActive("heading",{level:2})?(m(),b("i",cn)):R("",!0)],2),n("button",{onClick:l[3]||(l[3]=h(i=>C(3),["prevent"])),class:y(["block w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content flex items-center justify-between gap-1 text-[1.2rem]",{"font-semibold text-base-content":e.editor.isActive("heading",{level:3})}])},[l[20]||(l[20]=B(" Heading 3 ",-1)),e.editor.isActive("heading",{level:3})?(m(),b("i",fn)):R("",!0)],2),n("button",{onClick:l[4]||(l[4]=h(i=>C(4),["prevent"])),class:y(["w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content text-xs flex items-center justify-between gap-1 text[1.1rem]",{"font-semibold text-base-content":e.editor.isActive("heading",{level:4})}])},[l[21]||(l[21]=B(" Heading 4 ",-1)),e.editor.isActive("heading",{level:4})?(m(),b("i",gn)):R("",!0)],2),n("button",{onClick:l[5]||(l[5]=h(i=>C(5),["prevent"])),class:y(["w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content text-xs flex items-center justify-between gap-1",{"font-semibold text-base-content":e.editor.isActive("heading",{level:5})}])},[l[22]||(l[22]=B(" Heading 5 ",-1)),e.editor.isActive("heading",{level:5})?(m(),b("i",mn)):R("",!0)],2)],544),[[te,a.value]])]),n("button",{onClick:l[7]||(l[7]=h(i=>e.editor.chain().focus().toggleBold().run(),["prevent"])),class:y(x(E)(e.editor.isActive("bold")))},[...l[23]||(l[23]=[n("i",{class:"fa-regular fa-bold","aria-label":"Bold"},null,-1)])],2),n("button",{onClick:l[8]||(l[8]=h(i=>e.editor.chain().focus().toggleItalic().run(),["prevent"])),class:y(x(E)(e.editor.isActive("italic")))},[...l[24]||(l[24]=[n("i",{class:"fa-regular fa-italic","aria-label":"Italic"},null,-1)])],2),n("button",{onClick:l[9]||(l[9]=h(i=>e.editor.chain().focus().toggleStrike().run(),["prevent"])),class:y(x(E)(e.editor.isActive("strike")))},[...l[25]||(l[25]=[n("i",{class:"fa-regular fa-strikethrough","aria-label":"Strikethrough"},null,-1)])],2),n("button",{onClick:l[10]||(l[10]=h(i=>e.editor.chain().focus().toggleUnderline().run(),["prevent"])),class:y(x(E)(e.editor.isActive("underline")))},[...l[26]||(l[26]=[n("i",{class:"fa-regular fa-underline","aria-label":"Underline"},null,-1)])],2),n("div",pn,[W(fe,{"current-color":d.value,icon:"fa-regular fa-font",title:"Text color",onSelect:u},null,8,["current-color"]),W(fe,{"current-color":c.value,icon:"fa-regular fa-fill",title:"Highlight color",onSelect:A},null,8,["current-color"])]),n("div",bn,[n("button",{onClick:l[11]||(l[11]=h(i=>r("openLink"),["prevent"])),class:y(x(E)(e.editor.isActive("link")))},[...l[27]||(l[27]=[n("i",{class:"fa-regular fa-link","aria-label":"Link"},null,-1)])],2),n("button",{onClick:l[12]||(l[12]=h(i=>e.editor.chain().focus().toggleBlockquote().run(),["prevent"])),class:y(x(E)(e.editor.isActive("blockquote")))},[...l[28]||(l[28]=[n("i",{class:"fa-regular fa-quote-right","aria-label":"Quote"},null,-1)])],2),n("div",hn,[n("button",{onClick:h(p,["prevent"]),class:y([x(E)(!1),"flex items-center gap-0.5"]),onBlur:M},[n("i",{class:y($.value)},null,2),l[29]||(l[29]=n("i",{class:"fa-regular fa-chevron-down","aria-label":"Toggle paragraph styles"},null,-1))],34),K(n("div",{class:"absolute top-full left-0 mt-1 bg-base-100 shadow-lg rounded-lg py-1 z-50 min-w-[200px]",onMousedown:l[15]||(l[15]=h(()=>{},["prevent"]))},[n("button",{onClick:l[13]||(l[13]=h(i=>L("bullet"),["prevent"])),class:y(["block w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content text-xs flex items-center justify-between gap-1",{"text-semibold text-base-content":e.editor.isActive("bulletList")}])},[l[30]||(l[30]=n("div",{class:"flex gap-1 items-center"},[n("i",{class:"fa-regular fa-list-ul","aria-hidden":"true"}),B(" List ")],-1)),e.editor.isActive("bulletList")?(m(),b("i",vn)):R("",!0)],2),n("button",{onClick:l[14]||(l[14]=h(i=>L("ordered"),["prevent"])),class:y(["block w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content text-xs flex items-center justify-between gap-1",{"text-semibold text-base-content":e.editor.isActive("orderedList")}])},[l[31]||(l[31]=n("div",{class:"flex gap-1 items-center"},[n("i",{class:"fa-regular fa-list-ol","aria-hidden":"true"}),B(" Numbered list ")],-1)),e.editor.isActive("orderedList")?(m(),b("i",yn)):R("",!0)],2)],544),[[te,o.value]])])]),n("button",{onClick:h(g,["prevent"]),class:y(x(E)(!1)),title:"Clear formatting"},[...l[32]||(l[32]=[n("i",{class:"fa-regular fa-paint-roller","aria-label":"Clear formatting"},null,-1)])],2)],64))}}),wn={key:0},kn={class:"bubble-menu bg-base-100 shadow rounded-2xl flex gap-0.5 items-center px-2 py-2"},Cn={key:1,class:"text-neutral-content text-xs mt-2 flex items-center gap-5"},Fn=["name","value"],An=z({__name:"Tiptap",props:{modelValue:{},content:{},gallery:{},mentions:{},fieldName:{default:"entry"}},setup(e){const s=ae(()=>oe(()=>import("./GalleryDialog-B9r70C_H.js"),__vite__mapDeps([0,1,2,3,4]))),t=ae(()=>oe(()=>import("./SourceEditor-DHxMdGsf.js"),__vite__mapDeps([5,1,3,6]))),r=e,a=S(r.content??r.modelValue??""),o=S([]),d=S(!1),c=S(!1),u=S(!1),A=S(!1),k=D(()=>c.value&&!u.value&&p.value?.isEmpty),w=()=>{A.value=!0},C=()=>{p.value?.commands.setContent(a.value),A.value=!1,setTimeout(()=>{p.value?.commands.focus()},50)},F=S(null),H=S(null),$=i=>{o.value.find(T=>T.id===i.id)||o.value.push(i)},L=[Be.configure({link:!1,bulletList:!1,orderedList:!1,listItem:!1,listItemKeymap:!1}),De.configure({placeholder:"Start writing..."}),Pe.configure({openOnClick:!1,defaultProtocol:"https",HTMLAttributes:{class:"text-link"}}),Ue.configure({taskItem:{nested:!0}}),Je.configure({resizable:!0}),He,je.configure({}),ze.configure({}),ht.configure({suggestion:$t()}),Et.configure({inline:!0,allowBase64:!1,resize:{enabled:!0,minWidth:20,minHeight:20,alwaysPreserveAspectRatio:!0}}),It,St,Ne.configure({persist:!0,HTMLAttributes:{class:"details"}}),Ee,Ie,Se,Re,Oe.configure({multicolor:!0})];r.gallery&&L.push(Ht.configure({galleryUrl:r.gallery})),r.mentions&&L.push(Xe.configure({HTMLAttributes:{class:"mention"},suggestion:gt(r.mentions,$),renderText({node:i}){const v=i.attrs.mention,T=i.attrs.label,I=i.attrs.id,P=i.attrs.config,O=v?.match(/\[([^:]+):(\d+)/),j=O?O[1]:null;if(j&&I){const V=o.value.find(we=>we.id===parseInt(I)),Z=V?V.name:null,q=[`${j}:${I}`];return T&&Z&&T!==Z&&q.push(T),P&&q.push(P),`[${q.join("|")}]`}return v||`[${T}]`}}),pt.configure({entities:o}));const p=Ke({content:a.value,extensions:L,onFocus:()=>{c.value=!0},onBlur:()=>{c.value=!1},onUpdate:({editor:i})=>{a.value=i.getHTML().replace(/<table([^>]*) data-table-class="([^"]+)"([^>]*)>/g,'<table$1 class="$2"$3>'),!u.value&&!i.isEmpty&&(u.value=!0)},onSelectionUpdate:({editor:i})=>{i.isActive("mention")&&F.value?.syncLabel(),i.isActive("link")||(d.value=!1)},editorProps:{clipboardTextSerializer:i=>{let v="";return i.content.forEach(T=>{v+=M(T)}),v},handlePaste:(i,v,T)=>{const I=v.clipboardData?.getData("text/plain")||"",P=v.clipboardData?.getData("text/html")||"";if((P||I).match(/<iframe[^>]*src=["']([^"']+)["'][^>]*>/i)||I.includes("<iframe")){const V=P||I;return p.value?.commands.insertContent(V,{parseOptions:{preserveWhitespace:!1}}),!0}return/\[([a-zA-Z_]+):(\d+)(?:\|[^\]]+)?\]/.test(I)?(p.value?.commands.insertContent(I),!0):!1}}}),M=i=>{if(i.type.name==="mention")return g(i);if(i.isText)return i.text||"";let v="";return i.content&&i.content.forEach(T=>{v+=M(T)}),i.isBlock&&v&&(v+=`
`),v},g=i=>{const v=i.attrs.config,T=i.attrs.id,P=[`${i.attrs.type}:${T}`];return v&&P.push(v),`[${P.join("|")}]`},f=()=>{d.value=!0,H.value?.openLinkInput()},l=i=>{const v=[],T=[],I=/\[([a-zA-Z_]+):(\d+)(?:\|[^\]]+)?\]/g;let P;for(;(P=I.exec(i))!==null;){const O=P[1],j=parseInt(P[2],10);O==="post"?T.includes(j)||T.push(j):v.includes(j)||v.push(j)}return{entityIds:v,postIds:T}};return ne(()=>{if(window.addEventListener("tiptap:source-mode",w),r.mentions&&r.content){const{entityIds:i,postIds:v}=l(r.content);(i.length>0||v.length>0)&&axios.post(r.mentions,{entities:i,posts:v}).then(T=>{o.value=T.data,p.value?.commands.setContent(r.content)})}}),se(()=>{window.removeEventListener("tiptap:source-mode",w),p?.value.destroy()}),(i,v)=>(m(),b(U,null,[A.value?(m(),N(x(t),{key:0,modelValue:a.value,"onUpdate:modelValue":v[0]||(v[0]=T=>a.value=T),onExit:C},null,8,["modelValue"])):(m(),b(U,{key:1},[x(p)?(m(),b("div",wn,[W(x(Ve),{editor:x(p)},{default:ge(()=>[n("div",kn,[x(p).isActive("mention")?(m(),N(Ut,{key:0,ref_key:"mentionBubbleRef",ref:F,editor:x(p),mentions:o.value},null,8,["editor","mentions"])):d.value||x(p).isActive("link")?(m(),N(Nt,{key:1,ref_key:"linkBubbleRef",ref:H,editor:x(p)},null,8,["editor"])):x(p).isActive("table")?(m(),N(Kt,{key:2,editor:x(p)},null,8,["editor"])):x(p).isActive("image")?(m(),N(Gt,{key:3,editor:x(p)},null,8,["editor"])):(m(),N(xn,{key:4,editor:x(p),onOpenLink:f},null,8,["editor"]))])]),_:1},8,["editor"])])):R("",!0),W(x(qe),{editor:x(p)},null,8,["editor"]),k.value?(m(),b("p",Cn,[...v[1]||(v[1]=[n("span",null,[B(" Use "),n("kbd",null,"@"),B(" to reference entities ")],-1),n("span",null,[n("kbd",null,"/"),B(" for commands ")],-1)])])):R("",!0)],64)),n("input",{type:"hidden",name:r.fieldName,value:a.value},null,8,Fn),e.gallery?(m(),N(x(s),{key:2})):R("",!0)],64))}}),Hn=Y(An,[["__scopeId","data-v-df029f5c"]]);export{Hn as default};

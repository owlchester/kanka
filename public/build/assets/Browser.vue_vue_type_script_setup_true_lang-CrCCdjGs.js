import{d as j,r as o,K as S,z as N,c as a,a as s,F as C,f as v,b as t,e as f,g as $,n as F}from"./vue.esm-bundler-DB8zkVd9.js";const V={key:0},E={class:"flex gap-6 items-center p-4 md:p-6 justify-between"},O=["innerHTML"],X={class:"max-w-4xl p-4"},Y={key:0,class:"flex gap-1 w-full"},A={class:"grow"},G=["placeholder"],J=["title"],K=["title"],R={key:1,class:"md:h-36 md:w-80 text-center flex items-center justify-center w-full"},q=["onClick"],P=["title"],Q=["innerHTML"],U=["innerHTML"],W=300,le=j({__name:"Browser",props:{api:{},opened:{type:Boolean},i18n:{}},emits:["selected","closed"],setup(L,{emit:T}){const i=L,u=o(null);S(()=>{i.i18n&&typeof i.i18n=="string"?u.value=JSON.parse(i.i18n):u.value=i.i18n});const x=T,r=o(!0),m=o(!1),p=o(),g=o([]),h=o(""),w=o(""),b=o(null),c=o(null),d=o("large"),B=()=>{r.value=!0,p.value.showModal(),p.value.addEventListener("click",function(e){let l=this.getBoundingClientRect();!(l.top<=e.clientY&&e.clientY<=l.top+l.height&&l.left<=e.clientX&&e.clientX<=l.left+l.width)&&e.target.tagName==="DIALOG"&&y()}),axios.get(i.api).then(e=>{g.value=e.data.images,r.value=!1}).catch(e=>{r.value=!1,e.response.status===403&&(c.value=e.response.data.message,c.value+="<p>"+u.value.browse.unauthorized+"</p>")})},y=()=>{p.value.close(),x("closed")},k=e=>(e=e??"",d.value==="large"?"w-40 h-28 md:w-48 md:h-36 "+e:"w-20 h-16 "+e),M=e=>(e=e??"",d.value==="large"?"w-40 md:w-48 "+e:"w-20 text-xs "+e),I=()=>d.value==="small"?"flex flex-wrap justify-center gap-2 md:gap-3":"flex flex-wrap justify-center gap-2 md:gap-5",z=e=>{if(e.folder){r.value=!0,axios.get(e.url).then(l=>{g.value=l.data.images,r.value=!1});return}x("selected",e),y()};N(()=>i.opened,(e,l)=>{e&&B()});const D=e=>{h.value=e.target.value,b.value&&clearTimeout(b.value),b.value=setTimeout(()=>{H()},W)},H=()=>{w.value!=h.value&&(w.value=h.value,m.value=!0,axios.get(i.api+"?term="+w.value).then(e=>{g.value=e.data.images,m.value=!1}))},_=e=>{d.value=e};return(e,l)=>(s(),a(C,null,[r.value?(s(),a("div",V,l[3]||(l[3]=[t("i",{class:"fa-solid fa-spin fa-spinner2","aria-label":"Loading"},null,-1)]))):v("",!0),t("dialog",{class:"dialog rounded-2xl text-center bg-base-100 text-base-content",id:"gallery-dialog",ref_key:"galleryDialog",ref:p,"aria-modal":"true","aria-labelledby":"modal-card-label"},[t("header",E,[t("h4",{innerHTML:u.value.browse.title,class:"text-lg font-normal"},null,8,O),t("button",{type:"button",class:"text-base-content",onClick:l[0]||(l[0]=n=>y()),title:"Close"},l[4]||(l[4]=[t("i",{class:"fa-regular fa-circle-xmark","aria-hidden":"true"},null,-1),t("span",{class:"sr-only"},"Close",-1)]))]),t("article",X,[!r.value&&!c.value?(s(),a("div",Y,[t("div",A,[t("input",{type:"text",class:"w-full",placeholder:u.value.browse.search.placeholder,onInput:D},null,40,G)]),d.value!=="large"?(s(),a("div",{key:0,class:"flex-none cursor-pointer btn2 btn-ghost btn-sm",onClick:l[1]||(l[1]=n=>_("large")),title:u.value.browse.layouts.large},l[5]||(l[5]=[t("i",{class:"fa-regular fa-grid-2","aria-label":"Large previews"},null,-1)]),8,J)):v("",!0),d.value!=="small"?(s(),a("div",{key:1,class:"flex-none cursor-pointer btn2 btn-ghost btn-sm",onClick:l[2]||(l[2]=n=>_("small")),title:u.value.browse.layouts.small},l[6]||(l[6]=[t("i",{class:"fa-regular fa-grid-4","aria-label":"Small previews"},null,-1)]),8,K)):v("",!0)])):v("",!0),r.value||m.value?(s(),a("div",R,l[7]||(l[7]=[t("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"},null,-1)]))):(s(),a("div",{key:2,class:f(I())},[(s(!0),a(C,null,$(g.value,n=>(s(),a("div",{class:"cursor-pointer shadow rounded hover:shadow-lg overflow-hidden",onClick:Z=>z(n)},[n.folder?(s(),a("div",{key:1,class:f(k("flex items-center align-middle justify-center text-4xl"))},[t("i",{class:f(n.icon),"aria-label":"Folder"},null,2)],2)):(s(),a("div",{key:0,class:f(k("cover-background")),style:F({backgroundImage:"url('"+n.thumbnail+"')"})},null,6)),t("div",{class:f(M("truncate px-2 py-1 ")),title:n.name},[t("span",{innerHTML:n.name},null,8,Q)],10,P)],8,q))),256)),c.value?(s(),a("div",{key:0,class:"alert alert-error p-2 rounded",innerHTML:c.value},null,8,U)):v("",!0)],2))])],512)],64))}});export{le as _};

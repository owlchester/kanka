import{S as pt}from"./sortable.esm-DE-Xb16W.js";import"./dialog-bdBi4zz3.js";import{C as ie,t as de}from"./tippy.esm-DBDhGERe.js";import{d as I,o as Ce,c as l,a as i,b as s,t as h,n as F,e as _,r as b,f as w,F as q,g as C,h as A,i as B,w as te,j as ht,k as he,v as Le,l as ee,m as ge,p as Fe,q as gt}from"./vue.esm-bundler-CSDHRrjm.js";import{v as vt}from"./v-click-outside.umd-BCtVgRUL.js";import{_ as rn}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as sn}from"./Browser.vue_vue_type_script_setup_true_lang-BbqD9HTD.js";import"./_commonjsHelpers-CqkleIqs.js";const yt="kanka.default";window.triggerEvent=function(t){t=t||yt;const e=new Event(t);document.dispatchEvent(e)};window.onEvent=function(t,e){e=e||yt,document.addEventListener(e,t)};window.onReady=function(t){document.readyState==="complete"||document.readyState==="interactive"?setTimeout(t,1):document.addEventListener("DOMContentLoaded",t)};window.initTags=function(){document.querySelectorAll(".form-tags")?.forEach(function(t){t.classList.contains("select2-hidden-accessible")||t.dataset.loaded!==1&&(t.dataset.loaded=1,$(t).select2({tags:t.dataset.allowNew==="true",allowClear:t.dataset.allowClear==="true",dropdownParent:t.dataset.dropdownParent||"",minimumInputLength:0,ajax:{quietMillis:500,delay:500,url:t.dataset.url,dataType:"json",data:function(e){return{q:e.term?.trim()}},processResults:function(e){return{results:e}},cache:!0},escapeMarkup:function(e){return e},createTag:function(e){const n=e.term?.trim();return n===""?null:{id:n,text:n,newTag:!0}},templateResult:function(e){const n=document.createElement("span");return n.classList.add("block","grow","text-left"),n.innerHTML=e.text,e.colour&&(n.classList.add("flex","gap-2","items-center","text-left"),n.innerHTML="<span class='rounded-full flex-none w-6 h-6 "+e.colour+"' /></span><span class='grow'>"+e.text+"</span>"),n},templateSelection:function(e,n){if(e.newTag){const a=document.createElement("span");return a.classList.add("new-tag"),a.title=t.dataset.newTag,a.innerHTML=e.text+' <i class="fa-solid fa-flag" aria-hidden="true"></i>',a}let o=e.element,r=[];return e.colour?r=e.colour.trim().split(" "):o.dataset.colour&&(r=o.dataset.colour.trim().split(" ")),r.length>0&&r.forEach(a=>{a.trim().length!==0&&n[0].classList.add(a)}),n[0].classList.add("text-left"),e.text}}))}),document.querySelectorAll(".position-dropdown")?.forEach(function(t){t.classList.contains("select2-hidden-accessible")||t.dataset.loaded!==1&&(t.dataset.loaded=1,$(t).select2({tags:!0,allowClear:!0,dropdownParent:t.dataset.dropdownParent||"",placeholder:t.dataset.placeholder,minimumInputLength:0,createTag:function(e){const n=e.term?.trim();return n===""?null:{id:n,text:n,newTag:!0}}}))})};window.initTags();var Ne={};var Qe;function an(){return Qe||(Qe=1,function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var t=jQuery.fn.select2.amd;t.define("select2/i18n/de",[],function(){return{errorLoading:function(){return"Die Ergebnisse konnten nicht geladen werden."},inputTooLong:function(e){return"Bitte "+(e.input.length-e.maximum)+" Zeichen weniger eingeben"},inputTooShort:function(e){return"Bitte "+(e.minimum-e.input.length)+" Zeichen mehr eingeben"},loadingMore:function(){return"Lade mehr Ergebnisse…"},maximumSelected:function(e){var n="Sie können nur "+e.maximum+" Element";return e.maximum!=1&&(n+="e"),n+=" auswählen"},noResults:function(){return"Keine Übereinstimmungen gefunden"},searching:function(){return"Suche…"},removeAllItems:function(){return"Entferne alle Elemente"}}}),t.define,t.require}()),Ne}an();var ze={};var Oe;function ln(){return Oe||(Oe=1,function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var t=jQuery.fn.select2.amd;t.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(e){var n=e.input.length-e.maximum,o="Please delete "+n+" character";return n!=1&&(o+="s"),o},inputTooShort:function(e){return"Please enter "+(e.minimum-e.input.length)+" or more characters"},loadingMore:function(){return"Loading more results…"},maximumSelected:function(e){var n="You can only select "+e.maximum+" item";return e.maximum!=1&&(n+="s"),n},noResults:function(){return"No results found"},searching:function(){return"Searching…"},removeAllItems:function(){return"Remove all items"}}}),t.define,t.require}()),ze}ln();var Ue={};var Ke;function cn(){return Ke||(Ke=1,function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var t=jQuery.fn.select2.amd;t.define("select2/i18n/es",[],function(){return{errorLoading:function(){return"No se pudieron cargar los resultados"},inputTooLong:function(e){var n=e.input.length-e.maximum,o="Por favor, elimine "+n+" car";return o+=n==1?"ácter":"acteres"},inputTooShort:function(e){var n=e.minimum-e.input.length,o="Por favor, introduzca "+n+" car";return o+=n==1?"ácter":"acteres"},loadingMore:function(){return"Cargando más resultados…"},maximumSelected:function(e){var n="Sólo puede seleccionar "+e.maximum+" elemento";return e.maximum!=1&&(n+="s"),n},noResults:function(){return"No se encontraron resultados"},searching:function(){return"Buscando…"},removeAllItems:function(){return"Eliminar todos los elementos"}}}),t.define,t.require}()),Ue}cn();var Ve={};var Ge;function dn(){return Ge||(Ge=1,function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var t=jQuery.fn.select2.amd;t.define("select2/i18n/fr",[],function(){return{errorLoading:function(){return"Les résultats ne peuvent pas être chargés."},inputTooLong:function(e){var n=e.input.length-e.maximum;return"Supprimez "+n+" caractère"+(n>1?"s":"")},inputTooShort:function(e){var n=e.minimum-e.input.length;return"Saisissez au moins "+n+" caractère"+(n>1?"s":"")},loadingMore:function(){return"Chargement de résultats supplémentaires…"},maximumSelected:function(e){return"Vous pouvez seulement sélectionner "+e.maximum+" élément"+(e.maximum>1?"s":"")},noResults:function(){return"Aucun résultat trouvé"},searching:function(){return"Recherche en cours…"},removeAllItems:function(){return"Supprimer tous les éléments"}}}),t.define,t.require}()),Ve}dn();var We={};var Ze;function un(){return Ze||(Ze=1,function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var t=jQuery.fn.select2.amd;t.define("select2/i18n/it",[],function(){return{errorLoading:function(){return"I risultati non possono essere caricati."},inputTooLong:function(e){var n=e.input.length-e.maximum,o="Per favore cancella "+n+" caratter";return o+=n!==1?"i":"e"},inputTooShort:function(e){return"Per favore inserisci "+(e.minimum-e.input.length)+" o più caratteri"},loadingMore:function(){return"Caricando più risultati…"},maximumSelected:function(e){var n="Puoi selezionare solo "+e.maximum+" element";return e.maximum!==1?n+="i":n+="o",n},noResults:function(){return"Nessun risultato trovato"},searching:function(){return"Sto cercando…"},removeAllItems:function(){return"Rimuovi tutti gli oggetti"}}}),t.define,t.require}()),We}un();var Ye={};var Je;function mn(){return Je||(Je=1,function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var t=jQuery.fn.select2.amd;t.define("select2/i18n/nl",[],function(){return{errorLoading:function(){return"De resultaten konden niet worden geladen."},inputTooLong:function(e){return"Gelieve "+(e.input.length-e.maximum)+" karakters te verwijderen"},inputTooShort:function(e){return"Gelieve "+(e.minimum-e.input.length)+" of meer karakters in te voeren"},loadingMore:function(){return"Meer resultaten laden…"},maximumSelected:function(e){var n=e.maximum==1?"kan":"kunnen",o="Er "+n+" maar "+e.maximum+" item";return e.maximum!=1&&(o+="s"),o+=" worden geselecteerd"},noResults:function(){return"Geen resultaten gevonden…"},searching:function(){return"Zoeken…"},removeAllItems:function(){return"Verwijder alle items"}}}),t.define,t.require}()),Ye}mn();var Xe={};var et;function fn(){return et||(et=1,function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var t=jQuery.fn.select2.amd;t.define("select2/i18n/pl",[],function(){var e=["znak","znaki","znaków"],n=["element","elementy","elementów"],o=function(r,a){return r===1?a[0]:r>1&&r<=4?a[1]:r>=5?a[2]:void 0};return{errorLoading:function(){return"Nie można załadować wyników."},inputTooLong:function(r){var a=r.input.length-r.maximum;return"Usuń "+a+" "+o(a,e)},inputTooShort:function(r){var a=r.minimum-r.input.length;return"Podaj przynajmniej "+a+" "+o(a,e)},loadingMore:function(){return"Trwa ładowanie…"},maximumSelected:function(r){return"Możesz zaznaczyć tylko "+r.maximum+" "+o(r.maximum,n)},noResults:function(){return"Brak wyników"},searching:function(){return"Trwa wyszukiwanie…"},removeAllItems:function(){return"Usuń wszystkie przedmioty"}}}),t.define,t.require}()),Xe}fn();var tt={};var nt;function pn(){return nt||(nt=1,function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var t=jQuery.fn.select2.amd;t.define("select2/i18n/pt-BR",[],function(){return{errorLoading:function(){return"Os resultados não puderam ser carregados."},inputTooLong:function(e){var n=e.input.length-e.maximum,o="Apague "+n+" caracter";return n!=1&&(o+="es"),o},inputTooShort:function(e){return"Digite "+(e.minimum-e.input.length)+" ou mais caracteres"},loadingMore:function(){return"Carregando mais resultados…"},maximumSelected:function(e){var n="Você só pode selecionar "+e.maximum+" ite";return e.maximum==1?n+="m":n+="ns",n},noResults:function(){return"Nenhum resultado encontrado"},searching:function(){return"Buscando…"},removeAllItems:function(){return"Remover todos os itens"}}}),t.define,t.require}()),tt}pn();var ot={};var rt;function hn(){return rt||(rt=1,function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var t=jQuery.fn.select2.amd;t.define("select2/i18n/ru",[],function(){function e(n,o,r,a){return n%10<5&&n%10>0&&n%100<5||n%100>20?n%10>1?r:o:a}return{errorLoading:function(){return"Невозможно загрузить результаты"},inputTooLong:function(n){var o=n.input.length-n.maximum,r="Пожалуйста, введите на "+o+" символ";return r+=e(o,"","a","ов"),r+=" меньше"},inputTooShort:function(n){var o=n.minimum-n.input.length,r="Пожалуйста, введите ещё хотя бы "+o+" символ";return r+=e(o,"","a","ов")},loadingMore:function(){return"Загрузка данных…"},maximumSelected:function(n){var o="Вы можете выбрать не более "+n.maximum+" элемент";return o+=e(n.maximum,"","a","ов")},noResults:function(){return"Совпадений не найдено"},searching:function(){return"Поиск…"},removeAllItems:function(){return"Удалить все элементы"}}}),t.define,t.require}()),ot}hn();var st={};var at;function gn(){return at||(at=1,function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var t=jQuery.fn.select2.amd;t.define("select2/i18n/sk",[],function(){var e={2:function(n){return n?"dva":"dve"},3:function(){return"tri"},4:function(){return"štyri"}};return{errorLoading:function(){return"Výsledky sa nepodarilo načítať."},inputTooLong:function(n){var o=n.input.length-n.maximum;return o==1?"Prosím, zadajte o jeden znak menej":o>=2&&o<=4?"Prosím, zadajte o "+e[o](!0)+" znaky menej":"Prosím, zadajte o "+o+" znakov menej"},inputTooShort:function(n){var o=n.minimum-n.input.length;return o==1?"Prosím, zadajte ešte jeden znak":o<=4?"Prosím, zadajte ešte ďalšie "+e[o](!0)+" znaky":"Prosím, zadajte ešte ďalších "+o+" znakov"},loadingMore:function(){return"Načítanie ďalších výsledkov…"},maximumSelected:function(n){return n.maximum==1?"Môžete zvoliť len jednu položku":n.maximum>=2&&n.maximum<=4?"Môžete zvoliť najviac "+e[n.maximum](!1)+" položky":"Môžete zvoliť najviac "+n.maximum+" položiek"},noResults:function(){return"Nenašli sa žiadne položky"},searching:function(){return"Vyhľadávanie…"},removeAllItems:function(){return"Odstráňte všetky položky"}}}),t.define,t.require}()),st}gn();window.initForeignSelect=function(){const t=document.querySelectorAll("select.select2");t.length!==0&&(t.forEach(e=>{if(e.classList.contains("select2-hidden-accessible"))return;if(e.classList.contains("campaign-genres")){$(e).select2({tags:!1,allowClear:!0,dropdownParent:"",width:"100%",maximumSelectionLength:3});return}const n=e.dataset.url,o=e.dataset.allowClear,r=e.dataset.dropdownParent||"",a=e.dataset.placeholder;if(!n){$(e).select2({tags:!1,placeholder:a,allowClear:o??!1,language:e.dataset.language,minimumInputLength:0,dropdownParent:r,width:"100%"});return}$(e).select2({tags:e.dataset.allowNew==="true",placeholder:a,allowClear:o||!0,language:e.dataset.language,minimumInputLength:0,dropdownParent:r,width:"100%",ajax:{delay:500,quietMillis:500,url:n,dataType:"json",data:function(u){return{q:u.term?.trim()}},processResults:function(u){return{results:u}},error:function(u){return u.status===503&&window.showToast(u.responseJSON.message,"error"),{results:[]}},cache:!0},templateResult:vn,templateSelection:yn,escapeMarkup:function(u){return u},createTag:function(u){if(e.dataset.allowNew!=="true")return null;let c=u.term?.trim();return c===""?null:{id:c,text:c+" ("+e.dataset.newTag+")",newTag:!0}}})}),wn(),bn())};const vn=t=>{const e=document.createElement("span");return t.image?(e.classList.add("flex","gap-2","items-center","text-left"),e.innerHTML="<img src='"+t.image+"' class='rounded-full flex-none w-6 h-6'/><span class='grow'>"+t.text+"</span>"):e.innerHTML=t.text,e},yn=t=>{if(!t.id)return t.text;const e=document.createElement("span");return e.innerHTML=t.text,e},wn=()=>{const t=document.querySelectorAll("select.select2-local");t.length!==0&&t.forEach(e=>{$(e).select2({placeholder:e.dataset.placeholder,language:e.dataset.language,allowClear:!0})})},bn=()=>{const t=document.querySelectorAll("select.select2-colour");t.length!==0&&t.forEach(e=>{$(e).select2({placeholder:e.dataset.placeholder,language:e.dataset.language,allowClear:!1,templateResult:it,templateSelection:it})})},it=t=>{if(t.id==="none")return t.text;const e=document.createElement("span");return e.innerHTML='<div class="badge label bg-'+t.id+'"> </div>'+t.text,e},wt=()=>{document.querySelectorAll("form[data-shortcut]").forEach(function(e){kn(e)})},bt=()=>{document.addEventListener("keydown",function(t){const e=t.target,n=document.getElementById("primary-dialog"),o=document.querySelector(".quick-creator-button");let r=document.querySelector('[data-keyboard="edit"]');if(t.key==="]"){if(ae(e))return;t.preventDefault();const a=document.querySelector(".sidebar-toggle");a.click(),a.blur()}else if(t.key==="k"){if(ae(e))return;t.preventDefault(),document.getElementById("entity-lookup").focus()}else if(t.key==="n"&&!(t.ctrlKey||t.metaKey)&&!t.altKey&&o){if(ae(e)||n?.open)return;o.click()}else if(t.key==="e"&&!(t.ctrlKey||t.metaKey)&&r){if(ae(e)||n?.open)return;r.click()}else t.key==="Escape"&&n?.classList.contains("qq-modal-selection").length===1&&window.closeDialog(n)})},ae=t=>!t||t.length===0?!1:["input","textarea","select"].includes(t.tagName.toLowerCase())||t.getAttribute("contentEditable")==="true"?!0:!!t.classList.contains("CodeMirror"),kn=t=>{t.dataset.shortcutInit||(t.dataset.shortcutInit=1,document.addEventListener("keydown",function(e){if((e.ctrlKey||e.metaKey)&&e.key.toLowerCase()==="s")return e.preventDefault(),t.dataset.unload&&(window.entityFormHasUnsavedChanges=!1),e.shiftKey?ve("submit-update"):e.altKey&&ve("submit-new"),t.requestSubmit(),console.log("requested tos ubmit",t),!1;if((e.ctrlKey||e.metaKey)&&e.altKey&&e.key==="c")return t.dataset.unload&&(window.entityFormHasUnsavedChanges=!1),ve("submit-copy"),t.submit(),!1}))},ve=t=>{const e=document.getElementById("form-submit-main");e&&(e.name=t,document.getElementById("submit-mode").name=t)},kt=()=>{document.querySelectorAll('input[data-paste="fontawesome"]').forEach(function(e){e.addEventListener("paste",function(n){n.preventDefault();const o=(n.clipboardData||window.clipboardData).getData("text");if(o.startsWith('<i class="fa')||o.startsWith('<i class="ra')){const r=document.createElement("div");r.innerHTML=o;let u=r.querySelector("i").getAttribute("class");if(u){e.value=u;return}}e.value=o})})};wt();bt();kt();window.onEvent(function(){kt(),bt(),wt()});function xn(){window.onEvent(function(){xt()})}function Ln(){const t=document.querySelector('#form-entry input[name="name"]');t&&(t.dataset.liveDisabled||t.addEventListener("focusout",function(e){if(!t.value)return;const n=this.dataset.duplicate,o=document.querySelector(n);if(!o)return;const r=this.dataset.live+"?q="+encodeURIComponent(this.value)+"&exclude="+this.dataset.id;o.classList.add("hidden");const a=o.querySelector(".duplicates");fetch(r).then(u=>u.json()).then(u=>{a.innerHTML="",u.forEach(c=>{const d=document.createElement("a");d.href=c.url,d.text=c.name,a.appendChild(d)}),u.length>0&&o.classList.remove("hidden")})}))}const xt=()=>{const t=document.querySelectorAll(".form-submit-actions");if(t.length===0)return;let e=document.getElementById("form-submit-main"),n=document.getElementById("submit-mode");if(n===void 0)throw new Error("No submit mode hidden input found");t.forEach(o=>{o.addEventListener("click",function(r){return r.preventDefault(),n.name=o.dataset.action,e.click(),!1})})};function _n(){if(document.querySelectorAll('form[data-unload="1"]').length===0)return;const e=document.querySelector("#form-submit-main");document.querySelectorAll('form[data-unload="1"] input, form[data-unload="1"] select, form[data-unload="1"] textarea').forEach(o=>{o.dataset.skipUnsaved||o.classList.contains("form-control")||(o.addEventListener("change",function(){window.entityFormHasUnsavedChanges=!0}),o.classList.contains("select2")&&(o.onchange=()=>{window.entityFormHasUnsavedChanges=!0}))}),e&&window.addEventListener("beforeunload",function(o){window.entityFormHasUnsavedChanges&&(o.preventDefault(),o.returnValue="Unsaved data warning")})}const Sn=()=>{document.querySelectorAll(".dynamic-row-add").forEach(e=>{e.addEventListener("click",function(n){n.preventDefault();const o=e.dataset.target,r=e.dataset.template,a=document.createElement("div");return a.innerHTML=document.querySelector("#"+r).innerHTML,document.querySelector("."+o).append(a),lt(),window.triggerEvent(),!1})}),lt()},lt=()=>{document.querySelectorAll(".dynamic-row-delete").forEach(e=>{e.dataset.init!==1&&(e.dataset.init=1,e.addEventListener("click",function(n){n.preventDefault(),e.closest(".parent-delete-row").remove()}),e.addEventListener("keydown",function(n){n.key==="Enter"&&e.click()}))})};Sn();xt();_n();xn();Ln();const Lt=()=>{document.querySelector(".btn-post-collapse")?.addEventListener("click",function(n){n.preventDefault(),document.querySelectorAll(".element-toggle").forEach(r=>{r.classList.add("animate-collapsed"),document.querySelector(r.dataset.target).classList.add("hidden")})}),document.querySelector(".btn-post-expand")?.addEventListener("click",function(n){n.preventDefault(),document.querySelectorAll(".element-toggle").forEach(r=>{r.classList.remove("animate-collapsed"),document.querySelector(r.dataset.target).classList.remove("hidden")})})},_t=()=>{const t=document.querySelector(".story-load-more");t?.addEventListener("click",function(e){return e.preventDefault(),this.classList.add("loading"),axios.get(this.dataset.url).then(n=>{t.parentNode.remove(),console.log(n),document.querySelector(".entity-posts").insertAdjacentHTML("beforeend",n.data),_t(),Lt(),window.triggerEvent()}).catch(()=>{t.classList.remove("loading")}),!1})},qn=()=>{const t=document.querySelector(".domain-trust");t&&t.addEventListener("click",function(e){const n="kanka_trusted_domains";let o=document.cookie.match("(^|;) ?"+n+"=([^;]*)(;|$)");o=o?o[2]:"";const r=t.dataset.domain;o.includes(r)||(o&&(o+="|"),o+=r);let a=new Date;a.setTime(a.getTime()+30*24*60*60*1e3),document.cookie=n+"="+o+";path=/;expires="+a.toUTCString()+";sameSite=Strict"})},En=()=>{let t=window.location.hash.substring(1);if(!t)return;let e=document.getElementById(t);if(e)return;let n=document.getElementById("post-anchor-loader");if(!n)return;let o=t.match(/\d+$/),r=n.dataset.url.replace("/0","/"+o);axios.get(r).then(a=>{n.insertAdjacentHTML("afterbegin",a.data),e=document.getElementById(t),window.scrollTo({top:e.offsetTop,behavior:"smooth"})})};Lt();_t();qn();En();const St=document.querySelectorAll(".post-perm-add"),Tn=()=>{window.onEvent(function(){Mn()}),St.length!==0&&(Cn(),qt())},Cn=()=>{St.forEach(t=>{t.addEventListener("click",function(e){e.preventDefault();let n=this.dataset.type,o=document.querySelector('select[name="'+n+'"]');if(!o||!o.selectedOptions)return!1;let r=document.getElementById(this.dataset.template);for(const u of o.selectedOptions){const c=r.cloneNode(!0);c.classList.remove("hidden"),c.removeAttribute("id"),c.innerHTML=c.innerHTML.replace(/\$SELECTEDID\$/g,u.value).replace(/\$SELECTEDNAME\$/g,u.text),document.getElementById("post-perm-target").insertAdjacentElement("beforebegin",c)}document.getElementById(this.dataset.dialog).close(),qt();for(const u of o.options)u.selected=!1;return o.value=null,o.dispatchEvent(new Event("change")),!1})})},qt=()=>{document.querySelectorAll(".post-delete-perm").forEach(e=>{e.closest(".hidden")||e.dataset.init!=="1"&&(e.dataset.init="1",e.addEventListener("click",function(n){console.log("clicking",e,e.closest(".perm-row")),e.closest(".perm-row").remove(),n.preventDefault()}))})},Mn=()=>{const t=document.querySelector("form.post-visibility");t&&(t.onsubmit=function(e){return e.preventDefault(),axios.post(this.getAttribute("action"),{visibility_id:this.querySelector('[name="visibility_id"]').value}).then(n=>{document.getElementById("primary-dialog").close(),document.getElementById("visibility-icon-"+n.data.post_id).firstElementChild.className=n.data.icon.class,window.showToast(n.data.toast)}),!1})};Tn();const An=()=>{let t=document.getElementById("post-layout-selector");if(!t)return;const e=document.querySelector(".field-entry"),n=document.querySelector(".field-location"),o=document.querySelector(".field-display"),r=document.querySelector("#post-layout-subform");t.addEventListener("change",function(a){a.preventDefault(),this.value===""?(e.style.removeProperty("display"),e.style.removeProperty("display"),o.style.removeProperty("display"),r.style.display="none"):(e.style.display="none",n.style.display="none",o.style.display="none",r.style.removeProperty("display"))})};An();const Dn=()=>{if(!document.querySelector("#calendar-year-switcher"))return;document.querySelectorAll(".calendar-event-block").forEach(e=>{e.dataset.toggle!=="dialog"&&e.dataset.url&&e.addEventListener("click",function(){window.location=e.dataset.url})}),document.querySelectorAll("[data-dbclick]").forEach(function(e){e.addEventListener("dblclick",function(){window.openDialog("primary-dialog",e.dataset.url)})})},Et=()=>{const t=document.querySelector('select[name="recurring_periodicity"]');t&&(t.onchange=function(){const e=document.querySelector(".field-recurring-until");t.value?e.classList.remove("hidden"):e.classList.add("hidden")})},$n=()=>{document.querySelector('[data-shortcut="previous"]')&&document.addEventListener("keydown",function(t){if((t.ctrlKey||t.metaKey)&&t.which===37){const e=document.querySelector('[data-shortcut="previous"]');e.classList.add("loading"),e.click()}else if((t.ctrlKey||t.metaKey)&&t.which===39){const e=document.querySelector('[data-shortcut="next"]');e.classList.add("loading"),e.click()}})};Dn();$n();document.querySelector('select[name="recurring_periodicity"]')&&Et();window.onEvent(function(){Et()});let X,T,ye,N,R,D,ct,le,Q;window.onEvent(function(){Hn()});const jn=()=>{X=document.querySelector("#entity-calendar-form-add"),T=document.querySelector('select[name="calendar_id"]'),ye=document.querySelector('[name="calendar_id"]'),document.querySelector(".entity-calendar-modal-form"),Q=document.querySelector(".entity-calendar-subform"),ct=document.querySelector("#entity-calendar-form-cancel"),document.querySelector(".entity-calendar-form"),R=document.querySelector('input[name="calendar_year"]'),N=document.querySelector('[name="calendar_month"]'),D=document.querySelector("#reminder_day"),le=document.querySelector(".entity-calendar-loading"),X&&(X.addEventListener("click",function(t){t.preventDefault();let e=X.dataset.defaultCalendar;return e&&(ye.value=e,Q.classList.remove("hidden"),ce(e)),!1}),ct.addEventListener("click",function(t){t.preventDefault(),T&&(T.value=null),ye.value=null})),T&&(T.onchange=t=>{if(console.log("hello mlord"),!T.value)return Q.classList.add("hidden"),!1;Q.classList.remove("hidden"),R=document.querySelector('input[name="calendar_year"]'),N=document.querySelector('[name="calendar_month"]'),D=document.querySelector("#reminder_day"),!R&&document.querySelector('input[name="year"]')&&(R=document.querySelector('input[name="year"]'),N=document.querySelector('select[name="month"]'),D=document.querySelector("#reminder_day")),ce(T.value)}),Tt()},Hn=()=>{if(!document.getElementById("entity-calendar-modal-add"))return;X=document.querySelector("input[name=calendar-data-url]"),T=document.querySelector('[name="calendar_id"]'),R=document.querySelector('input[name="year"]'),N=document.querySelector('select[name="month"]'),D=document.querySelector("#reminder_day"),le=document.querySelector(".entity-calendar-loading"),Q=document.querySelector(".entity-calendar-subform"),T&&(T.onchange=e=>{if(!T.value){Q.classList.add("hidden");return}ce(T.value),Q.classList.remove("hidden")},T?.value&&ce(T.value));const t=document.querySelector('.entity-calendar-subform input[name="length"]');t&&t.addEventListener("focusout",function(){if(!this.value)return;const e=this.dataset.url.replace("/0/","/"+T.value+"/"),n={day:D.value,month:N.value,year:R.value,length:this.value};axios.get(e,{data:n}).then(o=>{const r=document.querySelector(".length-warning");o.data.overflow==!0?r.classList.remove("hidden"):r.classList.add("hidden")})}),Tt()},ce=t=>{le.classList.remove("hidden"),t=parseInt(t);const e=document.querySelector('input[name="calendar-data-url"]').dataset.url.replace("/0/","/"+t+"/");fetch(e).then(n=>n.json()).then(n=>{let o=D.value;R.innerHTML="",N.innerHTML="",D.innerHTML="";let r=1,a=1;o||(o=n.current.day);let u=parseInt(n.current.month);Object.entries(n.months).forEach((m,p)=>{const v=document.createElement("option");v.text=m[1].name,v.value=p+1,m[0]===u&&(v.selected=!0),v.dataset.length=m[1].length,N.appendChild(v),r===u&&(a=m[1].length),r++});for(let m=1;m<=a;m++){const p=document.createElement("option");p.text=m,p.value=m,m==o&&(p.selected=!0),D.appendChild(p)}le.classList.add("hidden"),R.value=n.current.year;const d=document.querySelector("select.reminder-periodicity");for(;d.options.length>0;)d.options.remove(0);Object.entries(n.recurring).forEach((m,p)=>{const v=document.createElement("option");v.value=m[0],v.text=m[1],d.appendChild(v)}),document.querySelector("#reminder_length").value=1,n.length===1&&(N.value=n[0].id)})},Tt=()=>{const t=document.querySelector("#reminder_month");t&&t.addEventListener("change",function(e){const o=t.options[t.selectedIndex].dataset.length;In(o)})},In=t=>{let e=parseInt(D.value);t=parseInt(t),e>t&&(e=t),D.innerHTML="";for(let n=1;n<=t;n++){const o=document.createElement("option");o.text=n,o.value=n,n===e&&(o.selected=!0),D.appendChild(o)}};jn();const Ct=document.querySelector("dialog#edit-warning"),_e=300*1e3;let Pn=document.querySelector('input[name="edit-warning"]'),Mt,Se=!0;const Bn=()=>{Ct&&(window.openDialog("edit-warning",Pn.dataset.url),window.onEvent(function(){Rn()}),Fn())};function Rn(){Se=!1;const t=document.getElementById("entity-edit-warning-ignore");t.addEventListener("click",function(e){e.preventDefault(),Se=!0,axios.post(t.dataset.url).then(()=>{Ct.close()})})}const Fn=()=>{const t=document.getElementById("editing-keep-alive");t&&(Mt=t.dataset.url,setTimeout(qe,_e))},qe=()=>{if(!Se){setTimeout(qe,_e);return}axios.post(Mt).then(()=>{setTimeout(qe,_e)})};window.onReady(()=>{Bn()});let J,At,Dt,ne;const Me=()=>{At=document.querySelector("#qq-modal-loading"),Dt=document.querySelector("#qq-modal-selection"),ne=document.querySelector("#qq-modal-form"),document.querySelectorAll('[data-toggle="entity-creator"]').forEach(t=>{t.addEventListener("click",Nn)})},Nn=t=>{t.preventDefault();const e=t.currentTarget;return e.dataset.type==="inline"?(document.querySelector(".quick-creator-body").classList.add("hidden"),document.querySelector(".quick-creator-footer")?.classList.add("hidden"),document.querySelector(".quick-creator-loading").classList.remove("hidden!")):Qn(),axios.get(e.dataset.url).then(o=>{At.classList.add("hidden!"),Dt.classList.add("hidden!"),ne.innerHTML=o.data,ne.classList.remove("hidden!"),Ae(),De(),window.triggerEvent()}),!1},$t=()=>{const t=document.querySelector("#qq-name-field");!t||t.dataset.init==="1"||(t.dataset.init="1",t.addEventListener("focusout",function(){if(!this.value)return;const e=this.parentNode.querySelector(".duplicate-entity-warning");if(!e)return;e.classList.add("hidden");const n=this.dataset.live+"?q="+this.value+"&type="+this.dataset.type;axios.get(n).then(o=>{if(o.data.length===0){e.classList.add("hidden");return}const r=Object.keys(o.data).map(function(a){return'<a href="'+o.data[a].url+'">'+o.data[a].name+"</a>"}).join(", ");t.parentNode.querySelector(".duplicate-entities").innerHTML=r,e.classList.remove("hidden")})}))},Qn=()=>{document.querySelector("#qq-modal-form").classList.add("hidden!"),document.querySelector("#qq-modal-selection").classList.add("hidden!"),document.querySelector("#qq-modal-loading").classList.remove("hidden!")},Ae=()=>{J=document.querySelectorAll(".quick-creator-submit"),J.length!==0&&($t(),De(),J.forEach(t=>{t.addEventListener("click",function(e){let n=this.value;return n&&(document.querySelector('#entity-creator-form [name="action"]').value=n),!0})}),document.getElementById("entity-creator-form").onsubmit=function(t){const e=t.target;t.preventDefault(),J.forEach(r=>r.classList.add("btn-disabled","loading")),document.querySelectorAll("div.text-error").forEach(r=>r.remove());const o=new FormData(e);axios.post(e.getAttribute("action"),o).then(r=>{if(typeof r.data=="object"){if(r.data.redirect){window.location.replace(r.data.redirect);return}let u=new Option(r.data._name,r.data._id,!0,!0),c=document.querySelector("#"+r.data._target);c.appendChild(u),c.dispatchEvent(new Event("change"));const d=document.querySelector("#qq-modal-form");d&&(d.innerHTML="",d.classList.remove("hidden!")),document.querySelector("#qq-modal-loading")?.classList.add("hidden!"),document.querySelector("#qq-modal-selection")?.classList.remove("hidden!"),document.getElementById("primary-dialog").close(),Ee();return}let a=document.getElementById("qq-modal-form");a.innerHTML=r.data,window.triggerEvent(),Me(),Ee()}).catch(r=>{r.response&&window.formErrorHandler(r.response,e),J.forEach(a=>a.classList.remove("btn-disabled","loading")),document.querySelector('#entity-creator-form [name="action"]').value=""})})},De=()=>{document.querySelectorAll(".qq-mode-toggle").forEach(t=>{t.addEventListener("click",function(e){e.preventDefault(),!this.classList.contains("active")&&(document.querySelector(".qq-mode-toggle").classList.remove("active"),this.classList.add("active"),document.querySelector(".quick-creator-body").classList.add("hidden"),document.querySelector(".quick-creator-footer")?.classList.add("hidden"),document.querySelector(".quick-creator-loading").classList.remove("hidden!"),axios.get(this.dataset.url).then(n=>{ne.innerHTML=n.data,ne.classList.remove("hidden!"),Ee(),window.triggerEvent()}))})}),document.querySelector(".qq-action-more")?.addEventListener("click",function(t){t.preventDefault(),this.classList.add("hidden"),document.querySelector(".qq-more-fields").classList.remove("hidden")}),Me()},Ee=()=>{De(),$t(),Ae()},zn=()=>{document.querySelectorAll(".quick-creator-subform").forEach(e=>{e.addEventListener("click",n=>{window.openDialog("primary-dialog",e.dataset.url)})})};window.onEvent(function(){Me(),Ae()});zn();const jt=()=>{document.querySelectorAll("[data-bulk-action]")?.forEach(n=>{n.addEventListener("click",o=>{o.preventDefault(),Un(n.dataset.bulkAction)})}),document.querySelectorAll(".bulk-print")?.forEach(n=>{n.addEventListener("click",o=>{o.preventDefault(),n.closest("form").requestSubmit()})})},Ht=()=>{On(),document.querySelectorAll("input[name='model[]']")?.forEach(e=>{e.dataset.initiated!=="1"&&(e.dataset.initiated="1",e.addEventListener("change",n=>{console.log("change"),n.preventDefault(),$e()}))})},On=()=>{const t=document.querySelector("#datagrid-select-all");t&&t.dataset.loaded!=="1"&&(t.dataset.loaded="1",t.addEventListener("click",function(e){const n=document.querySelectorAll("input[name='model[]']");t.checked?n?.forEach(o=>{o.checked=!0}):n?.forEach(o=>{o.checked=!1}),$e()}))},Un=t=>{let e=[];document.querySelectorAll("input[name='model[]']")?.forEach(o=>{o.checked&&e.push(o.value)}),t==="ajax"?window.onEvent(function(){document.querySelector('#primary-dialog input[name="models"]').value=e.toString()}):document.querySelector("#datagrid-bulk-"+t+"-models").value=e.toString()},$e=()=>{let t=!0;document.querySelectorAll("input[name='model[]']")?.forEach(o=>{o.checked&&(t=!1)}),document.querySelectorAll(".datagrid-bulk-actions .btn2")?.forEach(o=>{t?(o.disabled=!0,o.classList.add("btn-disabled")):(o.disabled=!1,o.classList.remove("btn-disabled","disabled"))})},Kn=()=>{const t=document.querySelector(".list-treeview");if(!t)return;let e=t.dataset.url;document.querySelectorAll(".table-nested > tbody > tr").forEach(function(o){let r=o.dataset.children;parseInt(r)>0&&(o.classList.add("tr-hover"),o.classList.add("cursor-pointer"),o.addEventListener("click",function(a){const u=a.target;a.target.type!=="checkbox"&&u.dataset.tree!=="escape"&&(window.location=e+"?parent_id="+o.dataset.id+"&m=table")}))})};Ht();jt();$e();Kn();window.onEvent(function(){jt(),Ht()});let V;const Vn=new IntersectionObserver(function(t){t.forEach(e=>{e.isIntersecting===!0&&je(e.target)})},{threshold:[0]}),It=()=>{document.querySelectorAll('table[data-render="datagrid2"]')?.forEach(e=>{je(e)})},je=t=>{Zn(t),t.dataset.initiated!=="1"&&(t.dataset.initiated="1",Gn(t),t.dataset.url&&Te(t,t))},Gn=t=>{t.querySelectorAll("thead a")?.forEach(e=>{e.dataset.loaded!=="1"&&(e.dataset.loaded="1",e.addEventListener("click",function(n){n.preventDefault(),Te(e,t)}))}),t.parentNode.querySelectorAll('nav[role="navigation"] a')?.forEach(e=>{e.dataset.loaded!=="1"&&(e.dataset.loaded="1",e.addEventListener("click",n=>{n.preventDefault(),Te(e,t)}))})},Wn=()=>{const t=document.querySelectorAll('[data-render="datagrid2-onload"]');t.length!==0&&t.forEach(e=>{Vn.observe(e)})},Te=(t,e)=>{e.querySelector("thead")?.classList.add("hidden"),e.querySelector("tbody")?.classList.add("hidden"),e.querySelector("tfoot")?.classList.remove("hidden");let n=t.getAttribute("href");t.dataset.url&&(n=t.dataset.url),e.parentNode&&axios.get(n).then(o=>{const r=e.parentNode;if(o.data.html&&(r.innerHTML=o.data.html),o.data.deletes){const u=document.querySelector("#datagrid-delete-forms");u&&(u.innerHTML=o.data.deletes)}o.data.url&&window.history.pushState({},"",o.data.url);const a=r.querySelector('[data-render="datagrid2"]');je(a),window.triggerEvent()}).catch(o=>{})},Zn=t=>{const e=t.parentNode;e.querySelectorAll(".datagrid-bulk")?.forEach(r=>{Jn(t,r)}),e.querySelectorAll(".datagrid-submit")?.forEach(r=>{Yn(t,r)}),document.querySelector("#datagrid-action-confirm")?.addEventListener("click",function(){window.closeDialog("datagrid-bulk-delete"),V.submit()})},Yn=(t,e)=>{e.parentNode.classList.contains("hidden")||e.dataset.loaded!=="1"&&(e.dataset.loaded="1",console.log("register bulk submit",e,e.parentNode),e.addEventListener("click",function(n){n.preventDefault(),V=e.closest("form");const o=V.querySelector('input[name="action"]');if(o.value=e.dataset.action,e.dataset.action==="delete")return window.openDialog("datagrid-bulk-delete"),!1;t.parentNode.querySelectorAll(".datagrid-bulk-actions .btn2")?.forEach(r=>r.classList.add("btn-disabled")),t.parentNode.querySelector(".datagrid-bulk-actions .btn2").classList.add("loading"),V.submit()}))},Jn=(t,e)=>{e.parentNode.classList.contains("hidden")||e.dataset.loaded!=="1"&&(e.dataset.loaded="1",e.addEventListener("click",function(n){n.preventDefault(),V=t.closest("form"),axios.post(V.getAttribute("action")+"?action=edit",{model:Xn(t)}).then(o=>{const r=document.getElementById("primary-dialog");r.innerHTML=o.data,window.openDialog("primary-dialog"),window.triggerEvent()})}))},Xn=t=>{let e=[];return t.querySelectorAll("input[name='model[]']")?.forEach(o=>{o.checked&&e.push(o.value)}),e};Wn();It();window.onEvent(function(){It()});const Pt=()=>{document.querySelectorAll('[data-animate="collapse"]').forEach(r=>{r.addEventListener("click",to)}),document.querySelectorAll('[data-animate="reveal"]').forEach(r=>{r.addEventListener("change",no)}),document.querySelectorAll("[data-pulse]").forEach(r=>{r.addEventListener("click",eo)}),document.querySelectorAll("select.permission-control").forEach(r=>{Bt(r),r.addEventListener("change",oo)})},eo=t=>{t.preventDefault();let e=document.querySelector(t.currentTarget.dataset.pulse),n=t.currentTarget.dataset.content;window.showTooltip(e,{content:n,theme:"kanka",placement:t.currentTarget.dataset.placement??"bottom",allowHTML:!0,arrow:!0,interactive:!0,trigger:"manual"})};function to(t){t.target.type!=="checkbox"&&t.preventDefault();let e=this.dataset.target;e||(e=this.hash),document.querySelectorAll(e).forEach(o=>{o.classList.toggle("hidden")}),this.classList.toggle("animate-collapsed")}function no(t){let e=document.querySelector(this.dataset.target);this.value?e.classList.remove("hidden"):e.classList.add("hidden")}function oo(t){Bt(this)}function Bt(t){t.classList.remove("text-red-500","text-green-500"),t.value==="deny"?t.classList.add("text-red-500"):t.value==="allow"&&t.classList.add("text-green-500")}window.onEvent(function(){Pt()});Pt();const ro=()=>{const t=document.getElementById("bookmark-selector");if(!t)return!1;t.addEventListener("change",function(e){e.preventDefault();const n=t.options[t.selectedIndex];document.querySelectorAll(".bookmark-subform").forEach(a=>{a.classList.add("opacity-0","invisible","h-0")});let r=document.querySelector(n.dataset.target);r&&r.classList.remove("opacity-0","invisible","h-0")})};ro();const so=()=>{let t=document.getElementById("webhook-selector");if(!t)return!1;t.addEventListener("change",function(e){e.preventDefault();let n=this.options[this.selectedIndex];document.querySelector(".webhook-subform").classList.add("hidden"),document.querySelector(n.dataset.target)?.classList.remove("hidden")})};so();window.onEvent(function(){Rt()});const Rt=()=>{document.querySelectorAll(".form-members").forEach(e=>{if(e.dataset.loaded===1)return;e.dataset.loaded=1;let n=e.dataset.allowClear;$(e).select2({tags:!0,allowClear:n||!0,minimumInputLength:2,placeholder:e.dataset.placeholder,ajax:{quietMillis:500,delay:500,url:e.dataset.url,dataType:"json",data:function(o){return{q:o.term?.trim()}},processResults:function(o){return{results:o}},cache:!0},createTag:function(){},escapeMarkup:function(o){return o},templateSelection:function(o){return o.text?`<span>${o.text}</span>`:o.text}})})};Rt();const ao=()=>{if(!document.getElementById("campaign-modules"))return;document.querySelectorAll('input[name="enabled"]').forEach(function(n){io(n)})},io=t=>{t.addEventListener("change",function(e){e.preventDefault(),t.closest(".toggle").classList.add("hidden!"),t.closest(".box-module").querySelector(".action-loading").classList.remove("hidden"),axios.post(t.dataset.url).then(n=>{t.closest(".toggle").classList.remove("hidden!"),t.closest(".box-module").querySelector(".action-loading").classList.add("hidden"),n.data.success&&(n.data.status?t.closest(".box-module").classList.add("module-enabled"):t.closest(".box-module").classList.remove("module-enabled"),window.showToast(n.data.toast))})})},lo=()=>{document.querySelectorAll(".public-permission").forEach(e=>{e.addEventListener("click",co)})},co=t=>{t.preventDefault();let e=t.currentTarget;e.querySelector(".module-icon").classList.add("hidden"),e.querySelector(".loading-animation").classList.remove("hidden"),axios.post(e.dataset.url).then(n=>{e.querySelector(".module-icon").classList.remove("hidden"),e.querySelector(".loading-animation").classList.add("hidden"),n.data.success&&(n.data.status?e.classList.add("enabled"):e.classList.remove("enabled"),window.showToast(n.data.toast))})},uo=()=>{document.querySelectorAll(".codemirror").forEach(function(e){CodeMirror.fromTextArea(document.getElementById(e.id),{extraKeys:{"Ctrl-Space":"autocomplete"},lineNumbers:!0,lineWrapping:!0,theme:"dracula"})})},mo=()=>{let t=[].slice.call(document.querySelectorAll(".nested-sortable"));for(let e=0;e<t.length;e++)new pt(t[e],{group:"nested",handle:".dnd-handle",animation:150,fallbackOnBody:!0,swapThreshold:.65,onMove:function(n,o){let r=n.dragged,u=n.related.parentNode.closest(".fixed-position")!=null;return!(r.classList.contains("fixed-position")&&u)}})},fo=()=>{const t=document.querySelector("form#campaign-style");t&&t.addEventListener("submit",function(e){let n=document.querySelector(t.dataset.error);return document.querySelector('textarea[name="content"]').value.length<t.dataset.maxContent?(n.classList.add("hidden"),!0):(n.classList.remove("hidden"),e.preventDefault(),!1)})},po=()=>{const t=document.querySelector('input[name="vanity"]');t&&t.addEventListener("focusout",function(e){let n=this.value,o=document.getElementById("vanity-error"),r=document.getElementById("vanity-success"),a=document.getElementById("vanity-loading");if(o.innerHTML="",o.classList.add("hidden"),r.classList.add("hidden"),!n)return;r.classList.remove("hidden");let u={};u.vanity=n,axios.post(this.dataset.url,u).then(c=>{t.value=c.data.vanity,r.querySelector("code").innerHTML=c.data.vanity,o.classList.add("hidden"),a.classList.add("hidden"),r.classList.remove("hidden")}).catch(c=>{let d="";c.response.data.errors.vanity.forEach(f=>d+=f+" "),o.innerHTML=d,o.classList.remove("hidden"),r.classList.add("hidden"),a.classList.add("hidden")})})},ho=()=>{document.querySelectorAll(".permission-toggle").forEach(e=>{e.addEventListener("click",function(n){n.preventDefault();let o=this.dataset.action,r=document.querySelectorAll('input[data-action="'+o+'"]'),a=this.dataset.checked!=="1";this.dataset.checked=a?1:0,r.forEach(u=>{a?u.checked=!0:u.checked=!1})})})};ao();uo();mo();lo();fo();po();ho();const Ft=()=>{document.querySelectorAll("[data-clipboard]").forEach(e=>{e.addEventListener("click",go,!1)})};function go(t){t.preventDefault(),vo(this.dataset.clipboard,this);let e=this.dataset.toast;return e&&window.showToast(e),!1}async function vo(t,e){if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(t);else{const n=document.createElement("textarea");n.value=t,n.style.position="absolute",n.style.left="-999999px",e.append(n),n.select();try{document.execCommand("copy")}catch(o){console.error(o)}finally{n.remove()}}}Ft();window.onEvent(function(){Ft()});const Nt=()=>{document.querySelectorAll('.toast-container [data-toggle="dismiss"]').forEach(e=>{e.dataset.init!=="1"&&(e.dataset.init="1",e.addEventListener("click",function(n){n.preventDefault();let o=e.closest(".toast-message");o.classList.remove("opacity-100"),o.classList.add("opacity-0"),setTimeout(function(){o.remove()},150)}))})};window.showToast=function(t,e){e=e||"bg-success text-success-content",e==="error"&&(e="bg-error text-error-content");const n=document.createElement("div");n.classList.add("opacity-100","duration-150","transition-opacity","rounded"),e&&e.split(" ").forEach(r=>{n.classList.add(r)}),n.innerHTML='<div class="toast-message p-2 flex gap-2 items-center"><span class="grow"> '+t+'</span><span class="flex-none"><i class="fa-regular fa-circle-xmark cursor-pointer " data-toggle="dismiss"></i></span></div>',document.querySelector(".toast-container").appendChild(n),setTimeout(function(){n.classList.remove("opacity-100"),n.classList.add("opacity-0"),setTimeout(function(){n.remove()},150)},3e3),Nt()};Nt();const yo=()=>{document.querySelectorAll(".banner-notification-dismiss").forEach(t=>{t.addEventListener("click",wo,!1)}),document.querySelectorAll('[data-dismiss="tutorial"]').forEach(t=>{t.addEventListener("click",bo,!1)})};function wo(t){t.preventDefault();let e=this.dataset.dismiss;axios.post(this.dataset.url).then(()=>{if(!e)return;let n=document.querySelector(e);n&&n.classList.add("hidden")})}function bo(t){t.preventDefault();let e=this.dataset.target,n=t.currentTarget;n.classList.add("loading"),n.disabled=!0,n.querySelector("i")?.remove(),axios.post(this.dataset.url).then(()=>{if(!e)return;let o=document.querySelector(e);o&&o.classList.add("hidden")})}yo();let Qt;const ko=()=>{const t=document.getElementById("element-era-id");t&&(Qt=t.value,t.addEventListener("change",function(){xo(t.value)}))},xo=t=>{t=parseInt(t);let e=document.querySelector('input[name="era-data-url"]').dataset.url.replace("/0/","/"+t+"/"),n=document.querySelector('input[name="oldPosition"]').dataset.url;axios.get(e).then(o=>{let r=document.querySelector('select[name="position"]');r.innerHTML="";let a=1;Object.entries(o.data.positions).forEach(function(c,d){const f=document.createElement("option");f.text=c[1],n&&!d&&Qt==t&&(f.value=1,r.appendChild(f)),d&&(f.value=a,r.appendChild(f)),a++})})};ko();window.initSortable=function(){let t=document.querySelectorAll(".sortable-elements");t.length!==0&&t.forEach(e=>{let n={},o=e.dataset.handle;o&&(n.handle=o),pt.create(e,n)})};window.initSortable();window.formErrorHandler=function(t,e){document.querySelectorAll(".input-error").forEach(m=>{m.classList.remove("input-error")});const o=document.querySelector(".text-error");o&&o.remove();const r=e.querySelector(".btn-primary");if(r&&(r.disabled=!1,r.classList.remove("loading")),t.status===503){window.showToast(t.data.message,"error");return}if(t.status===403){document.querySelector("#entity-form-403-error").classList.remove("hidden");return}if(!t.data.errors){window.showToast("Backend error","error");return}const a=t.data.errors;let u=[];const c=Object.keys(a);let d=!0;c.forEach(function(m){let p=document.querySelector('[name="'+m+'"]');if(p){p.classList.add("input-error");const v=document.createElement("div");v.classList.add("text-error"),v.innerHTML=a[m][0],p.parentNode.append(v)}else d=!1,u.push(a[m][0]);window.showToast(a[m][0],"error")});const f=document.querySelector("#entity-form-generic-error .error-logs");!d&&f&&(f.innerHTML="",u.forEach(function(m){f.append(m)}),document.querySelector("#entity-form-generic-error").classList.remove("hidden")),Lo(e,a)};const Lo=(t,e)=>{const n=Object.keys(e)[0],o=t.querySelector('[name="'+n+'"]');if(!o)return;if(!t.querySelector(".tab-content")){dt(o);return}document.querySelector(".tab-content .active").classList.remove("active"),document.querySelector(".nav-tabs li.active").classList.remove("active");const r=document.querySelector('[name="'+n+'"').closest(".tab-pane");r&&(r.classList.add("active"),document.querySelector('a[href="#'+r.id+'"]').closest("li").classList.add("active")),dt(o)},dt=t=>{t.focus(),t.scrollIntoView({behavior:"smooth"})},we="recent_colors",ut=10;function _o(){return document.cookie.split(";").reduce((t,e)=>{const[n,o]=e.split("=").map(r=>r.trim());return n&&o&&(t[n]=decodeURIComponent(o)),t},{})}function So(t,e,n=30){const o=new Date;o.setTime(o.getTime()+n*24*60*60*1e3),document.cookie=`${t}=${encodeURIComponent(e)}; expires=${o.toUTCString()}; path=/`}function qo(t){ie({swatches:t})}function zt(){const t=_o();let e=t[we]?JSON.parse(t[we]):[];ie.init(),ie({el:".spectrum",format:"hex",alpha:!1,theme:"pill",clearButton:!0,closeButton:!0,swatches:e}),document.querySelectorAll(".spectrum").forEach(n=>{n.dataset.init!=="1"&&(n.dataset.init=1,n.addEventListener("click",function(o){ie({parent:n.dataset.appendTo??".container"})}),n.addEventListener("change",function(o){const r=event.target.value;e=[r,...e.filter(a=>a!==r)],e.length>ut&&(e=e.slice(0,ut)),So(we,JSON.stringify(e)),qo(e)}),n.addEventListener("close",o=>{o.stopPropagation()}))})}window.onEvent(function(){zt()});zt();window.onEvent(function(){Ot()});const Ot=()=>{document.querySelectorAll('[data-toggle="private"]').forEach(e=>{Eo(e)})},Eo=t=>{t.dataset.togglerinit!=="1"&&(t.dataset.togglerinit="1",t.addEventListener("click",function(e){const n=t.previousElementSibling;t.classList.contains("fa-lock-keyhole")?(t.classList.remove("fa-lock-keyhole","fa-solid"),t.classList.add("fa-unlock-keyhole","fa-regular"),t.setAttribute("title",t.dataset.public),n.value=0):(t.classList.remove("fa-unlock-keyhole","fa-regular"),t.classList.add("fa-lock-keyhole","fa-solid"),t.setAttribute("title",t.dataset.private),n.value=1)}))},To=()=>{const t=document.querySelector('input[data-toggle="entity-privacy"]');t&&t.addEventListener("change",function(){let e=document.getElementById("entity-is-private");e&&(this.checked?e.classList.remove("hidden"):e.classList.add("hidden"))})};Ot();To();const Co={class:""},Mo=["data-title"],Ao={class:"sr-only"},Do=I({__name:"NavToggler",props:{text:{},title:{}},setup(t){const e=t,n=()=>{const a=document.querySelector("body");a.classList.contains("sidebar-collapse")?(a.classList.remove("sidebar-collapse"),o(!1)):(a.classList.add("sidebar-collapse"),o(!0))},o=a=>{let u=new Date;u.setTime(u.getTime()+90*24*60*60*1e3);let d=" expires="+u.toGMTString(),f=location.protocol==="https:"?"secure; ":"";document.cookie="toggleState="+(a?"collapsed":"open")+"; path=/; "+f+"samesite=lax; "+d},r=()=>{let u=new RegExp("toggleState=([^;]+)").exec(document.cookie);(u!=null?decodeURI(u[1]):null)==="collapsed"&&document.querySelector("body").classList.add("sidebar-collapse")};return Ce(()=>{r()}),(a,u)=>(i(),l("div",Co,[s("span",{role:"button",class:"sidebar-toggle text-center cursor-pointer fill-current hover:text-primary-focus","data-toggle":"tooltip","data-title":e.title,"data-placement":"right","data-html":"true",tabindex:"",onClick:u[0]||(u[0]=c=>n())},[u[1]||(u[1]=s("svg",{class:"h-6 w-6 transition-all duration-150 hover:rotate-45","data-sidebar":"collapse",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 50 50"},[s("path",{d:"M 7.71875 6.28125 L 6.28125 7.71875 L 23.5625 25 L 6.28125 42.28125 L 7.71875 43.71875 L 25 26.4375 L 42.28125 43.71875 L 43.71875 42.28125 L 26.4375 25 L 43.71875 7.71875 L 42.28125 6.28125 L 25 23.5625 Z"})],-1)),u[2]||(u[2]=s("svg",{class:"h-6 w-6 transition-all duration-150 hover:rotate-90","data-sidebar":"expand",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 50 50"},[s("path",{d:"M 0 9 L 0 11 L 50 11 L 50 9 Z M 0 24 L 0 26 L 50 26 L 50 24 Z M 0 39 L 0 41 L 50 41 L 50 39 Z"})],-1)),s("span",Ao,h(e.text),1)],8,Mo)]))}}),$o=["data-id","href"],jo={class:"flex-none"},Ho=["title"],Io=["title","innerHTML"],Po=["innerHTML"],Ut=I({__name:"LookupEntity",props:{entity:{}},emits:["preview"],setup(t,{emit:e}){const n=e,o=t,r=c=>"url('"+c.image+"')",a=c=>{c.stopPropagation(),c.preventDefault(),n("preview",o.entity)},u=()=>"flex justify-center gap-1 cursor-pointer hover:bg-base-200 rounded w-full focus:bg-base-200";return(c,d)=>(i(),l("a",{class:_(u()),"data-id":c.entity.id,href:c.entity.link},[s("div",jo,[s("div",{style:F({backgroundImage:r(c.entity)}),title:c.entity.name,class:"rounded cover-background block h-16 w-16"},null,12,Ho)]),s("div",{class:"grow truncate pl-1 text-base-content",onClick:a},[s("div",{class:"font-extrabold entity-name truncate",title:c.entity.name,innerHTML:c.entity.name},null,8,Io),s("div",{class:"entity-type text-xs",innerHTML:c.entity.type},null,8,Po)])],10,$o))}}),Bo=["href"],Ro={class:"grow truncate"},Fo=["title","innerHTML"],No=I({__name:"LookupPage",props:{page:{}},setup(t){const e=()=>"flex justify-center gap-2 cursor-pointer w-full";return(n,o)=>(i(),l("a",{class:_(e()),href:n.page.url,tabindex:"0"},[o[0]||(o[0]=s("div",{class:"flex-none h-4 w-4"},[s("i",{class:"fa-solid fa-angles-right","aria-hidden":"true"})],-1)),s("div",Ro,[s("div",{class:"entity-name truncate",title:n.page.name,innerHTML:n.page.name},null,8,Fo)])],10,Bo))}}),Qo={class:"entity-header p-3 bg-entity-focus"},zo={class:"w-full flex items-center"},Oo=["href","title","innerHTML"],Uo={key:0,class:"fa-regular fa-skull mx-2","aria-hidden":"true"},Ko=["href"],Vo=["innerHTML"],Go={key:1,class:"my-1 w-full flex flex-wrap gap-1"},Wo=["href","data-tag-id","data-tag-slug","innerHTML"],Zo=["href","data-tag"],Yo=["href","title"],Jo={class:"entity-sections"},Xo={class:"tabs flex my-2 justify-center items-center border-solid border-slate-600 border-b-2 border-r-0 border-t-0 border-l-0"},er={key:0,class:"tab-profile p-5 flex flex-col gap-5"},tr={key:0,class:"entity-pinned-attributes flex flex-col gap-3"},nr=["data-attribute","data-target"],or=["innerHTML"],rr=["innerHTML"],sr={key:1},ar={class:"flex flex-col gap-3"},ir=["innerHTML"],lr=["innerHTML"],cr={key:1,class:"tab-links p-3"},dr={key:0,class:"text-center italic"},ur=I({__name:"EntityPreview",props:{entity:{}},setup(t){const e=t,n=b(!0),o=b(!1),r=b(!1),a=()=>e.entity.title,u=p=>{let v="inline-block rounded-xl px-3 py-1 bg-base-100 text-base-content text-xs";return p.colour&&(v+=" bg-"+p.colour,p.colour==="black"&&(v+=" text-white")),v},c=()=>"url('"+e.entity.image+"')",d=p=>{let v="p-1 px-1 mx-1 pt-2 select-none text-center truncate border-b-2 border-solid border-r-0 border-t-0 border-l-0";return p==="profile"&&n.value||p==="links"&&o.value||p==="access"&&r.value?v+=" font-black border-slate-600":v+=" cursor-pointer border-base-100",v},f=p=>{n.value=!1,o.value=!1,r.value=!1,p==="profile"?n.value=!0:p==="links"?o.value=!0:p==="access"&&(r.value=!0)},m=p=>"entity-profile-"+p.slug;return(p,v)=>(i(),l(q,null,[s("div",Qo,[s("div",zo,[s("a",{class:"text-2xl font-extrabold entity-name",href:p.entity.link,title:p.entity.name,innerHTML:p.entity.name},null,8,Oo),p.entity.is_dead?(i(),l("i",Uo)):w("",!0),s("a",{class:"ml-2 text-xs",target:"_blank",href:p.entity.link},v[3]||(v[3]=[s("i",{class:"fa-regular fa-external-link","aria-hidden":"true","aria-label":"Open in a new window"},null,-1)]),8,Ko)]),a()?(i(),l("div",{key:0,class:"block w-full",innerHTML:p.entity.title},null,8,Vo)):w("",!0),p.entity.tags.length>0?(i(),l("div",Go,[(i(!0),l(q,null,C(p.entity.tags,x=>(i(),l("a",{class:_(u(x)),href:x.link,"data-tag-id":x.id,"data-tag-slug":x.slug,innerHTML:x.name},null,10,Wo))),256))])):w("",!0),p.entity.location?(i(),l("a",{key:2,class:"block w-full cursor-pointer my-2",href:p.entity.location.link,"data-tag":p.entity.id},[v[4]||(v[4]=s("i",{class:"fa-duotone circle-location-arrow","aria-hidden":"true","aria-label":"Location"},null,-1)),A(" "+h(p.entity.location.name),1)],8,Zo)):w("",!0),p.entity.image?(i(),l("a",{key:3,href:p.entity.link,style:F({backgroundImage:c()}),title:p.entity.name,class:"rounded cover-background block w-full aspect-square"},null,12,Yo)):w("",!0)]),s("div",Jo,[s("div",Xo,[s("div",{class:_(d("profile")),onClick:v[0]||(v[0]=x=>f("profile"))},h(p.entity.texts.profile),3),s("div",{class:_(d("links")),onClick:v[1]||(v[1]=x=>f("links"))},h(p.entity.texts.connections),3),s("div",{class:_(d("access")),onClick:v[2]||(v[2]=x=>f("access"))},null,2)]),n.value?(i(),l("div",er,[p.entity.attributes.length>0?(i(),l("div",tr,[(i(!0),l(q,null,C(p.entity.attributes,x=>(i(),l("div",{class:"","data-attribute":x.name,"data-target":x.id},[s("span",{class:"inline-block uppercase font-extrabold mr-1",innerHTML:x.name},null,8,or),s("span",{innerHTML:x.value},null,8,rr)],8,nr))),256))])):w("",!0),p.entity.attributes.length>0?(i(),l("hr",sr)):w("",!0),s("div",ar,[(i(!0),l(q,null,C(p.entity.profile,x=>(i(),l("div",{class:_(["",m(x)])},[s("div",{class:"uppercase font-extrabold truncate",innerHTML:x.field},null,8,ir),s("div",{innerHTML:x.value},null,8,lr)],2))),256))])])):w("",!0),o.value?(i(),l("div",cr,[(i(!0),l(q,null,C(p.entity.connections,x=>(i(),B(Ut,{entity:x},null,8,["entity"]))),256)),p.entity.connections.length===0?(i(),l("p",dr,h(p.entity.texts["no-connections"]),1)):w("",!0)])):w("",!0)])],64))}}),mr={directives:{clickOutside:vt.directive},props:{api_lookup:String,api_recent:String,placeholder:String,keyboard_tooltip:String},components:{LookupEntity:Ut,EntityPreview:ur,LookupPage:No},data(){return{has_drawer:!1,term:null,show_loading:!1,show_recent:!1,show_preview:!1,show_results:!1,show_bookmarks:!1,recent:[],bookmarks:[],indexes:[],results:[],pages:[],cached:{},cachedPages:{},has_recent:!1,texts:{},timeout_id:null,preview_entity:null}},watch:{term(t,e){this.termChanged()}},methods:{termChanged(){this.term.trim().length<3||(this.timeout_id!==void 0&&clearTimeout(this.timeout_id),this.show_loading=!0,this.timeout_id=setTimeout(()=>this.lookup(),500))},lookup(){let t=this.term.trim(),e=t.toLowerCase().replace(/ /g,"-").replace(/ [^\w-]+/g,"");if(this.cached[e])return this.displayCached(e);fetch(this.api_lookup+"?"+new URLSearchParams({q:t,v2:!0})).then(n=>n.json()).then(n=>this.parseLookupResponse(n,e))},focus(){this.api_recent&&(this.show_preview=!1,this.has_drawer=!0,this.fetch())},escape(){this.timeout_id!==void 0&&clearTimeout(this.timeout_id),this.close()},fetch(){if(this.has_recent){this.show_recent=!0;return}this.show_loading=!0,fetch(this.api_recent).then(t=>t.json()).then(t=>{this.recent=t.recent,this.bookmarks=t.bookmarks,this.indexes=t.indexes,this.texts.recents=t.texts.recents,this.texts.results=t.texts.results,this.texts.hint=t.texts.hint,this.texts.bookmarks=t.texts.bookmarks,this.texts.index=t.texts.index,this.texts.keyboard=t.texts.keyboard,this.texts.empty_results=t.texts.empty_results,this.texts.fulltext=t.texts.fulltext,this.texts.fulltext_route=t.fulltext_route,this.show_loading=!1,this.show_recent=!0,this.has_recent=!0,this.show_bookmarks=this.bookmarks.length>0}).catch(t=>{this.show_loading=!1,this.show_recent=!0,this.has_recent=!1})},parseLookupResponse(t,e){this.results=t.entities,this.pages=t.pages,this.cached[e]=t.entities,this.cachedPages[e]=t.pages,this.showResults()},displayCached(t){this.results=this.cached[t],this.pages=this.cachedPages[t],this.showResults()},showResults(){this.timeout_id=null,this.show_preview=!1,this.show_loading=!1,this.show_results=!0},loadPreview(t){this.show_loading=!0,fetch(t.preview).then(e=>e.json()).then(e=>this.parsePreviewResponse(e))},parsePreviewResponse(t){this.preview_entity=t,this.show_loading=!1,this.show_preview=!0,this.show_recent=!1},onClickOutside(t){this.close()},close(){this.show_recent=!1,this.show_loading=!1,this.show_preview=!1,this.$refs.searchField.blur()},showBookmarks(){this.show_bookmarks=!0},searchFullTextUrl(){return`${this.texts.fulltext_route}?term=${this.term}`},showIndexes(){this.show_bookmarks=!1},modeClass(t){return t&&this.show_bookmarks||!t&&!this.show_bookmarks?" underline":""}}},fr={class:"flex grow mr-2"},pr={class:"relative grow field flex items-center"},hr=["placeholder"],gr={class:"absolute right-1 hidden md:inline"},vr=["data-title"],yr={key:0,class:"search-drawer absolute top-0 left-0 mt-12 h-sidebar w-sidebar bg-navbar bg-base-100 shadow-r overflow-y-auto",tabindex:"-1"},wr={key:0,class:"text-center"},br={key:1,class:"search-recent bg-lookup p-2 min-h-full shadow-r flex flex-col items-stretch"},kr={key:0,class:"flex-none"},xr={class:"italic text-xs text-center"},Lr={class:"grow flex flex-col gap-5 p-2"},_r={key:0,class:"search-results flex flex-col gap-2"},Sr={class:"text-sm uppercase"},qr={key:0,class:"text-neutral-content text-sm"},Er={key:1,class:"flex flex-col gap-2"},Tr=["href"],Cr={key:1,class:"recent-searches flex flex-col gap-2"},Mr={class:"text-sm uppercase"},Ar={key:2,class:"flex gap-5 justify-center"},Dr={key:3,class:"flex flex-col gap-4"},$r=["href","title"],jr=["innerHTML"],Hr={key:4,class:"flex flex-col gap-4"},Ir=["href","title"],Pr=["innerHTML"],Br={key:1,class:"flex-none text-xs text-center"},Rr=["innerHTML"],Fr={key:2,class:"search-preview bg-lookup min-h-full shadow-r"};function Nr(t,e,n,o,r,a){const u=ge("LookupEntity"),c=ge("LookupPage"),d=ge("EntityPreview"),f=ht("click-outside");return te((i(),l("div",fr,[s("div",pr,[te(s("input",{type:"text",class:"leading-4 w-20 md:w-full",maxlength:"25",ref:"searchField",id:"entity-lookup","onUpdate:modelValue":e[0]||(e[0]=m=>r.term=m),onClick:e[1]||(e[1]=m=>a.focus()),onFocus:e[2]||(e[2]=m=>a.focus()),onKeydown:e[3]||(e[3]=he(m=>a.escape(),["esc"])),placeholder:n.placeholder},null,40,hr),[[Le,r.term]]),s("span",gr,[s("span",{class:"flex-none keyboard-shortcut py-1",id:"lookup-kb-shortcut","data-toggle":"tooltip","data-title":n.keyboard_tooltip,"data-html":"true","data-placement":"bottom"}," K ",8,vr)])]),r.show_recent||r.show_loading||r.show_preview?(i(),l("aside",yr,[r.show_loading?(i(),l("div",wr,e[10]||(e[10]=[s("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true","aria-label":"Loading"},null,-1)]))):w("",!0),r.show_recent?(i(),l("div",br,[r.show_results?w("",!0):(i(),l("div",kr,[s("p",xr,h(r.texts.hint),1)])),s("div",Lr,[r.show_results?(i(),l("div",_r,[s("div",Sr,h(r.texts.results),1),r.results.length===0&&r.pages.length===0?(i(),l("div",qr,h(r.texts.empty_results),1)):(i(),l("div",Er,[(i(!0),l(q,null,C(r.results,m=>(i(),B(u,{entity:m,onKeydown:e[4]||(e[4]=he(p=>a.escape(),["esc"])),onPreview:a.loadPreview},null,8,["entity","onPreview"]))),256)),(i(!0),l(q,null,C(r.pages,m=>(i(),B(c,{page:m},null,8,["page"]))),256))])),s("a",{class:"grow text-sm uppercase hover:underline",href:a.searchFullTextUrl()},h(r.texts.fulltext),9,Tr)])):w("",!0),r.recent.length>0?(i(),l("div",Cr,[s("div",Mr,h(r.texts.recents),1),(i(!0),l(q,null,C(r.recent,m=>(i(),B(u,{entity:m,onPreview:a.loadPreview,onKeydown:e[5]||(e[5]=he(p=>a.escape(),["esc"]))},null,8,["entity","onPreview"]))),256))])):w("",!0),r.bookmarks.length>0?(i(),l("div",Ar,[r.bookmarks.length>0?(i(),l("button",{key:0,class:_(["grow text-sm uppercase hover:underline",this.modeClass(!0)]),onClick:e[6]||(e[6]=m=>a.showBookmarks())},h(r.texts.bookmarks),3)):w("",!0),s("button",{class:_(["grow text-sm uppercase hover:underline",this.modeClass(!1)]),onClick:e[7]||(e[7]=m=>a.showIndexes())},h(r.texts.index),3)])):w("",!0),r.show_bookmarks?(i(),l("div",Dr,[(i(!0),l(q,null,C(r.bookmarks,m=>(i(),l("a",{href:m.url,onClick:e[8]||(e[8]=Fe(()=>{},["stop"])),title:m.text,class:"flex gap-2 items-center"},[s("i",{class:_(["w-4",m.icon]),"aria-hidden":"true"},null,2),s("span",{innerHTML:m.text},null,8,jr)],8,$r))),256))])):(i(),l("div",Hr,[(i(!0),l(q,null,C(r.indexes,m=>(i(),l("a",{href:m.url,onClick:e[9]||(e[9]=Fe(()=>{},["stop"])),title:m.name,class:"flex gap-2 items-center"},[s("i",{class:_(["w-4 text-center",m.icon]),"aria-hidden":"true"},null,2),s("span",{innerHTML:m.name},null,8,Pr)],8,Ir))),256))]))]),r.show_loading?w("",!0):(i(),l("div",Br,[e[11]||(e[11]=s("hr",null,null,-1)),s("p",{class:"italic text-xs text-center",innerHTML:r.texts.keyboard},null,8,Rr)]))])):w("",!0),r.show_preview?(i(),l("div",Fr,[ee(d,{entity:r.preview_entity},null,8,["entity"])])):w("",!0)])):w("",!0)])),[[f,a.onClickOutside]])}const Qr=rn(mr,[["render",Nr]]),zr=["href","title"],Or={key:0,class:"absolute top-2 right-2 text-sm text-boost"},Ur=["innerHTML"],mt=I({__name:"Campaign",props:{campaign:{}},setup(t){const e=t,n=()=>e.campaign.image?"url("+e.campaign.image+")":"",o=()=>"campaign flex items-end border border-solid rounded-lg cover-background relative h-24 overflow-hidden text-break shadow-xs hover:shadow-md border-0";return(r,a)=>(i(),l("a",{class:_(o()),href:r.campaign.url,style:F({backgroundImage:n()}),title:r.campaign.name},[r.campaign.is_boosted?(i(),l("div",Or,a[0]||(a[0]=[s("i",{class:"fa-regular fa-gem","aria-label":"Premium campaign"},null,-1)]))):w("",!0),s("div",{class:"flex items-end justify-center name w-full text-xs p-2 pt-6 text-center",innerHTML:r.campaign.name},null,8,Ur)],14,zr))}}),Kr=["data-id"],Vr={class:"flex-none p-2"},Gr=["innerHTML","href"],Wr=["title"],Zr={key:1,class:"flex-none p-2"},Yr=["data-id"],Jr={class:"flex-none p-2"},Xr=["innerHTML"],es=["title"],ts={key:1,class:"flex-none p-2"},ns=I({__name:"Notification",props:{notification:{}},emits:["read"],setup(t,{emit:e}){const n=e,o=b(!1),r=b(!1),a=d=>{let f="notification bg-base-200 flex justify-center items-center p-2 rounded-md";return d.is_read?f:f+" unread"},u=d=>{let f="fa-regular fa-"+d.icon;return d.colour==="red"&&(f+=" text-red"),f},c=d=>{r.value=!0,axios.post(d.dismiss).then(()=>{o.value=!0,n("read",d)})};return(d,f)=>d.notification.url&&!o.value?(i(),l("div",{key:0,class:_(a(d.notification)),"data-id":d.notification.id},[s("div",Vr,[s("i",{class:_(u(d.notification)),"aria-hidden":"true"},null,2)]),s("a",{class:"grow p-2 break-all",innerHTML:d.notification.text,href:d.notification.url},null,8,Gr),r.value?(i(),l("div",Zr,f[3]||(f[3]=[s("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true"},null,-1)]))):(i(),l("div",{key:0,class:"flex-none p-2 cursor-pointer dismissable",onClick:f[0]||(f[0]=m=>c(d.notification)),title:d.notification.dismiss_text},f[2]||(f[2]=[s("i",{class:"fa-solid fa-times","aria-hidden":"true"},null,-1)]),8,Wr))],10,Kr)):o.value?w("",!0):(i(),l("div",{key:1,class:_(a(d.notification)),"data-id":d.notification.id},[s("div",Jr,[s("i",{class:_(u(d.notification)),"aria-hidden":"true"},null,2)]),s("div",{class:"grow p-2",innerHTML:d.notification.text},null,8,Xr),r.value?(i(),l("div",ts,f[5]||(f[5]=[s("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true"},null,-1)]))):(i(),l("div",{key:0,class:"flex-none p-2 cursor-pointer dismissable",onClick:f[1]||(f[1]=m=>c(d.notification)),title:d.notification.dismiss_text},f[4]||(f[4]=[s("i",{class:"fa-regular fa-times","aria-hidden":"true"},null,-1)]),8,es))],10,Yr))}}),os=["data-id"],rs={class:"grow p-2"},ss=["innerHTML","href"],as=["innerHTML"],is=["title"],ls={key:1,class:"flex-none p-2"},cs=I({__name:"Release",props:{release:{}},emits:["read"],setup(t,{emit:e}){const n=e,o=b(!1),r=b(!1),a=c=>"release bg-base-200 flex justify-center items-center p-2  rounded-md",u=c=>{r.value=!0,axios.post(c.dismiss).then(()=>{o.value=!0,n("read",c)})};return(c,d)=>o.value?w("",!0):(i(),l("div",{key:0,class:_(a(c.release)),"data-id":c.release.id},[s("div",rs,[s("a",{innerHTML:c.release.title,class:"font-bold cursor-pointer block w-full",href:c.release.url,target:"_blank"},null,8,ss),s("p",{innerHTML:c.release.text},null,8,as)]),r.value?(i(),l("div",ls,d[2]||(d[2]=[s("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true"},null,-1)]))):(i(),l("div",{key:0,class:"flex-none p-2 cursor-pointer dismissable",onClick:d[0]||(d[0]=f=>u(c.release)),title:c.release.dismiss_text},d[1]||(d[1]=[s("i",{class:"fa-solid fa-times","aria-hidden":"true"},null,-1)]),8,is))],10,os))}}),be={__name:"GridSvg",props:{size:Number},setup(t){const e=t;function n(){return"w-"+e.size+" h-"+e.size}return(o,r)=>(i(),l("svg",{class:_(n()),viewBox:"0 -0.5 21 21",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true"},r[0]||(r[0]=[s("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[s("g",{transform:"translate(-219.000000, -200.000000)",fill:"currentcolor"},[s("g",{id:"icons",transform:"translate(56.000000, 160.000000)"},[s("path",{d:"M181.9,54 L179.8,54 C178.63975,54 177.7,54.895 177.7,56 L177.7,58 C177.7,59.105 178.63975,60 179.8,60 L181.9,60 C183.06025,60 184,59.105 184,58 L184,56 C184,54.895 183.06025,54 181.9,54 M174.55,54 L172.45,54 C171.28975,54 170.35,54.895 170.35,56 L170.35,58 C170.35,59.105 171.28975,60 172.45,60 L174.55,60 C175.71025,60 176.65,59.105 176.65,58 L176.65,56 C176.65,54.895 175.71025,54 174.55,54 M167.2,54 L165.1,54 C163.93975,54 163,54.895 163,56 L163,58 C163,59.105 163.93975,60 165.1,60 L167.2,60 C168.36025,60 169.3,59.105 169.3,58 L169.3,56 C169.3,54.895 168.36025,54 167.2,54 M181.9,47 L179.8,47 C178.63975,47 177.7,47.895 177.7,49 L177.7,51 C177.7,52.105 178.63975,53 179.8,53 L181.9,53 C183.06025,53 184,52.105 184,51 L184,49 C184,47.895 183.06025,47 181.9,47 M174.55,47 L172.45,47 C171.28975,47 170.35,47.895 170.35,49 L170.35,51 C170.35,52.105 171.28975,53 172.45,53 L174.55,53 C175.71025,53 176.65,52.105 176.65,51 L176.65,49 C176.65,47.895 175.71025,47 174.55,47 M167.2,47 L165.1,47 C163.93975,47 163,47.895 163,49 L163,51 C163,52.105 163.93975,53 165.1,53 L167.2,53 C168.36025,53 169.3,52.105 169.3,51 L169.3,49 C169.3,47.895 168.36025,47 167.2,47 M181.9,40 L179.8,40 C178.63975,40 177.7,40.895 177.7,42 L177.7,44 C177.7,45.105 178.63975,46 179.8,46 L181.9,46 C183.06025,46 184,45.105 184,44 L184,42 C184,40.895 183.06025,40 181.9,40 M174.55,40 L172.45,40 C171.28975,40 170.35,40.895 170.35,42 L170.35,44 C170.35,45.105 171.28975,46 172.45,46 L174.55,46 C175.71025,46 176.65,45.105 176.65,44 L176.65,42 C176.65,40.895 175.71025,40 174.55,40 M169.3,42 L169.3,44 C169.3,45.105 168.36025,46 167.2,46 L165.1,46 C163.93975,46 163,45.105 163,44 L163,42 C163,40.895 163.93975,40 165.1,40 L167.2,40 C168.36025,40 169.3,40.895 169.3,42"})])])],-1)]),2))}},ds={class:"nav-switcher flex items-center justify-center align-middle h-12 gap-2"},us={class:"indicator relative inline-flex w-max"},ms={key:0,class:"notification-badge left-auto top-auto w-fit inline-flex absolute content-center items-center z-10"},fs={key:1,class:"profile-box rounded-lg p-2 text-center font-bold"},ps={key:0,class:"navigation-drawer bg-base-100 h-full overflow-y-auto fixed top-0 right-0 rounded-l-2xl shadow-lg"},hs={key:0,class:"temporary p-8 text-center"},gs={key:1,class:""},vs={class:"header flex"},ys={key:0,class:"full flex items-center gap-4"},ws={class:"flex-none"},bs={class:"grow"},ks={class:"font-bold"},xs=["title"],Ls={key:0,class:"full flex items-center gap-4"},_s={key:0,class:"flex-none profile-box rounded-lg p-2 text-center uppercase font-bold"},Ss={class:"grow"},qs={class:"font-bold"},Es=["title"],Ts={key:0,class:"flex-none profile-box rounded-lg p-2 text-center uppercase font-bold"},Cs={key:0,class:"profile p-5 flex flex-col gap-5"},Ms={key:0,class:"notifications"},As={class:"flex w-full py-2"},Ds={class:"grow uppercase font-bold"},$s={class:"grow text-right"},js=["href"],Hs={class:"flex flex-col gap-2"},Is={key:0,class:"no-notifications help-block text-neutral-content italic"},Ps={key:1,class:"releases"},Bs={class:"flex w-full py-2"},Rs={class:"grow uppercase font-bold"},Fs={class:"flex flex-col gap-2"},Ns={key:2,class:"marketplace"},Qs={class:"flex w-full py-2"},zs={class:"grow uppercase font-bold"},Os={class:"grow text-right"},Us=["href"],Ks={class:"grid grid-cols-3 gap-2"},Vs=["href"],Gs={class:"text-muted text-xs"},Ws=["href"],Zs={class:"text-muted text-xs"},Ys=["href"],Js={class:"text-muted text-xs"},Xs={key:3,class:"subscription"},ea={class:"uppercase font-bold py-2"},ta=["href"],na={class:"flex-none p-2"},oa=["src","alt"],ra={class:"grow p-2"},sa={class:"font-bold text-lg"},aa={key:0,class:"more"},ia={key:1,class:"more"},la={class:"link flex gap-1 items-center"},ca={key:0,class:"fa-duotone fa-credit-card","aria-hidden":"true"},da={key:1,class:"fa-regular fa-credit-card","aria-hidden":"true"},ua={key:4,class:"m-0 p-0 list-none flex flex-col gap-2"},ma=["href"],fa=["href"],pa=["href"],ha={key:5,class:"m-0 p-0 list-none flex flex-col gap-2"},ga=["href"],va={key:1,class:"campaigns p-5"},ya={key:0,class:"campaigns flex flex-col gap-5"},wa={class:"flex flex-col gap-2"},ba={class:"flex w-full"},ka={class:"grow uppercase font-bold"},xa={key:0,class:"grow text-right"},La=["href"],_a={class:"grid grid-cols-2 md:grid-cols-3 gap-5"},Sa=["href"],qa={class:"text-xs text-break uppercase"},Ea={key:0},Ta={class:"flex flex-col gap-2"},Ca={key:0,class:"uppercase"},Ma={key:1,class:"grid grid-cols-2 md:grid-cols-3 gap-5 following"},Aa=["href"],Da={class:"text-xs uppercase text-break"},$a=I({__name:"NavSwitcher",props:{user_id:{},api:{},fetch:{},initials:{},avatar:{},campaign_id:{},has_alerts:{}},setup(t){const e=t;b(60*1e3);const n=b(!1),o=b(!1),r=b(!1),a=b(!1),u=b(!1),c=b({}),d=b({}),f=b({}),m=b({}),p=b({}),v=b(!1),x=b(!1),z=b(!1),P=()=>{a.value=!0,u.value=!1,G()},O=()=>{u.value=!0,a.value=!1,G()},G=()=>{o.value=!0,!r.value&&(n.value=!0,axios.get(e.api).then(L=>{c.value=L.data.profile,d.value=L.data.campaigns,f.value=L.data.notifications,m.value=L.data.marketplace,p.value=L.data.releases,v.value=L.data.has_unread,r.value=!0,n.value=!1,x.value=!0,z.value=L.data.fontawesome_pro}))},M=L=>L?"block p-4 grow items-center focus:box-shadow":"block p-4  items-center bg-base-200 cursor-pointer flex-none focus:box-shadow",W=()=>{document.getElementById("logout-form").submit()},re=L=>{o.value=!1},ue=L=>{let g=p.value.releases.findIndex(H=>H.id===L.id);p.value.releases.slice(g,1),U()},me=L=>{let g=f.value.messages.findIndex(H=>H.id==L.id);f.value.messages.slice(g,1),U()},U=()=>{f.value.messages.length===0&&p.value.releases.length===0&&(v.value=!1)},Z=()=>{let L=localStorage.getItem("last_notification-"+e.user_id),H=new Date().getTime()-60*5e3;if(!L||L<H)fe();else if(v.value=localStorage.getItem("notification-has-alerts-"+e.user_id)==="true",se(),!x.value)return},fe=()=>{let L=new Date().getTime();localStorage.setItem("last_notification-"+e.user_id,L),axios.get(e.fetch).then(g=>{localStorage.setItem("notification-has-alerts-"+e.user_id,g.data.has_alerts),Z()})},se=()=>{setTimeout(function(){Z()},e.alert_delta)},K=()=>e.avatar.startsWith("/images/"),Y=()=>"url("+e.avatar+")";return Ce(()=>{v.value=e.has_alerts,se()}),(L,g)=>{const H=ht("click-outside");return i(),l(q,null,[s("div",ds,[s("div",{class:"campaigns inline cursor-pointer text-center text-2xl hover:text-primary-focus",onClick:g[0]||(g[0]=E=>P()),"aria-label":"Switch campaigns",tabindex:"0",role:"button"},[ee(be,{size:7}),g[5]||(g[5]=s("span",{class:"sr-only"},"Campaigns",-1))]),s("div",{class:"profile flex items-center cursor-pointer text-center uppercase",onClick:g[1]||(g[1]=E=>O()),"aria-label":"Profile settings",tabindex:"0",role:"button"},[s("div",us,[v.value?(i(),l("span",ms)):w("",!0),K()?(i(),l("div",fs,h(L.initials),1)):(i(),l("div",{key:2,class:"w-9 h-9 rounded-lg cover-background",style:F({backgroundImage:Y()})},null,4))])])]),o.value?te((i(),l("div",ps,[n.value?(i(),l("div",hs,g[6]||(g[6]=[s("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true"},null,-1)]))):(i(),l("div",gs,[s("div",vs,[s("div",{class:_(M(a.value)),onClick:g[2]||(g[2]=E=>P()),tabindex:"0",role:"button","aria-label":"Campaign list"},[a.value?(i(),l("div",ys,[s("div",ws,[ee(be,{size:6})]),s("div",bs,[s("div",ks,h(d.value.texts.campaigns),1),s("div",null,h(d.value.texts.count),1)])])):(i(),l("div",{key:1,class:"flex items-center justify-center h-full",title:d.value.texts.campaigns},[ee(be,{size:6})],8,xs))],2),s("div",{class:_(M(u.value)),onClick:g[3]||(g[3]=E=>O()),tabindex:"0",role:"button","aria-label":"Profile pane"},[u.value?(i(),l("div",Ls,[K()?(i(),l("div",_s,h(L.initials),1)):(i(),l("div",{key:1,class:"flex-none w-9 h-9 rounded-lg cover-background",style:F({backgroundImage:Y()})},null,4)),s("div",Ss,[s("div",qs,h(c.value.name),1),s("div",null,h(c.value.created),1)])])):(i(),l("div",{key:1,class:"",title:c.value.your_profile},[K()?(i(),l("div",Ts,h(L.initials),1)):(i(),l("div",{key:1,class:"flex-none w-9 h-9 rounded-lg cover-background",style:F({backgroundImage:Y()})},null,4))],8,Es))],2)]),u.value?(i(),l("div",Cs,[f.value.title?(i(),l("div",Ms,[s("div",As,[s("div",Ds,h(f.value.title),1),s("div",$s,[s("a",{href:f.value.all.url},h(f.value.all.text),9,js)])]),s("div",Hs,[(i(!0),l(q,null,C(f.value.messages,E=>(i(),B(ns,{notification:E,onRead:me},null,8,["notification"]))),256))]),f.value.messages.length===0?(i(),l("div",Is,h(f.value.none),1)):w("",!0)])):w("",!0),p.value.title&&p.value.releases.length>0?(i(),l("div",Ps,[s("div",Bs,[s("div",Rs,h(p.value.title),1)]),s("div",Fs,[(i(!0),l(q,null,C(p.value.releases,E=>(i(),B(cs,{release:E,onRead:ue},null,8,["release"]))),256))])])):w("",!0),!c.value.is_impersonating&&m.value.title?(i(),l("div",Ns,[s("div",Qs,[s("div",zs,h(m.value.title),1),s("div",Os,[s("a",{href:m.value.explore.url,target:"_blank"},h(m.value.explore.text),9,Us)])]),s("div",Ks,[s("a",{href:m.value.themes.url,class:"border py-2 items-center justify-center rounded-md hover:shadow-md flex flex-col gap-1",target:"_blank"},[g[7]||(g[7]=s("div",{class:"icon bg-base-200 rounded-full w-14 h-14 text-3xl aspect-square flex justify-center items-center"},[s("i",{class:"fa-duotone fa-palette","aria-hidden":"true"})],-1)),s("div",null,h(m.value.themes.title),1),s("div",Gs,h(m.value.themes.number),1)],8,Vs),s("a",{href:m.value.sheets.url,class:"border py-2 items-center justify-center rounded-md hover:shadow-md flex flex-col gap-1",target:"_blank"},[g[8]||(g[8]=s("div",{class:"icon bg-base-200 rounded-full w-14 h-14 text-3xl aspect-square flex justify-center items-center"},[s("i",{class:"fa-duotone fa-table-cells","aria-hidden":"true"})],-1)),s("div",null,h(m.value.sheets.title),1),s("div",Zs,h(m.value.sheets.number),1)],8,Ws),s("a",{href:m.value.content.url,class:"border py-2 items-center justify-center rounded-md hover:shadow-md flex flex-col gap-1",target:"_blank"},[g[9]||(g[9]=s("div",{class:"icon bg-base-200 rounded-full w-14 h-14 text-3xl aspect-square flex justify-center items-center"},[s("i",{class:"fa-duotone fa-dice-d20","aria-hidden":"true"})],-1)),s("div",null,h(m.value.content.title),1),s("div",Js,h(m.value.content.number),1)],8,Ys)])])):w("",!0),!c.value.is_impersonating&&c.value.subscription?(i(),l("div",Xs,[s("div",ea,h(c.value.subscription.title),1),s("a",{class:"border rounded-lg flex justify-center items-center hover:shadow-md",href:c.value.urls.subscription},[s("div",na,[s("img",{class:"w-16 h-16",src:c.value.subscription.image,alt:c.value.subscription.tier},null,8,oa)]),s("div",ra,[s("div",sa,h(c.value.subscription.tier),1),c.value.subscription.tier!=="Kobold"?(i(),l("div",aa,[A(h(c.value.subscription.created),1),g[10]||(g[10]=s("br",null,null,-1)),A(" "+h(c.value.subscription.boosters),1)])):(i(),l("div",ia,[A(h(c.value.subscription.call_to_action)+" ",1),s("div",la,[A(h(c.value.subscription.call_to_action_2)+" ",1),z.value?(i(),l("i",ca)):(i(),l("i",da)),g[11]||(g[11]=s("i",{class:"fa-brands fa-paypal","aria-hidden":"true"},null,-1))])]))])],8,ta)])):w("",!0),c.value.is_impersonating?(i(),l("ul",ha,[s("li",null,[s("a",{href:c.value.return.url,class:""},[g[16]||(g[16]=s("i",{class:"fa-regular fa-sign-out-alt mr-3","aria-hidden":"true"},null,-1)),A(" "+h(c.value.return.name),1)],8,ga)])])):(i(),l("ul",ua,[s("li",null,[s("a",{href:c.value.urls.settings.url,class:"p-2 block"},[g[12]||(g[12]=s("i",{class:"fa-regular fa-cog mr-3","aria-hidden":"true"},null,-1)),A(" "+h(c.value.urls.settings.name),1)],8,ma)]),s("li",null,[s("a",{href:c.value.urls.profile.url,class:"p-2 block"},[g[13]||(g[13]=s("i",{class:"fa-regular fa-user mr-3","aria-hidden":"true"},null,-1)),A(" "+h(c.value.urls.profile.name),1)],8,fa)]),s("li",null,[s("a",{href:c.value.urls.help.url,class:"p-2 block",target:"_blank"},[g[14]||(g[14]=s("i",{class:"fa-regular fa-question-circle mr-3","aria-hidden":"true"},null,-1)),A(" "+h(c.value.urls.help.name),1)],8,pa)]),s("li",null,[s("a",{href:"#",onClick:g[4]||(g[4]=E=>W()),class:"p-2 block"},[g[15]||(g[15]=s("i",{class:"fa-regular fa-sign-out mr-3","aria-hidden":"true"},null,-1)),A(" "+h(c.value.urls.logout.name),1)])])]))])):(i(),l("div",va,[c.value.is_impersonating?w("",!0):(i(),l("div",ya,[s("div",wa,[s("div",ba,[s("div",ka,h(d.value.texts.campaigns),1),d.value.member.length>0?(i(),l("div",xa,[s("a",{href:d.value.urls.reorder},h(d.value.texts.reorder),9,La)])):w("",!0)]),s("div",_a,[(i(!0),l(q,null,C(d.value.member,E=>(i(),B(mt,{campaign:E},null,8,["campaign"]))),256)),s("a",{href:d.value.urls.new,class:"new-campaign flex items-center text-center border-dashed border rounded-lg h-24 p-2 overflow-hidden"},[s("span",qa,[g[17]||(g[17]=s("i",{class:"fa-regular fa-plus","aria-hidden":"true",style:{display:"none"}},null,-1)),A(" "+h(d.value.texts.new),1)])],8,Sa)])]),c.value.is_impersonating?w("",!0):(i(),l("hr",Ea)),s("div",Ta,[c.value.is_impersonating?w("",!0):(i(),l("p",Ca,h(d.value.texts.followed),1)),c.value.is_impersonating?w("",!0):(i(),l("div",Ma,[(i(!0),l(q,null,C(d.value.following,E=>(i(),B(mt,{campaign:E},null,8,["campaign"]))),256)),s("a",{href:d.value.urls.follow,class:"new-campaign flex items-center text-center border-dashed border rounded-lg h-24 p-2 overflow-hidden"},[s("span",Da,h(d.value.texts.follow),1)],8,Aa)]))])]))]))]))])),[[H,re]]):w("",!0)],64)}}}),oe=gt({});oe.component("nav-toggler",Do);oe.component("nav-search",Qr);oe.component("nav-switcher",$a);oe.use(vt);oe.mount("header");const ja={key:0},Ha=["innerHTML"],Ia={key:1,class:"flex items-center gap-1"},Pa=["accept"],Ba={key:2,class:"flex items-center gap-1"},Ra=["placeholder"],Fa={key:0,class:"fa-solid fa-spin fa-spinner","aria-label":"Downloading"},Na={key:3,class:"flex items-center gap-1"},Qa=["innerHTML"],za={key:0,class:"flex gap-2 flex-col w-full"},Oa={class:"progress h-1 w-full"},Ua=["innerHTML"],Ka=["innerHTML"],Va=["name"],Ga={key:2,type:"hidden",name:"remove-image",value:"1"},Wa={class:"flex gap-6 items-center p-4 md:p-6 justify-between"},Za=["innerHTML"],Ya={class:"max-w-4xl flex flex-col gap-2 text-left p-4 md:px-6"},Ja={class:"flex flex-col gap-1 w-full"},Xa=["innerHTML"],ei=["innerHTML"],ti={key:0,class:"p-4 md:px-6"},ni={class:""},oi=["href"],ri=["innerHTML"],si=I({__name:"Selection",props:{file:{},url:{},accepts:{},uuid:{},thumbnail:{},browse:{},field:{},old:{},i18n:{},cta:{},premium:{}},setup(t){const e=t,n=b(!0),o=b(!1),r=b(!1),a=b(),u=b(),c=b(),d=b(),f=b(),m=b(!1),p=b(0),v=b(null);let x;const z=b(null),P=b(!1),O=b(!1),G=b(!1),M=b(null),W=b(),re=b();Ce(()=>{n.value=!1,d.value=e.thumbnail,f.value=e.uuid,e.old==="true"&&(P.value=!0),e.premium==="true"&&(O.value=!0),M.value=JSON.parse(e.i18n)});const ue=()=>{let y="relative flex items-end align-middle rounded overflow-hidden bg-no-repeat ";return Z()?y+=" cover-background preview-bg w-48 h-36 p-2 ":y+="w-full",y},me=()=>r.value?"hidden":"flex gap-2 flex-col w-full",U=()=>P.value||f.value!==null&&f.value!=="",Z=()=>v.value||P.value?!0:f.value!==null&&f.value!=="",fe=()=>{f.value=null,d.value=null,P.value&&(P.value=!1,G.value=!0)},se=()=>v.value?"url('"+v.value+"')":d.value?"url('"+d.value+"')":"",K=()=>p.value+"%",Y=()=>{m.value=!0},L=y=>{a.value=y.clipboardData.getData("text"),g()},g=()=>{!a.value||a.value==x||(x=a.value,o.value=!0,u.value.disabled=!0,axios.post(e.url,{url:a.value}).then(y=>{u.value.disabled=!1,o.value=!1,a.value=null,d.value=y.data.thumbnail,f.value=y.data.uuid}).catch(y=>{u.value.disabled=!1,o.value=!1,u.value.focus(),E(y)}))},H=async y=>{const k=y.target.files[0];if(!k){r.value=!1;return}const S=new FileReader;S.onload=j=>{v.value=j.target.result},S.readAsDataURL(k),r.value=!0,document.addEventListener("keydown",pe),z.value=axios.CancelToken.source(),c.value.disabled=!0;const Re=new FormData;Re.append("file",k),axios.post(e.file,Re,{headers:{"Content-Type":"multipart/form-data"},cancelToken:z.value.token,onUploadProgress:function(j){p.value=Math.round(j.loaded*100/j.total)}}).then(j=>{r.value=!1,c.value.disabled=!1,c.value=null,d.value=j.data.thumbnail,f.value=j.data.uuid,v.value=null,document.removeEventListener("keydown",pe)}).catch(j=>{r.value=!1,c.value.disabled=!1,v.value=null,axios.isCancel(j)?c.value=null:E(j),document.removeEventListener("keydown",pe)})},E=y=>{if(!y.response)return;if(y.response.data.error){window.showToast(y.response.data.error,"error");return}if(y.response&&y.response.status===403&&y.response.data.message){window.showToast(M.value.unauthorized,"error");return}Object.keys(y.response.data.errors).forEach(S=>{if(y.response.data.errors[S][0].includes("(storage_full)")){re.value=y.response.data.errors[S][0].replace("(storage_full)",""),on(W.value);return}window.showToast(y.response.data.errors[S][0],"error")})},tn=y=>{f.value=y.uuid,d.value=y.thumbnail},nn=()=>{m.value=!1},pe=y=>{y.key==="Escape"&&r.value&&Ie()},Ie=y=>{z.value.cancel("Upload canceled by user.")},on=y=>{y.showModal(),y.addEventListener("click",Be)},Pe=y=>{y.removeEventListener("click",Be),y.close()},Be=y=>{let k=y.target.getBoundingClientRect();!(k.top<=y.clientY&&y.clientY<=k.top+k.height&&k.left<=y.clientX&&y.clientX<=k.left+k.width)&&y.target.tagName==="DIALOG"&&Pe(y.target)};return(y,k)=>(i(),l(q,null,[n.value?(i(),l("div",ja,k[7]||(k[7]=[s("i",{class:"fa-solid fa-spin fa-spinner2","aria-label":"Loading"},null,-1)]))):(i(),l("div",{key:1,class:_(ue()),style:F({backgroundImage:se()})},[s("div",{class:_(me())},[Z()?(i(),l("div",{key:0,class:"rounded p-2 cursor-pointer backdrop-blur backdrop-opacity-30 bg-red-700/50 text-white hover:backdrop-opacity-100 transition",onClick:k[0]||(k[0]=S=>fe()),innerHTML:M.value.remove},null,8,Ha)):w("",!0),U()?w("",!0):(i(),l("div",Ia,[s("input",{type:"file",accept:e.accepts,class:"w-full",onChange:H,ref_key:"fileField",ref:c},null,40,Pa)])),U()?w("",!0):(i(),l("div",Ba,[te(s("input",{ref_key:"urlField",ref:u,type:"text",class:"w-full","onUpdate:modelValue":k[1]||(k[1]=S=>a.value=S),onBlur:k[2]||(k[2]=S=>g()),onPaste:L,placeholder:M.value.url},null,40,Ra),[[Le,a.value]]),o.value?(i(),l("i",Fa)):w("",!0)])),U()?w("",!0):(i(),l("div",Na,[s("span",{role:"button",class:"btn2 btn-default btn-sm",onClick:k[3]||(k[3]=S=>Y()),innerHTML:M.value.gallery},null,8,Qa)]))],2),r.value?(i(),l("div",za,[s("div",Oa,[s("div",{class:"h-1 bg-accent shadow-xs",role:"progressbar","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100",style:F({width:K()})},k[8]||(k[8]=[s("span",{class:"sr-only"},null,-1)]),4)]),s("div",{class:"rounded p-2 cursor-pointer backdrop-blur backdrop-opacity-30 bg-red-700/50 text-white hover:backdrop-opacity-100 transition flex items-center gap-2",onClick:k[4]||(k[4]=S=>Ie())},[s("span",{class:"grow",innerHTML:M.value.cancel},null,8,Ua),s("span",{class:"text-xs flex-none",innerHTML:K()},null,8,Ka)])])):w("",!0)],6)),te(s("input",{type:"hidden",name:e.field,"onUpdate:modelValue":k[5]||(k[5]=S=>f.value=S)},null,8,Va),[[Le,f.value]]),G.value?(i(),l("input",Ga)):w("",!0),ee(sn,{api:e.browse,opened:m.value,i18n:y.i18n,onSelected:tn,onClosed:nn},null,8,["api","opened","i18n"]),n.value?w("",!0):(i(),l("dialog",{key:3,ref_key:"cta",ref:W,class:"dialog rounded-2xl text-center"},[s("header",Wa,[s("h4",{innerHTML:M.value.cta_title,class:"text-lg font-normal"},null,8,Za),s("button",{type:"button",class:"text-base-content",onClick:k[6]||(k[6]=S=>Pe(W.value)),title:"Close"},k[9]||(k[9]=[s("i",{class:"fa-regular fa-circle-xmark","aria-hidden":"true"},null,-1),s("span",{class:"sr-only"},"Close",-1)]))]),s("article",Ya,[s("div",Ja,[s("p",{innerHTML:re.value},null,8,Xa),O.value?w("",!0):(i(),l("p",{key:0,innerHTML:M.value.cta_helper},null,8,ei))])]),O.value?w("",!0):(i(),l("footer",ti,[s("menu",ni,[s("a",{href:e.cta,class:"btn2 btn-primary"},[k[10]||(k[10]=s("i",{class:"fa-regular fa-gem","aria-hidden":"true"},null,-1)),s("span",{innerHTML:M.value.cta_action},null,8,ri)],8,oi)])]))],512))],64))}}),Kt=()=>{document.querySelectorAll(".gallery-selection").forEach(e=>{if(e.dataset.init==="1")return;e.dataset.init="1";const n=gt({});n.component("gallery-selection",si),n.mount(e)})};Kt();window.onEvent(function(){Kt()});const ke=Array(),Vt=()=>{document.querySelectorAll('[data-toggle="tooltip-ajax"]').forEach(e=>{e._tippy||de(e,{theme:"entity-tooltip",placement:e.dataset.direction??"bottom",allowHTML:!0,interactive:!0,delay:500,appendTo:e.dataset.append??document.body,content:'<i class="fa-solid fa-spin fa-spinner" aria-hidden="true" aria-label="loading..." />',arrow:!0,onShow(n){let o=e.dataset.id;if(o&&o in ke){n.setContent(ke[o]);return}fetch(e.dataset.url).then(r=>r.json()).then(r=>{n.setContent(r[0]),ke[o]=r[0]}).catch(r=>{n.setContent(`Failed loading tooltip. ${r}`)})}})})},Gt=()=>{let t=document.querySelectorAll('[data-toggle="tooltip"]');t.forEach(e=>{ft(e)}),t=document.querySelectorAll("[data-tooltip]"),t.forEach(e=>{ft(e)})},ft=t=>{t._tippy||de(t,{content:t.dataset.title??t.title,theme:"kanka",delay:250,placement:t.dataset.direction??"bottom",allowHTML:t.dataset.html??!1,appendTo:t.dataset.append??document.body,arrow:!0})},Wt=()=>{document.querySelectorAll("[data-dropdown]").forEach(e=>{if(e._tippy)return;let n=e.parentNode.querySelectorAll(".dropdown-menu")[0];de(e,{content:'<div class="dd-menu flex flex-col max-w-2xl">'+n.innerHTML+"</div>",theme:"kanka-dropdown",placement:e.dataset.direction??"bottom",zIndex:890,allowHTML:!0,arrow:!0,interactive:!0,trigger:"click",onShown(o){window.triggerEvent()}})})},ai=(t,e)=>{de(t,e).show()};Gt();Vt();Wt();window.initTooltips=Gt;window.ajaxTooltip=Vt;window.showTooltip=ai;window.initDropdowns=Wt;const Zt=()=>{document.querySelectorAll('form[data-maintenance="1"]').forEach(function(e){e.addEventListener("submit",ii)})},ii=t=>{window.entityFormHasUnsavedChanges=!1,t.preventDefault();const e=t.target;li(e);let n=new FormData(e);axios.post(e.getAttribute("action"),n).then(()=>{e.submit()}).catch(o=>{o.response&&window.formErrorHandler(o.response,e),ci(e)})},li=t=>{t.querySelectorAll(".btn-primary").forEach((n,o)=>{o===0&&n.classList.add("loading"),n.classList.add("btn-disabled")})},ci=t=>{t.querySelectorAll(".btn-primary").forEach(n=>{n.classList.remove("btn-disabled","loading")})};Zt();window.onEvent(function(){Zt()});window.onEvent(function(){window.initForeignSelect(),window.initTags(),window.initDialogs(),window.initTooltips(),window.ajaxTooltip(),window.initDropdowns(),window.initSortable(),He(),Jt(),Yt(),Xt(),en(),hi()});function di(){let t=document.getElementById("ad-client");t&&fetch(t.src,{}).catch(()=>{let e=document.getElementById("adblock-plea");e&&e.classList.remove("hidden")})}const ui=()=>{document.querySelectorAll(".nav-tabs li a")?.forEach(function(e){e.addEventListener("click",function(n){n.preventDefault();const o=e.closest(".nav-tabs-custom");o.querySelectorAll(".nav-tabs li").forEach(function(a){a.classList.remove("active")}),e.parentNode.classList.add("active"),o.querySelectorAll(".tab-pane").forEach(function(a){a.classList.remove("active")}),document.querySelector(e.getAttribute("href")).classList.add("active")})})},Yt=()=>{document.querySelectorAll('[data-img="delete"]')?.forEach(function(t){t.addEventListener("click",function(e){e.preventDefault(),document.querySelector("input[name="+t.dataset.target+"]").value=1,t.closest(".preview").classList.add("hidden")})})},He=()=>{document.querySelectorAll(".pagination-ajax-links a").forEach(function(t){t.dataset.loaded!=="1"&&(t.dataset.loaded="1",t.addEventListener("click",function(e){e.preventDefault();const n=document.querySelector(".pagination-ajax-body");n.querySelector(".modal-loading").classList.remove("hidden"),n.querySelector(".pagination-ajax-content").classList.add("hidden"),fetch(t.getAttribute("href")).then(o=>o.text()).then(o=>{n.parentNode.innerHTML=o,He(),window.triggerEvent()})}))})},Jt=()=>{document.querySelectorAll('[data-toggle="confirm-delete"]')?.forEach(function(t){t.dataset.loaded!=="1"&&(t.dataset.loaded="1",t.addEventListener("click",function(e){if(e.preventDefault(),t.dataset.confirming==="1"){t.classList.add("loading"),t.innerHTML="";const n=document.querySelector(t.dataset.target);n?n.requestSubmit():console.error("Unknown target",n);return}t.dataset.confirming="1",t.querySelector("span").classList.add("md:inline"),t.querySelector("span").innerHTML=t.dataset.confirm}))}),document.querySelectorAll('a[data-toggle="delete-form"]')?.forEach(function(t){t.dataset.loaded!=="1"&&(t.dataset.loaded="1",t.addEventListener("click",function(e){e.preventDefault(),document.querySelector(t.dataset.target).requestSubmit()}))})},mi=()=>{document.querySelector(".submenu-switcher")?.addEventListener("change",function(t){t.preventDefault();const e=t.target,n=e.options[e.selectedIndex];window.location.href=n.dataset.route})},fi=()=>{const e={window:window.innerHeight,header:document.querySelector("header")?xe(document.querySelector("header")):0,footer:document.querySelector(".main-footer")?xe(document.querySelector(".main-footer")):0,sidebar:document.querySelector(".main-sidebar .sidebar")?xe(document.querySelector(".main-sidebar .sidebar")):0,controlSidebar:0},n=pi(e),o=document.querySelector(".content-wrapper");n===e.controlSidebar?o.style.minHeight=n:n===e.window?o.style.minHeight=n-e.header-e.footer:o.style.minHeight=n-e.header},xe=(t,e=!1)=>{let n=t.getBoundingClientRect().height;if(e){const o=getComputedStyle(t);n+=parseInt(o.marginTop)+parseInt(o.marginBottom)}return n},pi=t=>{let e=0;return Object.keys(t).forEach(n=>{t[n]>e&&(e=t[n])}),e},Xt=()=>{document.querySelectorAll(".btn-feedback").forEach(e=>{e.dataset.feedback||(e.dataset.feedback=1,e.addEventListener("click",o=>{o.target.classList.add("loading")},!1))});const t=document.getElementById("quick-privacy-select");t&&t.addEventListener("change",function(){const e=this.dataset.url;axios.post(e).then(n=>{window.showToast(n.data.toast);let o=document.querySelector("body");n.data.status?o.classList.add("kanka-entity-private"):o.classList.remove("kanka-entity-private")})})},en=()=>{document.querySelectorAll("[data-dismisses]").forEach(e=>{e.addEventListener("click",function(n){n.preventDefault();let o=document.querySelector(this.dataset.dismisses);o.classList.remove("opacity-100"),o.classList.add("opacity-0"),setTimeout(function(){o.remove()},150)})})},hi=()=>{const t=document.querySelector(".btn-manage-perm");t&&t.addEventListener("click",function(e){e.preventDefault(),window.closeDialog("primary-dialog");let n=t.dataset.target;document.querySelector(n).click()})};fi();window.initForeignSelect();window.initDialogs();mi();ui();He();Jt();Yt();Xt();en();di();

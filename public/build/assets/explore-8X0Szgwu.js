import{m as ne,i as G,a as l,H as ye,c as s,f as d,I as E,b as t,J as ee,G as J,F as P,g as U,t as be,d as ce,r as v,o as ke,x as xe,j as we,w as N,e as L,K as _e,p as A,n as te,z as Le,q as Ce}from"./vue.esm-bundler-BOz2yYwR.js";import{_ as Pe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{v as Te}from"./v-click-outside.umd-CFxmCgl1.js";import"./_commonjsHelpers-Cpj98o6Y.js";const Me={emits:["pagination-change-page"],props:{data:{type:Object,default:()=>{}},limit:{type:Number,default:0},keepLength:{type:Boolean,default:!1}},computed:{isApiResource(){return!!this.data.meta},currentPage(){var a;return this.isApiResource?this.data.meta.current_page:(a=this.data.current_page)!=null?a:null},firstPageUrl(){var a,u,r,o,f;return(f=(o=(u=this.data.first_page_url)!=null?u:(a=this.data.meta)==null?void 0:a.first_page_url)!=null?o:(r=this.data.links)==null?void 0:r.first)!=null?f:null},from(){var a;return this.isApiResource?this.data.meta.from:(a=this.data.from)!=null?a:null},lastPage(){var a;return this.isApiResource?this.data.meta.last_page:(a=this.data.last_page)!=null?a:null},lastPageUrl(){var a,u,r,o,f;return(f=(o=(u=this.data.last_page_url)!=null?u:(a=this.data.meta)==null?void 0:a.last_page_url)!=null?o:(r=this.data.links)==null?void 0:r.last)!=null?f:null},nextPageUrl(){var a,u,r,o,f;return(f=(o=(u=this.data.next_page_url)!=null?u:(a=this.data.meta)==null?void 0:a.next_page_url)!=null?o:(r=this.data.links)==null?void 0:r.next)!=null?f:null},perPage(){var a;return this.isApiResource?this.data.meta.per_page:(a=this.data.per_page)!=null?a:null},prevPageUrl(){var a,u,r,o,f;return(f=(o=(u=this.data.prev_page_url)!=null?u:(a=this.data.meta)==null?void 0:a.prev_page_url)!=null?o:(r=this.data.links)==null?void 0:r.prev)!=null?f:null},to(){var a;return this.isApiResource?this.data.meta.to:(a=this.data.to)!=null?a:null},total(){var a;return this.isApiResource?this.data.meta.total:(a=this.data.total)!=null?a:null},pageRange(){if(this.limit===-1)return 0;if(this.limit===0)return this.lastPage;for(var a=this.currentPage,u=this.keepLength,r=this.lastPage,o=this.limit,f=a-o,h=a+o,_=(o+2)*2,g=(o+2)*2-1,w=[],m=[],y,x=1;x<=r;x++)(x===1||x===r||x>=f&&x<=h||u&&x<_&&a<_-2||u&&x>r-g&&a>r-g+2)&&w.push(x);return w.forEach(function(C){y&&(C-y===2?m.push(y+1):C-y!==1&&m.push("...")),m.push(C),y=C}),m}},methods:{previousPage(){this.selectPage(this.currentPage-1)},nextPage(){this.selectPage(this.currentPage+1)},selectPage(a){a==="..."||a===this.currentPage||this.$emit("pagination-change-page",a)}},render(){return this.$slots.default({data:this.data,limit:this.limit,computed:{isApiResource:this.isApiResource,currentPage:this.currentPage,firstPageUrl:this.firstPageUrl,from:this.from,lastPage:this.lastPage,lastPageUrl:this.lastPageUrl,nextPageUrl:this.nextPageUrl,perPage:this.perPage,prevPageUrl:this.prevPageUrl,to:this.to,total:this.total,pageRange:this.pageRange},prevButtonEvents:{click:a=>{a.preventDefault(),this.previousPage()}},nextButtonEvents:{click:a=>{a.preventDefault(),this.nextPage()}},pageButtonEvents:a=>({click:u=>{u.preventDefault(),this.selectPage(a)}})})}},$e=(a,u)=>{const r=a.__vccOpts||a;for(const[o,f]of u)r[o]=f;return r},He={compatConfig:{MODE:3},inheritAttrs:!1,emits:["pagination-change-page"],components:{RenderlessPagination:Me},props:{data:{type:Object,default:()=>{}},limit:{type:Number,default:0},keepLength:{type:Boolean,default:!1},itemClasses:{type:Array,default:()=>["bg-white","text-gray-500","border-gray-300","hover:bg-gray-50"]},activeClasses:{type:Array,default:()=>["bg-blue-50","border-blue-500","text-blue-600"]}},methods:{onPaginationChangePage(a){this.$emit("pagination-change-page",a)}}},je=["disabled"],Ee=t("span",{class:"sr-only"},"Previous",-1),Ue=t("svg",{class:"w-5 h-5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.75 19.5L8.25 12l7.5-7.5"})],-1),Be=["aria-current","disabled"],Re=["disabled"],Ae=t("span",{class:"sr-only"},"Next",-1),De=t("svg",{class:"w-5 h-5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})],-1);function ze(a,u,r,o,f,h){const _=ne("RenderlessPagination");return l(),G(_,{data:r.data,limit:r.limit,"keep-length":r.keepLength,onPaginationChangePage:h.onPaginationChangePage},{default:ye(g=>[g.computed.total>g.computed.perPage?(l(),s("nav",E({key:0},a.$attrs,{class:"inline-flex -space-x-px rounded-md shadow-sm isolate ltr:flex-row rtl:flex-row-reverse","aria-label":"Pagination"}),[t("button",E({class:["relative inline-flex items-center px-2 py-2 text-sm font-medium border rounded-l-md focus:z-20 disabled:opacity-50",r.itemClasses],disabled:!g.computed.prevPageUrl},ee(g.prevButtonEvents,!0)),[J(a.$slots,"prev-nav",{},()=>[Ee,Ue])],16,je),(l(!0),s(P,null,U(g.computed.pageRange,(w,m)=>(l(),s("button",E({class:["relative inline-flex items-center px-4 py-2 text-sm font-medium border focus:z-20",[w==g.computed.currentPage?r.activeClasses:r.itemClasses,w==g.computed.currentPage?"z-30":""]],"aria-current":g.computed.currentPage?"page":null,key:m},ee(g.pageButtonEvents(w),!0),{disabled:w===g.computed.currentPage}),be(w),17,Be))),128)),t("button",E({class:["relative inline-flex items-center px-2 py-2 text-sm font-medium border rounded-r-md focus:z-20 disabled:opacity-50",r.itemClasses],disabled:!g.computed.nextPageUrl},ee(g.nextButtonEvents,!0)),[J(a.$slots,"next-nav",{},()=>[Ae,De])],16,Re)],16)):d("",!0)]),_:3},8,["data","limit","keep-length","onPaginationChangePage"])}const Se=$e(He,[["render",ze]]),Oe={key:0,class:"flex flex-col gap-4 w-full"},qe={class:"flex gap-2 justify-between items-center"},Fe=["innerHTML"],Ie={key:1,class:"flex flex-col gap-4 w-full"},Ne={class:"flex gap-2 justify-between items-center flex-wrap"},Ge={class:"flex gap-1 items-center flex-wrap"},Je=["innerHTML"],Ke={key:0,class:"bg-base-200 flex items-stretch gap-1 rounded-xl"},Ve=["aria-label","title"],Qe=["title"],We=["aria-label"],Xe=["href"],Ye={key:1},Ze=["aria-label","title"],et=["innerHTML"],tt=["innerHTML"],nt=["innerHTML"],lt={key:0,class:"flex gap-2 items-center"},st={key:0,class:"btn2"},at={key:1,class:"dropdown"},it=["title"],rt={key:0,class:"dropdown-menu absolute mt-2 flex flex-col gap-1 bg-base-200 shadow p-2 rounded z-10",role:"menu",id:"templates-submenu"},ot=["innerHTML"],ut=["innerHTML"],dt=["innerHTML"],pt={key:2},ct={key:0,class:"btn2"},vt=["title"],ft=["title"],gt={key:3},ht=["title"],mt=["title"],yt={key:4,class:"join"},bt=["href"],kt=["innerHTML"],xt={key:0,class:"dropdown relative"},wt=["innerHTML"],_t={key:0,class:"dropdown-menu absolute mt-2 flex flex-col gap-1 right-0 bg-base-200 shadow p-2 rounded z-10",role:"menu",id:"templates-submenu"},Lt=["href"],Ct=["innerHTML"],Pt={href:"https://docs.kanka.io/en/latest/guides/templates.html",class:"flex flex-no-wrap gap-2 px-2 py-1 items-center"},Tt=["innerHTML"],Mt={key:1,class:"flex gap-2 items-center"},$t={class:"join"},Ht=["innerHTML"],jt=["innerHTML"],Et={key:2,class:"dropdown relative"},Ut=["innerHTML"],Bt={key:0,class:"dropdown-menu absolute mt-2 flex flex-col gap-1 right-0 bg-base-200 shadow p-2 rounded z-10",role:"menu",id:"templates-submenu"},Rt=["innerHTML"],At=["innerHTML"],Dt=["innerHTML"],zt=["innerHTML"],St=["innerHTML"],Ot=["innerHTML"],qt={class:"flex gap-1 items-start"},Ft=["href"],It={class:"block text-center p-4 h-12 bg-box"},Nt=["innerHTML"],Gt=["href"],Jt={class:""},Kt=["innerHTML"],Vt={key:0,class:"flex items-center justify-end gap-1 h-12"},Qt={key:1,class:"flex items-center"},Wt=["innerHTML"],Xt=["action"],Yt=["value"],Zt=["value"],en=ce({__name:"Explorer",props:{api:{},module:{},mode:{}},setup(a){const u=a,r=v([]),o=v(),f=v(),h=v(),_=v(),g=v(),w=v(),m=v(),y=v({}),x=v(0),C=v(0),D=v(),q=v(!0),T=v(!1),n=v(!1),k=v(!1),M=v(!1),b=v(!0),$=v(!1),le=v([]),H=v(!1),p=v({}),se=v(!1),j=v("grid");ke(()=>{j.value=u.mode,fetch(u.api).then(i=>i.json()).then(i=>{ue(i),x.value=i.filters.unfilteredCount,C.value=i.filters.count,D.value=i.filters.urls,p.value=i.i18n,b.value=i.nested,o.value=i.parent,le.value=i.templates,h.value=i.permissions,se.value=i.bookmarkable,y.value=i.urls,g.value=i.entityType,de()})});const ae=()=>{H.value=!H.value,r.value.forEach(i=>{i.selected=!1})},ve=()=>{if(!r.value.length)return;const i=!r.value[0].selected;r.value.forEach(e=>{e.selected=i})},ie=()=>{window.openDialog("datagrid-filters",D.value.form)},B=i=>{let e=Y();e.length!==0&&(i+="?entities[]="+e.join("&entities[]="),window.openDialog("primary-dialog",i))},re=()=>{M.value=!0;let i=u.api;b.value=!b.value,F(i+"?n="+(b.value?1:0));const e=new URL(window.location.href);e.searchParams.set("n",b.value?1:0),window.history.pushState({},"",e)},oe=()=>{let i=u.api;S()?j.value="table":j.value="grid",F(i+"?m="+j.value);const e=new URL(window.location.href);e.searchParams.set("m",j.value),window.history.pushState({},"",e)},fe=async(i=1)=>{k.value=!0,F(`${u.api}?page=${i}`)},F=i=>{fetch(i).then(e=>e.json()).then(e=>{ue(e),de()})},ue=i=>{r.value=[],w.value=i.entities,i.entities.data.forEach(e=>{r.value.push(e)}),f.value=i.csrf,m.value=i.order},de=()=>{q.value=!1,k.value=!1,M.value=!1,T.value=!1},K=i=>{console.log("order",i),T.value=!0;let e=u.api;e+="?order="+i,W(i)&&(e+="&desc=1"),F(e);const R=new URL(window.location.href);R.searchParams.set("order",i),W(i)?R.searchParams.set("desc","1"):R.searchParams.delete("desc"),window.history.pushState({},"",R)},V=i=>{let e="flex items-center gap-2 px-2";return I(i)?e+" font-extrabold":e},Q=i=>W(i)?"fa-regular fa-arrow-down-z-a":"fa-fa-regular fa-arrow-down-a-z",I=i=>m.value[i],W=i=>m.value[i]==="ASC";xe(()=>{window.ajaxTooltip()});const X=()=>{$.value=!1,n.value=!1},pe=()=>{Y().length!==0&&_.value.submit()},ge=()=>{window.openDialog("primary-dialog",y.value.bookmark)},he=()=>{B(y.value.delete)},Y=()=>{let i=[];return r.value.filter(e=>e.selected).forEach(e=>{i.push(e.id)}),i},z=()=>h.value,me=()=>S()?"entities-grid flex flex-wrap gap-3 lg:gap-5":"entities-grid flex flex-col gap-1 w-full",S=()=>j.value==="grid";return(i,e)=>{const R=ne("entities-entity"),Z=we("click-outside");return q.value?(l(),s("div",Oe,[t("div",qe,[t("h1",{class:"grow text-3xl category-title truncate",innerHTML:u.module},null,8,Fe),e[21]||(e[21]=t("div",{class:"flex gap-2 items-center"},[t("button",{class:"btn2 btn-disabled",disabled:"disabled"},[t("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"})])],-1))]),e[22]||(e[22]=t("div",{class:"flex gap-2 items-start"},[t("div",{class:"rounded shadow-xs w-[47%] xs:w-[25%] sm:w-48 aspect-square flex items-center justify-center text-xl text-neutral-content"},[t("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"})])],-1))])):(l(),s("div",Ie,[t("div",Ne,[t("div",Ge,[t("h1",{class:"grow text-3xl category-title truncate",innerHTML:u.module},null,8,Je),C.value>0?(l(),s("div",Ke,[t("div",{class:"flex items-center rounded-xl gap-2 hover:bg-base-300 px-2 py-2 cursor-pointer","aria-label":p.value.filters,title:p.value.filters,onClick:ie},e[23]||(e[23]=[t("i",{class:"fa-regular fa-filter hover:bg-base-300","aria-label":"Filter"},null,-1),t("span",{class:"rounded bg-primary text-primary-content px-2 text-sm"},"1",-1)]),8,Ve),se.value?(l(),s("div",{key:0,class:"flex items-center justify-center rounded-xl gap-2 hover:bg-base-300 px-3 py-2 cursor-pointer hover:text-primary",title:p.value.bookmark,onClick:ge},[t("i",{class:"fa-regular fa-bookmark","aria-label":p.value.bookmark},null,8,We)],8,Qe)):d("",!0),e[25]||(e[25]=t("div",{class:"w-0 h-auto my-2 border-base-content border-l"},null,-1)),t("a",{class:"flex items-center rounded-xl gap-2 hover:bg-base-300 px-2 py-2 text-base-content hover:text-primary",href:D.value.clear},e[24]||(e[24]=[t("i",{class:"fa-regular fa-eraser","aria-label":"Clear"},null,-1)]),8,Xe)])):(l(),s("div",Ye,[t("i",{class:"fa-regular fa-filter text-lg rounded hover:text-primary-content cursor-pointer px-2 py-1 hover:bg-primary","aria-label":p.value.filters,title:p.value.filters,onClick:ie},null,8,Ze)])),z()&&!H.value?(l(),s("button",{key:2,onClick:e[0]||(e[0]=c=>ae()),class:"rounded rounded-full border-primary text-primary border px-3 py-1 text-xs uppercase hover:bg-primary hover:text-primary-content",innerHTML:p.value.select},null,8,et)):d("",!0),z()&&H.value?(l(),s("button",{key:3,onClick:e[1]||(e[1]=c=>ae()),class:"rounded rounded-full bg-primary text-primary-content px-3 py-1 text-xs uppercase",innerHTML:p.value.done},null,8,tt)):d("",!0),z()&&H.value?(l(),s("button",{key:4,onClick:e[2]||(e[2]=c=>ve()),class:"rounded rounded-full border-primary text-primary border px-3 py-1 text-xs uppercase hover:bg-primary hover:text-primary-content",innerHTML:p.value.selectAll},null,8,nt)):d("",!0)]),H.value?(l(),s("div",Mt,[t("div",$t,[h.value.admin?(l(),s("button",{key:0,class:"btn2 btn-primary join-item btn-bulk-batch",onClick:e[12]||(e[12]=c=>B(y.value.batch))},[e[38]||(e[38]=t("i",{class:"fa-regular fa-pencil","aria-hidden":"true"},null,-1)),t("span",{class:"hidden md:inline",innerHTML:p.value.bulkEdit},null,8,Ht)])):(l(),s("button",{key:1,class:"btn2 join-item btn-primary",onClick:e[13]||(e[13]=c=>pe())},[e[39]||(e[39]=t("i",{class:"fa-regular fa-print","aria-hidden":"true"},null,-1)),t("span",{class:"hidden md:inline",innerHTML:p.value.bulkPrint},null,8,jt)])),z()?(l(),s("div",Et,[t("button",{type:"button",class:"btn2 btn-primary join-item","aria-expanded":"false","aria-label":"Create from template","aria-haspopup":"menu","aria-controls":"templates-submenu",onClick:e[14]||(e[14]=c=>$.value=!$.value)},[e[40]||(e[40]=t("i",{class:"fa-regular fa-caret-down","aria-hidden":"true"},null,-1)),t("span",{class:"sr-only",innerHTML:p.value.actions},null,8,Ut)]),$.value?N((l(),s("div",Bt,[h.value.admin?(l(),s("button",{key:0,onClick:e[15]||(e[15]=c=>B(y.value.permissions)),class:"flex items-center gap-2 px-2 py-1 cursor-pointer text-nowrap hover:text-primary"},[e[41]||(e[41]=t("i",{class:"fa-regular fa-lock","aria-hidden":"true"},null,-1)),t("span",{innerHTML:p.value.bulkPermissions},null,8,Rt)])):d("",!0),h.value.admin?(l(),s("button",{key:1,onClick:e[16]||(e[16]=c=>B(y.value.transform)),class:"flex items-center gap-2 px-2 py-1 cursor-pointer text-nowrap hover:text-primary"},[e[42]||(e[42]=t("i",{class:"fa-regular fa-exchange-alt","aria-hidden":"true"},null,-1)),t("span",{innerHTML:p.value.bulkTransform},null,8,At)])):d("",!0),t("button",{onClick:e[17]||(e[17]=c=>B(y.value.copy)),class:"flex items-center gap-2 px-2 py-1 cursor-pointer text-nowrap hover:text-primary"},[e[43]||(e[43]=t("i",{class:"fa-regular fa-clone","aria-hidden":"true"},null,-1)),t("span",{innerHTML:p.value.bulkCopy},null,8,Dt)]),h.value.admin?(l(),s("button",{key:2,onClick:e[18]||(e[18]=c=>B(y.value.template)),class:"flex items-center gap-2 px-2 py-1 cursor-pointer text-nowrap hover:text-primary"},[e[44]||(e[44]=t("i",{class:"fa-regular fa-table","aria-hidden":"true"},null,-1)),t("span",{innerHTML:p.value.bulkTemplate},null,8,zt)])):d("",!0),h.value.admin?(l(),s("button",{key:3,onClick:e[19]||(e[19]=c=>pe()),class:"flex items-center gap-2 px-2 py-1 cursor-pointer text-nowrap hover:text-primary"},[e[45]||(e[45]=t("i",{class:"fa-regular fa-print","aria-hidden":"true"},null,-1)),t("span",{innerHTML:p.value.bulkPrint},null,8,St)])):d("",!0),h.value.delete?(l(),s("button",{key:4,onClick:e[20]||(e[20]=c=>he()),class:"flex items-center gap-2 px-2 py-1 cursor-pointer text-error hover:bg-error hover:text-error-content rounded"},[e[46]||(e[46]=t("i",{class:"fa-regular fa-trash-can","aria-hidden":"true"},null,-1)),t("span",{innerHTML:p.value.bulkDelete},null,8,Ot)])):d("",!0)])),[[Z,X]]):d("",!0)])):d("",!0)])])):(l(),s("div",lt,[T.value?(l(),s("button",st,e[26]||(e[26]=[t("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"},null,-1)]))):(l(),s("div",at,[t("button",{onClick:e[3]||(e[3]=c=>n.value=!n.value),class:"btn2",title:p.value.order},e[27]||(e[27]=[t("i",{class:"fa-regular fa-arrow-down-a-z","aria-hidden":"true"},null,-1)]),8,it),n.value?N((l(),s("div",rt,[t("button",{onClick:e[4]||(e[4]=c=>K("name")),class:L(V("name"))},[I("name")?(l(),s("i",{key:0,class:L(Q("name"))},null,2)):d("",!0),t("span",{innerHTML:p.value.fields.name},null,8,ot)],2),t("button",{onClick:e[5]||(e[5]=c=>K("type")),class:L(V("type"))},[I("type")?(l(),s("i",{key:0,class:L(Q("type"))},null,2)):d("",!0),t("span",{innerHTML:p.value.fields.type},null,8,ut)],2),t("button",{onClick:e[6]||(e[6]=c=>K("is_private")),class:L(V("is_private"))},[I("is_private")?(l(),s("i",{key:0,class:L(Q("is_private"))},null,2)):d("",!0),t("span",{innerHTML:p.value.fields.is_private},null,8,dt)],2)])),[[Z,X]]):d("",!0)])),g.value.is_nested?(l(),s("div",pt,[M.value?(l(),s("button",ct,e[28]||(e[28]=[t("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"},null,-1)]))):d("",!0),b.value&&!M.value?(l(),s("button",{key:1,onClick:e[7]||(e[7]=c=>re()),class:"btn2",title:p.value.flatten},e[29]||(e[29]=[t("i",{class:"fa-regular fa-layer-group","aria-hidden":"true"},null,-1)]),8,vt)):M.value?d("",!0):(l(),s("button",{key:2,onClick:e[8]||(e[8]=c=>re()),class:"btn2",title:p.value.nest},e[30]||(e[30]=[t("i",{class:"fa-regular fa-boxes-stacked","aria-hidden":"true"},null,-1)]),8,ft))])):d("",!0),g.value.has_table?(l(),s("div",gt,[S()?(l(),s("button",{key:0,onClick:e[9]||(e[9]=c=>oe()),class:"btn2",title:p.value.layout_table},e[31]||(e[31]=[t("i",{class:"fa-regular fa-list-ul","aria-hidden":"true"},null,-1)]),8,ht)):(l(),s("button",{key:1,onClick:e[10]||(e[10]=c=>oe()),class:"btn2",title:p.value.layout_table},e[32]||(e[32]=[t("i",{class:"fa-regular fa-grid","aria-hidden":"true"},null,-1)]),8,mt))])):d("",!0),z()&&h.value.create?(l(),s("div",yt,[t("a",{href:y.value.create,class:"btn2 btn-primary join-item btn-new-entity"},[e[33]||(e[33]=t("i",{class:"fa-regular fa-plus","aria-hidden":"true"},null,-1)),t("span",{class:"hidden md:inline",innerHTML:g.value.singular},null,8,kt)],8,bt),h.value.template?(l(),s("div",xt,[t("button",{type:"button",class:"btn2 btn-primary join-item","aria-expanded":"false","aria-label":"Create from template","aria-haspopup":"menu","aria-controls":"templates-submenu",onClick:e[11]||(e[11]=c=>$.value=!$.value)},[e[34]||(e[34]=t("i",{class:"fa-regular fa-caret-down","aria-hidden":"true"},null,-1)),t("span",{class:"sr-only",innerHTML:p.value.actions},null,8,wt)]),$.value?N((l(),s("div",_t,[(l(!0),s(P,null,U(le.value,c=>(l(),s("a",{href:c.url,key:c.id,class:"new-entity-from-template text-base-content flex items-center gap-2 px-2 py-1"},[e[35]||(e[35]=t("i",{class:"fa-regular fa-star","aria-hidden":"true"},null,-1)),t("span",{innerHTML:c.name},null,8,Ct)],8,Lt))),128)),e[37]||(e[37]=t("hr",{class:"m-0"},null,-1)),t("a",Pt,[e[36]||(e[36]=t("i",{class:"fa-regular fa-external-link","aria-hidden":"true"},null,-1)),t("span",{class:"text-nowrap",innerHTML:p.value.templates},null,8,Tt)])])),[[Z,X]]):d("",!0)])):d("",!0)])):d("",!0)]))]),t("div",qt,[t("div",{class:L(me())},[o.value&&S()?(l(),s("a",{key:0,href:o.value.urls.parent,class:"entity w-[47%] xs:w-[25%] sm:w-48 overflow-hidden rounded flex flex-col shadow-xs hover:shadow sm"},[e[47]||(e[47]=t("div",{class:"w-46 flex items-center justify-center grow text-6xl"},[t("i",{class:"fa-regular fa-arrow-left","aria-hidden":"true"})],-1)),t("div",It,[t("span",{innerHTML:o.value.links.back},null,8,Nt)])],8,Ft)):o.value&&!S()?(l(),s("a",{key:1,href:o.value.urls.parent,class:"rounded-xl flex bg-base-100 shadow-xs items-center gap-4 py-2 px-4 overflow-hidden"},[e[48]||(e[48]=t("div",{class:""},[t("i",{class:"fa-regular fa-arrow-left","aria-hidden":"true"})],-1)),t("div",Jt,[t("span",{innerHTML:o.value.links.back},null,8,Kt)])],8,Gt)):d("",!0),(l(!0),s(P,null,U(r.value,c=>(l(),G(R,{key:c.id,entity:c,"is-parent":!1,i18n:p.value,selecting:H.value,layout:j.value},null,8,["entity","i18n","selecting","layout"]))),128))],2)]),(l(),s("div",Vt,[k.value?(l(),s("div",Qt,e[49]||(e[49]=[t("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"},null,-1)]))):(l(),G(_e(Se),{key:0,data:w.value,itemClasses:["bg-base-200","text-base-content","border-none","hover:bg-base-300"],activeClasses:["bg-base-100","border-none","text-base-content"],onPaginationChangePage:fe},null,8,["data"]))])),r.value.length===0?(l(),s("p",{key:1,class:"help-text italic",innerHTML:p.value.noResults},null,8,Wt)):d("",!0),t("form",{method:"POST",action:y.value.print,ref_key:"printForm",ref:_},[(l(!0),s(P,null,U(Y(),c=>(l(),s("input",{type:"hidden",name:"model[]",value:c},null,8,Yt))),256)),t("input",{type:"hidden",name:"_token",value:f.value},null,8,Zt)],8,Xt)]))}}}),tn=["data-stack"],nn=["href","title"],ln=["title"],sn=["aria-label"],an={key:0,class:"fa-regular fa-check","aria-label":"selected"},rn=["href","data-id","data-url","innerHTML"],on=["data-stack"],un=["href","title"],dn=["title"],pn=["aria-label"],cn={key:0,class:"fa-regular fa-check","aria-label":"selected"},vn=["href","data-id","data-url","innerHTML"],fn={class:"flex items-center gap-4"},gn={key:0,class:"w-5 h-5 cursor-pointer border rounded-full text-center"},hn={key:0,class:"fa-regular fa-check","aria-label":"selected"},mn=["href","title"],yn=["href","data-id","data-url","innerHTML"],bn={class:"text-neutral-content lg:w-40 truncate"},kn=["innerHTML"],xn={class:"flex items-center gap-4 justify-between"},wn={class:"flex items-center gap-1"},_n=["href","innerHTML","title"],Ln=["aria-label","title"],Cn=["title"],Pn=["innerHTML"],Tn={key:4,class:"text-center"},Mn={key:5,class:"flex flex-col gap-1 pl-2"},$n=ce({__name:"Entity",props:{entity:{},isParent:{type:Boolean},selecting:{type:Boolean},i18n:{},layout:{}},setup(a){const u=v(!1),r=v(null),o=a,f=()=>{let n="entity overflow-hidden rounded shadow-xs hover:shadow w-[47%] xs:w-[25%] sm:w-48 aspect-square flex flex-col bg-box";return o.isParent&&(n+="shadow-lg stacking-parent font-bold"),n},h=()=>{let n="rounded-xl flex bg-base-100 shadow-xs items-center gap-4 py-2 px-4 overflow-hidden justify-between";return o.isParent&&(n+=" shadow-lg stacking-parent"),o.selecting&&(n+=" cursor-pointer"),n},_=()=>({backgroundImage:"url('"+o.entity.images.thumb+"')"}),g=()=>{let n={};return n["data-entity"]=o.entity.id,n["data-entity-type"]=o.entity.entityType.code,n["data-type"]=o.entity.type,o.entity.attributes.forEach(k=>{n[`data-${k}`]=!0}),n},w=()=>o.entity.children>0,m=n=>{o.selecting?y():window.location.href=n.target.href},y=()=>{o.entity.selected=!o.entity.selected},x=()=>{let n="rounded rounded-full opacity-80 h-6 w-6 absolute left-1.5 top-1.5 border border-primary flex items-center justify-center text-xl";return o.entity.selected?n+" bg-primary text-primary-content":n+" bg-base-100 "},C=()=>{u.value=!0,fetch(o.entity.urls.children_api).then(n=>n.json()).then(n=>{D(n),u.value=!1})},D=n=>{console.log("children",n.entities.data),r.value=[],n.entities.data.forEach(k=>{r.value.push(k)})},q=n=>" tag rounded-full text-xs flex items-center justify-center badge cursor-pointer hover:shadow-xs "+n.colour,T=()=>o.layout==="grid";return(n,k)=>{const M=ne("Entity",!0);return l(),s(P,null,[T()&&w()?(l(),s("div",{key:0,class:"stack inline-grid items-center align-items-end w-[47%] xs:w-[25%] sm:w-48","data-stack":n.entity.children},[t("div",E({class:"entity overflow-hidden rounded shadow-xs hover:shadow aspect-square w-full flex flex-col bg-box"},g()),[t("a",{href:n.entity.urls.children,title:n.entity.name,class:"block avatar grow relative cover-background overflow-hidden text-center",style:te(_()),onClick:A(m,["prevent"])},[n.entity.is_private&&!n.selecting?(l(),s("div",{key:0,class:"bubble-private absolute left-1.5 top-1.5 text-xs shadow-xs flex justify-center align-items-center items-center aspect-square rounded-full w-6 h-6 bg-box opacity-80 text-base-content",title:n.i18n.is_private},[t("i",{class:"fa-regular fa-lock","aria-label":n.i18n.is_private},null,8,sn)],8,ln)):n.selecting?(l(),s("div",{key:1,class:L(x())},[n.entity.selected?(l(),s("i",an)):d("",!0)],2)):d("",!0)],12,nn),t("a",{href:n.entity.urls.show,class:"block text-center relative truncate h-12 p-4","data-toggle":"tooltip-ajax","data-id":n.entity.id,"data-url":n.entity.urls.tooltip,innerHTML:n.entity.name,onClick:A(m,["prevent"])},null,8,rn)],16),(l(!0),s(P,null,U(n.entity.children,b=>(l(),s("div",{class:"entity entity-stack bg-base-300 w-full overflow-hidden rounded aspect-square flex flex-col shadow-xs",title:"{{ __('datagrids.tooltips.nested') }}","data-stack":b},k[1]||(k[1]=[t("div",{class:"block grow"},null,-1),t("div",{class:"block h-12 p-4 bg-box"},null,-1)]),8,on))),256))],8,tn)):T()?(l(),s("div",E({key:1,class:f()},g()),[t("a",{href:n.entity.urls.show,class:"block avatar grow relative cover-background",style:te(_()),title:n.entity.name,onClick:A(m,["prevent"])},[n.entity.is_private&&!n.selecting?(l(),s("div",{key:0,class:"bubble-private absolute left-1.5 top-1.5 text-xs shadow-xs flex justify-center align-items-center items-center aspect-square rounded-full w-6 h-6 bg-box opacity-80 text-base-content",title:n.i18n.is_private},[t("i",{class:"fa-regular fa-lock","aria-label":n.i18n.is_private},null,8,pn)],8,dn)):n.selecting?(l(),s("div",{key:1,class:L(x())},[n.entity.selected?(l(),s("i",cn)):d("",!0)],2)):d("",!0)],12,un),t("a",{href:n.entity.urls.show,class:"block text-center relative truncate h-12 p-4","data-toggle":"tooltip-ajax","data-id":n.entity.id,"data-url":n.entity.urls.tooltip,innerHTML:n.entity.name,onClick:A(m,["prevent"])},null,8,vn)],16)):(l(),s("div",E({key:2,class:h()},g(),{onClick:m}),[t("div",fn,[n.selecting?(l(),s("div",gn,[n.entity.selected?(l(),s("i",hn)):d("",!0)])):d("",!0),t("a",{href:n.entity.urls.show,class:"block avatar w-8 h-8 rounded-full relative cover-background",style:te(_()),title:n.entity.name,onClick:A(m,["prevent"])},null,12,mn),t("a",{href:n.entity.urls.show,class:"truncate lg:w-40","data-toggle":"tooltip-ajax","data-id":n.entity.id,"data-url":n.entity.urls.tooltip,innerHTML:n.entity.name,onClick:A(m,["prevent"])},null,8,yn),t("div",bn,[t("span",{innerHTML:n.entity.type},null,8,kn)])]),t("div",xn,[t("div",wn,[(l(!0),s(P,null,U(n.entity.tags,b=>(l(),s("a",{href:b.urls.show,class:L(q(b)),innerHTML:b.shortname,title:b.name},null,10,_n))),256))]),n.entity.is_private?(l(),s("i",{key:0,class:"fa-regular fa-lock","aria-label":n.i18n.is_private,title:n.i18n.is_private},null,8,Ln)):d("",!0)])],16)),n.entity.children&&!T()&&!u.value&&!r.value?(l(),s("div",{key:3,onClick:k[0]||(k[0]=b=>C()),title:n.entity.name,class:"flex items-center justify-center gap-2 cursor-pointer text-xs p-0.5 hover:bg-base-200 rounded-xl"},[k[2]||(k[2]=t("i",{class:"fa-regular fa-angles-down","aria-hidden":"true"},null,-1)),t("span",{innerHTML:n.entity.children},null,8,Pn)],8,Cn)):d("",!0),u.value?(l(),s("span",Tn,k[3]||(k[3]=[t("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"},null,-1)]))):d("",!0),r.value?(l(),s("div",Mn,[(l(!0),s(P,null,U(r.value,b=>(l(),G(M,{key:b.id,entity:b,"is-parent":!1,i18n:n.i18n,selecting:n.selecting,layout:n.layout},null,8,["entity","i18n","selecting","layout"]))),128))])):d("",!0)],64)}}}),Hn={data(){return{open:!1}},methods:{handleClickOutside(){this.open&&(this.open=!1)}}},jn=["do"],En={class:"relative mx-auto"},Un={class:"absolute pin-l mt-px"};function Bn(a,u,r,o,f,h){return l(),s("div",{do:h.handleClickOutside},[t("div",En,[t("div",{role:"button",class:"inline-block select-none",onClick:u[0]||(u[0]=_=>f.open=!f.open)},[J(a.$slots,"link")]),N(t("div",Un,[J(a.$slots,"dropdown")],512),[[Le,f.open]])])],8,jn)}const Rn=Pe(Hn,[["render",Bn]]),O=Ce({});O.component("entities-explorer",en);O.component("entities-entity",$n);O.component("dropdown",Rn);O.use(Te);O.mount("#entities-explorer");

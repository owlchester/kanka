import{S as ft}from"./sortable.esm-DdTU3J9A.js";import"./dialog-DWzDCZv8.js";import{C as ie}from"./coloris-DsKOFKq5.js";import{d as I,o as Te,a as i,c as l,b as o,t as h,n as F,e as _,f as v,F as S,r as C,g as A,h as x,i as B,w as te,j as ge,v as ke,k as ee,l as ht,m as pe,p as Re,q as gt}from"./vue.esm-bundler-C87APpr1.js";import{v as pt}from"./v-click-outside.umd-Cl-Y_A58.js";import{_ as tn}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as nn}from"./Browser.vue_vue_type_script_setup_true_lang-wvr7ZTO0.js";import{t as de}from"./tippy.esm-CnBRltuW.js";import"./_commonjsHelpers-Cpj98o6Y.js";const vt="kanka.default";window.triggerEvent=function(e){e=e||vt;const t=new Event(e);document.dispatchEvent(t)};window.onEvent=function(e,t){t=t||vt,document.addEventListener(t,e)};window.onReady=function(e){document.readyState==="complete"||document.readyState==="interactive"?setTimeout(e,1):document.addEventListener("DOMContentLoaded",e)};window.initTags=function(){document.querySelectorAll(".form-tags")?.forEach(function(e){e.classList.contains("select2-hidden-accessible")||e.dataset.loaded!==1&&(e.dataset.loaded=1,$(e).select2({tags:e.dataset.allowNew==="true",allowClear:e.dataset.allowClear==="true",dropdownParent:e.dataset.dropdownParent||"",minimumInputLength:0,ajax:{quietMillis:500,delay:500,url:e.dataset.url,dataType:"json",data:function(t){return{q:t.term?.trim()}},processResults:function(t){return{results:t}},cache:!0},escapeMarkup:function(t){return t},createTag:function(t){const n=t.term?.trim();return n===""?null:{id:n,text:n,newTag:!0}},templateResult:function(t){const n=document.createElement("span");return n.classList.add("block","grow","text-left"),n.innerHTML=t.text,t.colour&&(n.classList.add("flex","gap-2","items-center","text-left"),n.innerHTML="<span class='rounded-full flex-none w-6 h-6 "+t.colour+"' /></span><span class='grow'>"+t.text+"</span>"),n},templateSelection:function(t,n){if(t.newTag){const a=document.createElement("span");return a.classList.add("new-tag"),a.title=e.dataset.newTag,a.innerHTML=t.text+' <i class="fa-solid fa-flag" aria-hidden="true"></i>',a}let r=t.element,s=[];return t.colour?s=t.colour.trim().split(" "):r.dataset.colour&&(s=r.dataset.colour.trim().split(" ")),s.length>0&&s.forEach(a=>{a.trim().length!==0&&n[0].classList.add(a)}),n[0].classList.add("text-left"),t.text}}))}),document.querySelectorAll(".position-dropdown")?.forEach(function(e){e.classList.contains("select2-hidden-accessible")||e.dataset.loaded!==1&&(e.dataset.loaded=1,$(e).select2({tags:!0,allowClear:!0,dropdownParent:e.dataset.dropdownParent||"",placeholder:e.dataset.placeholder,minimumInputLength:0,createTag:function(t){const n=t.term?.trim();return n===""?null:{id:n,text:n,newTag:!0}}}))})};window.initTags();var Fe={};var Ne;function rn(){return Ne||(Ne=1,(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var e=jQuery.fn.select2.amd;e.define("select2/i18n/de",[],function(){return{errorLoading:function(){return"Die Ergebnisse konnten nicht geladen werden."},inputTooLong:function(t){return"Bitte "+(t.input.length-t.maximum)+" Zeichen weniger eingeben"},inputTooShort:function(t){return"Bitte "+(t.minimum-t.input.length)+" Zeichen mehr eingeben"},loadingMore:function(){return"Lade mehr Ergebnisse…"},maximumSelected:function(t){var n="Sie können nur "+t.maximum+" Element";return t.maximum!=1&&(n+="e"),n+=" auswählen"},noResults:function(){return"Keine Übereinstimmungen gefunden"},searching:function(){return"Suche…"},removeAllItems:function(){return"Entferne alle Elemente"}}}),e.define,e.require})()),Fe}rn();var Qe={};var ze;function sn(){return ze||(ze=1,(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var e=jQuery.fn.select2.amd;e.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(t){var n=t.input.length-t.maximum,r="Please delete "+n+" character";return n!=1&&(r+="s"),r},inputTooShort:function(t){return"Please enter "+(t.minimum-t.input.length)+" or more characters"},loadingMore:function(){return"Loading more results…"},maximumSelected:function(t){var n="You can only select "+t.maximum+" item";return t.maximum!=1&&(n+="s"),n},noResults:function(){return"No results found"},searching:function(){return"Searching…"},removeAllItems:function(){return"Remove all items"}}}),e.define,e.require})()),Qe}sn();var Oe={};var Ue;function on(){return Ue||(Ue=1,(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var e=jQuery.fn.select2.amd;e.define("select2/i18n/es",[],function(){return{errorLoading:function(){return"No se pudieron cargar los resultados"},inputTooLong:function(t){var n=t.input.length-t.maximum,r="Por favor, elimine "+n+" car";return r+=n==1?"ácter":"acteres"},inputTooShort:function(t){var n=t.minimum-t.input.length,r="Por favor, introduzca "+n+" car";return r+=n==1?"ácter":"acteres"},loadingMore:function(){return"Cargando más resultados…"},maximumSelected:function(t){var n="Sólo puede seleccionar "+t.maximum+" elemento";return t.maximum!=1&&(n+="s"),n},noResults:function(){return"No se encontraron resultados"},searching:function(){return"Buscando…"},removeAllItems:function(){return"Eliminar todos los elementos"}}}),e.define,e.require})()),Oe}on();var Ke={};var Ve;function an(){return Ve||(Ve=1,(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var e=jQuery.fn.select2.amd;e.define("select2/i18n/fr",[],function(){return{errorLoading:function(){return"Les résultats ne peuvent pas être chargés."},inputTooLong:function(t){var n=t.input.length-t.maximum;return"Supprimez "+n+" caractère"+(n>1?"s":"")},inputTooShort:function(t){var n=t.minimum-t.input.length;return"Saisissez au moins "+n+" caractère"+(n>1?"s":"")},loadingMore:function(){return"Chargement de résultats supplémentaires…"},maximumSelected:function(t){return"Vous pouvez seulement sélectionner "+t.maximum+" élément"+(t.maximum>1?"s":"")},noResults:function(){return"Aucun résultat trouvé"},searching:function(){return"Recherche en cours…"},removeAllItems:function(){return"Supprimer tous les éléments"}}}),e.define,e.require})()),Ke}an();var Ge={};var We;function ln(){return We||(We=1,(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var e=jQuery.fn.select2.amd;e.define("select2/i18n/it",[],function(){return{errorLoading:function(){return"I risultati non possono essere caricati."},inputTooLong:function(t){var n=t.input.length-t.maximum,r="Per favore cancella "+n+" caratter";return r+=n!==1?"i":"e"},inputTooShort:function(t){return"Per favore inserisci "+(t.minimum-t.input.length)+" o più caratteri"},loadingMore:function(){return"Caricando più risultati…"},maximumSelected:function(t){var n="Puoi selezionare solo "+t.maximum+" element";return t.maximum!==1?n+="i":n+="o",n},noResults:function(){return"Nessun risultato trovato"},searching:function(){return"Sto cercando…"},removeAllItems:function(){return"Rimuovi tutti gli oggetti"}}}),e.define,e.require})()),Ge}ln();var Ze={};var Ye;function cn(){return Ye||(Ye=1,(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var e=jQuery.fn.select2.amd;e.define("select2/i18n/nl",[],function(){return{errorLoading:function(){return"De resultaten konden niet worden geladen."},inputTooLong:function(t){return"Gelieve "+(t.input.length-t.maximum)+" karakters te verwijderen"},inputTooShort:function(t){return"Gelieve "+(t.minimum-t.input.length)+" of meer karakters in te voeren"},loadingMore:function(){return"Meer resultaten laden…"},maximumSelected:function(t){var n=t.maximum==1?"kan":"kunnen",r="Er "+n+" maar "+t.maximum+" item";return t.maximum!=1&&(r+="s"),r+=" worden geselecteerd"},noResults:function(){return"Geen resultaten gevonden…"},searching:function(){return"Zoeken…"},removeAllItems:function(){return"Verwijder alle items"}}}),e.define,e.require})()),Ze}cn();var Je={};var Xe;function dn(){return Xe||(Xe=1,(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var e=jQuery.fn.select2.amd;e.define("select2/i18n/pl",[],function(){var t=["znak","znaki","znaków"],n=["element","elementy","elementów"],r=function(s,a){return s===1?a[0]:s>1&&s<=4?a[1]:s>=5?a[2]:void 0};return{errorLoading:function(){return"Nie można załadować wyników."},inputTooLong:function(s){var a=s.input.length-s.maximum;return"Usuń "+a+" "+r(a,t)},inputTooShort:function(s){var a=s.minimum-s.input.length;return"Podaj przynajmniej "+a+" "+r(a,t)},loadingMore:function(){return"Trwa ładowanie…"},maximumSelected:function(s){return"Możesz zaznaczyć tylko "+s.maximum+" "+r(s.maximum,n)},noResults:function(){return"Brak wyników"},searching:function(){return"Trwa wyszukiwanie…"},removeAllItems:function(){return"Usuń wszystkie przedmioty"}}}),e.define,e.require})()),Je}dn();var et={};var tt;function un(){return tt||(tt=1,(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var e=jQuery.fn.select2.amd;e.define("select2/i18n/pt-BR",[],function(){return{errorLoading:function(){return"Os resultados não puderam ser carregados."},inputTooLong:function(t){var n=t.input.length-t.maximum,r="Apague "+n+" caracter";return n!=1&&(r+="es"),r},inputTooShort:function(t){return"Digite "+(t.minimum-t.input.length)+" ou mais caracteres"},loadingMore:function(){return"Carregando mais resultados…"},maximumSelected:function(t){var n="Você só pode selecionar "+t.maximum+" ite";return t.maximum==1?n+="m":n+="ns",n},noResults:function(){return"Nenhum resultado encontrado"},searching:function(){return"Buscando…"},removeAllItems:function(){return"Remover todos os itens"}}}),e.define,e.require})()),et}un();var nt={};var rt;function mn(){return rt||(rt=1,(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var e=jQuery.fn.select2.amd;e.define("select2/i18n/ru",[],function(){function t(n,r,s,a){return n%10<5&&n%10>0&&n%100<5||n%100>20?n%10>1?s:r:a}return{errorLoading:function(){return"Невозможно загрузить результаты"},inputTooLong:function(n){var r=n.input.length-n.maximum,s="Пожалуйста, введите на "+r+" символ";return s+=t(r,"","a","ов"),s+=" меньше"},inputTooShort:function(n){var r=n.minimum-n.input.length,s="Пожалуйста, введите ещё хотя бы "+r+" символ";return s+=t(r,"","a","ов")},loadingMore:function(){return"Загрузка данных…"},maximumSelected:function(n){var r="Вы можете выбрать не более "+n.maximum+" элемент";return r+=t(n.maximum,"","a","ов")},noResults:function(){return"Совпадений не найдено"},searching:function(){return"Поиск…"},removeAllItems:function(){return"Удалить все элементы"}}}),e.define,e.require})()),nt}mn();var st={};var ot;function fn(){return ot||(ot=1,(function(){if(jQuery&&jQuery.fn&&jQuery.fn.select2&&jQuery.fn.select2.amd)var e=jQuery.fn.select2.amd;e.define("select2/i18n/sk",[],function(){var t={2:function(n){return n?"dva":"dve"},3:function(){return"tri"},4:function(){return"štyri"}};return{errorLoading:function(){return"Výsledky sa nepodarilo načítať."},inputTooLong:function(n){var r=n.input.length-n.maximum;return r==1?"Prosím, zadajte o jeden znak menej":r>=2&&r<=4?"Prosím, zadajte o "+t[r](!0)+" znaky menej":"Prosím, zadajte o "+r+" znakov menej"},inputTooShort:function(n){var r=n.minimum-n.input.length;return r==1?"Prosím, zadajte ešte jeden znak":r<=4?"Prosím, zadajte ešte ďalšie "+t[r](!0)+" znaky":"Prosím, zadajte ešte ďalších "+r+" znakov"},loadingMore:function(){return"Načítanie ďalších výsledkov…"},maximumSelected:function(n){return n.maximum==1?"Môžete zvoliť len jednu položku":n.maximum>=2&&n.maximum<=4?"Môžete zvoliť najviac "+t[n.maximum](!1)+" položky":"Môžete zvoliť najviac "+n.maximum+" položiek"},noResults:function(){return"Nenašli sa žiadne položky"},searching:function(){return"Vyhľadávanie…"},removeAllItems:function(){return"Odstráňte všetky položky"}}}),e.define,e.require})()),st}fn();window.initForeignSelect=function(){const e=document.querySelectorAll("select.select2");e.length!==0&&(e.forEach(t=>{if(t.classList.contains("select2-hidden-accessible"))return;if(t.classList.contains("campaign-genres")){$(t).select2({tags:!1,allowClear:!0,dropdownParent:"",width:"100%",maximumSelectionLength:3});return}const n=t.dataset.url,r=t.dataset.allowClear,s=t.dataset.dropdownParent||"",a=t.dataset.placeholder;if(!n){$(t).select2({tags:!1,placeholder:a,allowClear:r??!1,language:t.dataset.language,minimumInputLength:0,dropdownParent:s,width:"100%"});return}$(t).select2({tags:t.dataset.allowNew==="true",placeholder:a,allowClear:r||!0,language:t.dataset.language,minimumInputLength:0,dropdownParent:s,width:"100%",ajax:{delay:500,quietMillis:500,url:n,dataType:"json",data:function(d){return{q:d.term?.trim()}},processResults:function(d){return{results:d}},error:function(d){return d.status===503&&window.showToast(d.responseJSON.message,"error"),{results:[]}},cache:!0},templateResult:hn,templateSelection:gn,escapeMarkup:function(d){return d},createTag:function(d){if(t.dataset.allowNew!=="true")return null;let c=d.term?.trim();return c===""?null:{id:c,text:c+" ("+t.dataset.newTag+")",newTag:!0}}})}),pn(),vn())};const hn=e=>{const t=document.createElement("span");return e.image?(t.classList.add("flex","gap-2","items-center","text-left"),t.innerHTML="<img src='"+e.image+"' class='rounded-full flex-none w-6 h-6'/><span class='grow'>"+e.text+"</span>"):t.innerHTML=e.text,t},gn=e=>{if(!e.id)return e.text;const t=document.createElement("span");return t.innerHTML=e.text,t},pn=()=>{const e=document.querySelectorAll("select.select2-local");e.length!==0&&e.forEach(t=>{$(t).select2({placeholder:t.dataset.placeholder,language:t.dataset.language,allowClear:!0})})},vn=()=>{const e=document.querySelectorAll("select.select2-colour");e.length!==0&&e.forEach(t=>{$(t).select2({placeholder:t.dataset.placeholder,language:t.dataset.language,allowClear:!1,templateResult:at,templateSelection:at})})},at=e=>{if(e.id==="none")return e.text;const t=document.createElement("span");return t.innerHTML='<div class="badge label bg-'+e.id+'"> </div>'+e.text,t},yt=()=>{document.querySelectorAll("form[data-shortcut]").forEach(function(t){yn(t)})},wt=()=>{document.addEventListener("keydown",function(e){const t=e.target,n=document.getElementById("primary-dialog"),r=document.querySelector(".quick-creator-button");let s=document.querySelector('[data-keyboard="edit"]');if(e.key==="]"){if(ae(t))return;e.preventDefault();const a=document.querySelector(".sidebar-toggle");a.click(),a.blur()}else if(e.key==="k"){if(ae(t))return;e.preventDefault(),document.getElementById("entity-lookup").focus()}else if(e.key==="n"&&!(e.ctrlKey||e.metaKey)&&!e.altKey&&r){if(ae(t)||n?.open)return;r.click()}else if(e.key==="e"&&!(e.ctrlKey||e.metaKey)&&s){if(ae(t)||n?.open)return;s.click()}else e.key==="Escape"&&n?.classList.contains("qq-modal-selection").length===1&&window.closeDialog(n)})},ae=e=>!e||e.length===0?!1:["input","textarea","select"].includes(e.tagName.toLowerCase())||e.getAttribute("contentEditable")==="true"?!0:!!e.classList.contains("CodeMirror"),yn=e=>{e.dataset.shortcutInit||(e.dataset.shortcutInit=1,document.addEventListener("keydown",function(t){if((t.ctrlKey||t.metaKey)&&t.key.toLowerCase()==="s")return t.preventDefault(),e.dataset.unload&&(window.entityFormHasUnsavedChanges=!1),t.shiftKey?ve("submit-update"):t.altKey&&ve("submit-new"),e.requestSubmit(),console.log("requested tos ubmit",e),!1;if((t.ctrlKey||t.metaKey)&&t.altKey&&t.key==="c")return e.dataset.unload&&(window.entityFormHasUnsavedChanges=!1),ve("submit-copy"),e.submit(),!1}))},ve=e=>{const t=document.getElementById("form-submit-main");t&&(t.name=e,document.getElementById("submit-mode").name=e)},xt=()=>{document.querySelectorAll('input[data-paste="fontawesome"]').forEach(function(t){t.addEventListener("paste",function(n){n.preventDefault();const r=(n.clipboardData||window.clipboardData).getData("text");if(r.startsWith('<i class="fa')||r.startsWith('<i class="ra')){const s=document.createElement("div");s.innerHTML=r;let d=s.querySelector("i").getAttribute("class");if(d){t.value=d;return}}t.value=r})})};yt();wt();xt();window.onEvent(function(){xt(),wt(),yt()});function wn(){window.onEvent(function(){bt()})}function xn(){const e=document.querySelector('#form-entry input[name="name"]');if(!e||e.dataset.liveDisabled)return;let t="";e.addEventListener("focusout",function(n){if(!e.value||e.value===t)return;t=e.value;const r=this.dataset.duplicate,s=document.querySelector(r);if(!s)return;const a=this.dataset.live+"?q="+encodeURIComponent(this.value)+"&exclude="+this.dataset.id;s.classList.add("hidden");const d=s.querySelector(".duplicates");fetch(a).then(c=>c.json()).then(c=>{d.innerHTML="",c.forEach(u=>{const m=document.createElement("a");m.href=u.url,m.text=u.name,d.appendChild(m)}),c.length>0&&s.classList.remove("hidden")})})}const bt=()=>{const e=document.querySelectorAll(".form-submit-actions");if(e.length===0)return;let t=document.getElementById("form-submit-main"),n=document.getElementById("submit-mode");if(n===void 0)throw new Error("No submit mode hidden input found");e.forEach(r=>{r.addEventListener("click",function(s){return s.preventDefault(),n.name=r.dataset.action,t.click(),!1})})};function bn(){if(document.querySelectorAll('form[data-unload="1"]').length===0)return;const t=document.querySelector("#form-submit-main");document.querySelectorAll('form[data-unload="1"] input, form[data-unload="1"] select, form[data-unload="1"] textarea').forEach(r=>{r.dataset.skipUnsaved||r.classList.contains("form-control")||(r.addEventListener("change",function(){window.entityFormHasUnsavedChanges=!0}),r.classList.contains("select2")&&(typeof $<"u"?$(r).on("change",()=>{window.entityFormHasUnsavedChanges=!0}):r.addEventListener("change",()=>{window.entityFormHasUnsavedChanges=!0})))}),t&&window.addEventListener("beforeunload",function(r){window.entityFormHasUnsavedChanges&&(r.preventDefault(),r.returnValue="Unsaved data warning")})}const kn=()=>{document.querySelectorAll(".dynamic-row-add").forEach(t=>{t.addEventListener("click",function(n){n.preventDefault();const r=t.dataset.target,s=t.dataset.template,a=document.createElement("div");return a.innerHTML=document.querySelector("#"+s).innerHTML,document.querySelector("."+r).append(a),it(),window.triggerEvent(),!1})}),it()},it=()=>{document.querySelectorAll(".dynamic-row-delete").forEach(t=>{t.dataset.init!==1&&(t.dataset.init=1,t.addEventListener("click",function(n){n.preventDefault(),t.closest(".parent-delete-row").remove()}),t.addEventListener("keydown",function(n){n.key==="Enter"&&t.click()}))})};kn();bt();bn();wn();xn();const kt=()=>{document.querySelector(".btn-post-collapse")?.addEventListener("click",function(n){n.preventDefault(),document.querySelectorAll(".element-toggle").forEach(s=>{s.classList.add("animate-collapsed"),document.querySelector(s.dataset.target).classList.add("hidden")})}),document.querySelector(".btn-post-expand")?.addEventListener("click",function(n){n.preventDefault(),document.querySelectorAll(".element-toggle").forEach(s=>{s.classList.remove("animate-collapsed"),document.querySelector(s.dataset.target).classList.remove("hidden")})})},Lt=()=>{const e=document.querySelector(".story-load-more");e?.addEventListener("click",function(t){return t.preventDefault(),this.classList.add("loading"),axios.get(this.dataset.url).then(n=>{e.parentNode.remove(),console.log(n),document.querySelector(".entity-posts").insertAdjacentHTML("beforeend",n.data),Lt(),kt(),window.triggerEvent()}).catch(()=>{e.classList.remove("loading")}),!1})},Ln=()=>{const e=document.querySelector(".domain-trust");e&&e.addEventListener("click",function(t){const n="kanka_trusted_domains";let r=document.cookie.match("(^|;) ?"+n+"=([^;]*)(;|$)");r=r?r[2]:"";const s=e.dataset.domain;r.includes(s)||(r&&(r+="|"),r+=s);let a=new Date;a.setTime(a.getTime()+720*60*60*1e3),document.cookie=n+"="+r+";path=/;expires="+a.toUTCString()+";sameSite=Strict"})},_n=()=>{let e=window.location.hash.substring(1);if(!e)return;let t=document.getElementById(e);if(t)return;let n=document.getElementById("post-anchor-loader");if(!n)return;let r=e.match(/\d+$/),s=n.dataset.url.replace("/0","/"+r);axios.get(s).then(a=>{n.insertAdjacentHTML("afterbegin",a.data),t=document.getElementById(e),window.scrollTo({top:t.offsetTop,behavior:"smooth"})})};kt();Lt();Ln();_n();const _t=document.querySelectorAll(".post-perm-add"),Sn=()=>{window.onEvent(function(){En()}),_t.length!==0&&(qn(),St())},qn=()=>{_t.forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();let n=this.dataset.type,r=document.querySelector('select[name="'+n+'"]');if(!r||!r.selectedOptions)return!1;let s=document.getElementById(this.dataset.template);for(const d of r.selectedOptions){const c=s.cloneNode(!0);c.classList.remove("hidden"),c.removeAttribute("id"),c.innerHTML=c.innerHTML.replace(/\$SELECTEDID\$/g,d.value).replace(/\$SELECTEDNAME\$/g,d.text),document.getElementById("post-perm-target").insertAdjacentElement("beforebegin",c)}document.getElementById(this.dataset.dialog).close(),St();for(const d of r.options)d.selected=!1;return r.value=null,r.dispatchEvent(new Event("change")),!1})})},St=()=>{document.querySelectorAll(".post-delete-perm").forEach(t=>{t.closest(".hidden")||t.dataset.init!=="1"&&(t.dataset.init="1",t.addEventListener("click",function(n){console.log("clicking",t,t.closest(".perm-row")),t.closest(".perm-row").remove(),n.preventDefault()}))})},En=()=>{const e=document.querySelector("form.post-visibility");e&&(e.onsubmit=function(t){return t.preventDefault(),axios.post(this.getAttribute("action"),{visibility_id:this.querySelector('[name="visibility_id"]').value}).then(n=>{document.getElementById("primary-dialog").close(),document.getElementById("visibility-icon-"+n.data.post_id).firstElementChild.className=n.data.icon.class,window.showToast(n.data.toast)}),!1})};Sn();const Tn=()=>{if(!document.querySelector("#calendar-year-switcher"))return;document.querySelectorAll(".calendar-event-block").forEach(t=>{t.dataset.toggle!=="dialog"&&t.dataset.url&&t.addEventListener("click",function(){window.location=t.dataset.url})}),document.querySelectorAll("[data-dbclick]").forEach(function(t){t.addEventListener("dblclick",function(){window.openDialog("primary-dialog",t.dataset.url)})})},qt=()=>{const e=document.querySelector('select[name="recurring_periodicity"]');if(!e)return;const t=()=>{const n=document.querySelector(".field-recurring-until");n&&(e.value?n.classList.remove("hidden"):n.classList.add("hidden"))};e.addEventListener("change",t),t()},Cn=()=>{(document.querySelector('[data-shortcut="previous"]')||document.querySelector('[data-shortcut="next"]'))&&document.addEventListener("keydown",function(t){if(t.ctrlKey||t.metaKey){if(t.key==="ArrowLeft"){const n=document.querySelector('[data-shortcut="previous"]');n&&(n.classList.add("loading"),n.click())}else if(t.key==="ArrowRight"){const n=document.querySelector('[data-shortcut="next"]');n&&(n.classList.add("loading"),n.click())}}})};Tn();Cn();qt();window.onEvent(function(){qt()});let X,T,ye,N,R,D,lt,le,Q;window.onEvent(function(){An()});const Mn=()=>{X=document.querySelector("#entity-calendar-form-add"),T=document.querySelector('select[name="calendar_id"]'),ye=document.querySelector('[name="calendar_id"]'),document.querySelector(".entity-calendar-modal-form"),Q=document.querySelector(".entity-calendar-subform"),lt=document.querySelector("#entity-calendar-form-cancel"),document.querySelector(".entity-calendar-form"),R=document.querySelector('input[name="calendar_year"]'),N=document.querySelector('[name="calendar_month"]'),D=document.querySelector("#reminder_day"),le=document.querySelector(".entity-calendar-loading"),X&&(X.addEventListener("click",function(e){e.preventDefault();let t=X.dataset.defaultCalendar;return t&&(ye.value=t,Q.classList.remove("hidden"),ce(t)),!1}),lt.addEventListener("click",function(e){e.preventDefault(),T&&(T.value=null),ye.value=null})),T&&(T.onchange=e=>{if(console.log("hello mlord"),!T.value)return Q.classList.add("hidden"),!1;Q.classList.remove("hidden"),R=document.querySelector('input[name="calendar_year"]'),N=document.querySelector('[name="calendar_month"]'),D=document.querySelector("#reminder_day"),!R&&document.querySelector('input[name="year"]')&&(R=document.querySelector('input[name="year"]'),N=document.querySelector('select[name="month"]'),D=document.querySelector("#reminder_day")),ce(T.value)}),Et()},An=()=>{if(!document.getElementById("entity-calendar-modal-add"))return;X=document.querySelector("input[name=calendar-data-url]"),T=document.querySelector('[name="calendar_id"]'),R=document.querySelector('input[name="year"]'),N=document.querySelector('select[name="month"]'),D=document.querySelector("#reminder_day"),le=document.querySelector(".entity-calendar-loading"),Q=document.querySelector(".entity-calendar-subform"),T&&(T.onchange=t=>{if(!T.value){Q.classList.add("hidden");return}ce(T.value),Q.classList.remove("hidden")},T?.value&&ce(T.value));const e=document.querySelector('.entity-calendar-subform input[name="length"]');e&&e.addEventListener("focusout",function(){if(!this.value)return;const t=this.dataset.url.replace("/0/","/"+T.value+"/"),n={day:D.value,month:N.value,year:R.value,length:this.value};axios.get(t,{data:n}).then(r=>{const s=document.querySelector(".length-warning");r.data.overflow==!0?s.classList.remove("hidden"):s.classList.add("hidden")})}),Et()},ce=e=>{le.classList.remove("hidden"),e=parseInt(e);const t=document.querySelector('input[name="calendar-data-url"]').dataset.url.replace("/0/","/"+e+"/");fetch(t).then(n=>n.json()).then(n=>{let r=D.value;R.innerHTML="",N.innerHTML="",D.innerHTML="";let s=1,a=1;r||(r=n.current.day);let d=parseInt(n.current.month);Object.entries(n.months).forEach((f,w)=>{const g=document.createElement("option");g.text=f[1].name,g.value=w+1,f[0]===d&&(g.selected=!0),g.dataset.length=f[1].length,N.appendChild(g),s===d&&(a=f[1].length),s++});for(let f=1;f<=a;f++){const w=document.createElement("option");w.text=f,w.value=f,f==r&&(w.selected=!0),D.appendChild(w)}le.classList.add("hidden"),R.value=n.current.year;const u=document.querySelector("select.reminder-periodicity");for(;u.options.length>0;)u.options.remove(0);Object.entries(n.recurring).forEach((f,w)=>{const g=document.createElement("option");g.value=f[0],g.text=f[1],u.appendChild(g)}),document.querySelector("#reminder_length").value=1,n.length===1&&(N.value=n[0].id)})},Et=()=>{const e=document.querySelector("#reminder_month");e&&e.addEventListener("change",function(t){const r=e.options[e.selectedIndex].dataset.length;$n(r)})},$n=e=>{let t=parseInt(D.value);e=parseInt(e),t>e&&(t=e),D.innerHTML="";for(let n=1;n<=e;n++){const r=document.createElement("option");r.text=n,r.value=n,n===t&&(r.selected=!0),D.appendChild(r)}};Mn();const Tt=document.querySelector("dialog#edit-warning"),Le=300*1e3;let Dn=document.querySelector('input[name="edit-warning"]'),Ct,_e=!0;const jn=()=>{Tt&&(window.openDialog("edit-warning",Dn.dataset.url),window.onEvent(function(){Hn()}),In())};function Hn(){_e=!1;const e=document.getElementById("entity-edit-warning-ignore");e.addEventListener("click",function(t){t.preventDefault(),_e=!0,axios.post(e.dataset.url).then(()=>{Tt.close()})})}const In=()=>{const e=document.getElementById("editing-keep-alive");e&&(Ct=e.dataset.url,setTimeout(Se,Le))},Se=()=>{if(!_e){setTimeout(Se,Le);return}axios.post(Ct).then(()=>{setTimeout(Se,Le)})};window.onReady(()=>{jn()});let J,Mt,At,ne;const Ce=()=>{Mt=document.querySelector("#qq-modal-loading"),At=document.querySelector("#qq-modal-selection"),ne=document.querySelector("#qq-modal-form"),document.querySelectorAll('[data-toggle="entity-creator"]').forEach(e=>{e.addEventListener("click",Pn)})},Pn=e=>{e.preventDefault();const t=e.currentTarget;return t.dataset.type==="inline"?(document.querySelector(".quick-creator-body").classList.add("hidden"),document.querySelector(".quick-creator-footer")?.classList.add("hidden"),document.querySelector(".quick-creator-loading").classList.remove("hidden!")):Bn(),axios.get(t.dataset.url).then(r=>{Mt.classList.add("hidden!"),At.classList.add("hidden!"),ne.innerHTML=r.data,ne.classList.remove("hidden!"),Me(),Ae(),window.triggerEvent()}),!1},$t=()=>{const e=document.querySelector("#qq-name-field");!e||e.dataset.init==="1"||(e.dataset.init="1",e.addEventListener("focusout",function(){if(!this.value)return;const t=this.parentNode.querySelector(".duplicate-entity-warning");if(!t)return;t.classList.add("hidden");const n=this.dataset.live+"?q="+this.value+"&type="+this.dataset.type;axios.get(n).then(r=>{if(r.data.length===0){t.classList.add("hidden");return}const s=Object.keys(r.data).map(function(a){return'<a href="'+r.data[a].url+'" class="text-link">'+r.data[a].name+"</a>"}).join(", ");e.parentNode.querySelector(".duplicate-entities").innerHTML=s,t.classList.remove("hidden")})}))},Bn=()=>{document.querySelector("#qq-modal-form").classList.add("hidden!"),document.querySelector("#qq-modal-selection").classList.add("hidden!"),document.querySelector("#qq-modal-loading").classList.remove("hidden!")},Me=()=>{J=document.querySelectorAll(".quick-creator-submit"),J.length!==0&&($t(),Ae(),J.forEach(e=>{e.addEventListener("click",function(t){let n=this.value;return n&&(document.querySelector('#entity-creator-form [name="action"]').value=n),!0})}),document.getElementById("entity-creator-form").onsubmit=function(e){const t=e.target;e.preventDefault(),J.forEach(s=>s.classList.add("btn-disabled","loading")),document.querySelectorAll("div.text-error").forEach(s=>s.remove());const r=new FormData(t);axios.post(t.getAttribute("action"),r).then(s=>{if(typeof s.data=="object"){if(s.data.redirect){window.location.replace(s.data.redirect);return}let d=new Option(s.data._name,s.data._id,!0,!0),c=document.querySelector("#"+s.data._target);c.appendChild(d),c.dispatchEvent(new Event("change"));const u=document.querySelector("#qq-modal-form");u&&(u.innerHTML="",u.classList.remove("hidden!")),document.querySelector("#qq-modal-loading")?.classList.add("hidden!"),document.querySelector("#qq-modal-selection")?.classList.remove("hidden!"),document.getElementById("primary-dialog").close(),qe();return}let a=document.getElementById("qq-modal-form");a.innerHTML=s.data,window.triggerEvent(),Ce(),qe()}).catch(s=>{s.response&&window.formErrorHandler(s.response,t),J.forEach(a=>a.classList.remove("btn-disabled","loading")),document.querySelector('#entity-creator-form [name="action"]').value=""})})},Ae=()=>{document.querySelectorAll(".qq-mode-toggle").forEach(e=>{e.addEventListener("click",function(t){t.preventDefault(),!this.classList.contains("active")&&(document.querySelector(".qq-mode-toggle").classList.remove("active"),this.classList.add("active"),document.querySelector(".quick-creator-body").classList.add("hidden"),document.querySelector(".quick-creator-footer")?.classList.add("hidden"),document.querySelector(".quick-creator-loading").classList.remove("hidden!"),axios.get(this.dataset.url).then(n=>{ne.innerHTML=n.data,ne.classList.remove("hidden!"),qe(),window.triggerEvent()}))})}),document.querySelector(".qq-action-more")?.addEventListener("click",function(e){e.preventDefault(),this.classList.add("hidden"),document.querySelector(".qq-more-fields").classList.remove("hidden")}),Ce()},qe=()=>{Ae(),$t(),Me()},Rn=()=>{document.querySelectorAll(".quick-creator-subform").forEach(t=>{t.addEventListener("click",n=>{window.openDialog("primary-dialog",t.dataset.url)})})};window.onEvent(function(){Ce(),Me()});Rn();const Dt=()=>{document.querySelectorAll("[data-bulk-action]")?.forEach(n=>{n.addEventListener("click",r=>{r.preventDefault(),Nn(n.dataset.bulkAction)})}),document.querySelectorAll(".bulk-print")?.forEach(n=>{n.addEventListener("click",r=>{r.preventDefault(),n.closest("form").requestSubmit()})})},jt=()=>{Fn(),document.querySelectorAll("input[name='model[]']")?.forEach(t=>{t.dataset.initiated!=="1"&&(t.dataset.initiated="1",t.addEventListener("change",n=>{console.log("change"),n.preventDefault(),$e()}))})},Fn=()=>{const e=document.querySelector("#datagrid-select-all");e&&e.dataset.loaded!=="1"&&(e.dataset.loaded="1",e.addEventListener("click",function(t){const n=document.querySelectorAll("input[name='model[]']");e.checked?n?.forEach(r=>{r.checked=!0}):n?.forEach(r=>{r.checked=!1}),$e()}))},Nn=e=>{let t=[];document.querySelectorAll("input[name='model[]']")?.forEach(r=>{r.checked&&t.push(r.value)}),e==="ajax"?window.onEvent(function(){document.querySelector('#primary-dialog input[name="models"]').value=t.toString()}):document.querySelector("#datagrid-bulk-"+e+"-models").value=t.toString()},$e=()=>{let e=!0;document.querySelectorAll("input[name='model[]']")?.forEach(r=>{r.checked&&(e=!1)}),document.querySelectorAll(".datagrid-bulk-actions .btn2")?.forEach(r=>{e?(r.disabled=!0,r.classList.add("btn-disabled")):(r.disabled=!1,r.classList.remove("btn-disabled","disabled"))})},Qn=()=>{const e=document.querySelector(".list-treeview");if(!e)return;let t=e.dataset.url;document.querySelectorAll(".table-nested > tbody > tr").forEach(function(r){let s=r.dataset.children;parseInt(s)>0&&(r.classList.add("tr-hover"),r.classList.add("cursor-pointer"),r.addEventListener("click",function(a){const d=a.target;a.target.type!=="checkbox"&&d.dataset.tree!=="escape"&&(window.location=t+"?parent_id="+r.dataset.id+"&m=table")}))})};jt();Dt();$e();Qn();window.onEvent(function(){Dt(),jt()});let V;const zn=new IntersectionObserver(function(e){e.forEach(t=>{t.isIntersecting===!0&&De(t.target)})},{threshold:[0]}),Ht=()=>{document.querySelectorAll('table[data-render="datagrid2"]')?.forEach(t=>{De(t)})},De=e=>{Kn(e),e.dataset.initiated!=="1"&&(e.dataset.initiated="1",On(e),e.dataset.url&&Ee(e,e))},On=e=>{e.querySelectorAll("thead a")?.forEach(t=>{t.dataset.loaded!=="1"&&(t.dataset.loaded="1",t.addEventListener("click",function(n){n.preventDefault(),Ee(t,e)}))}),e.parentNode.querySelectorAll('nav[role="navigation"] a')?.forEach(t=>{t.dataset.loaded!=="1"&&(t.dataset.loaded="1",t.addEventListener("click",n=>{n.preventDefault(),Ee(t,e)}))})},Un=()=>{const e=document.querySelectorAll('[data-render="datagrid2-onload"]');e.length!==0&&e.forEach(t=>{zn.observe(t)})},Ee=(e,t)=>{t.querySelector("thead")?.classList.add("hidden"),t.querySelector("tbody")?.classList.add("hidden"),t.querySelector("tfoot")?.classList.remove("hidden");let n=e.getAttribute("href");e.dataset.url&&(n=e.dataset.url),t.parentNode&&axios.get(n).then(r=>{const s=t.parentNode;if(r.data.html&&(s.innerHTML=r.data.html),r.data.deletes){const d=document.querySelector("#datagrid-delete-forms");d&&(d.innerHTML=r.data.deletes)}r.data.url&&window.history.pushState({},"",r.data.url);const a=s.querySelector('[data-render="datagrid2"]');De(a),window.triggerEvent()}).catch(r=>{})},Kn=e=>{const t=e.parentNode;t.querySelectorAll(".datagrid-bulk")?.forEach(s=>{Gn(e,s)}),t.querySelectorAll(".datagrid-submit")?.forEach(s=>{Vn(e,s)}),document.querySelector("#datagrid-action-confirm")?.addEventListener("click",function(){window.closeDialog("datagrid-bulk-delete"),V.submit()})},Vn=(e,t)=>{t.parentNode.classList.contains("hidden")||t.dataset.loaded!=="1"&&(t.dataset.loaded="1",console.log("register bulk submit",t,t.parentNode),t.addEventListener("click",function(n){n.preventDefault(),V=t.closest("form");const r=V.querySelector('input[name="action"]');if(r.value=t.dataset.action,t.dataset.action==="delete")return window.openDialog("datagrid-bulk-delete"),!1;e.parentNode.querySelectorAll(".datagrid-bulk-actions .btn2")?.forEach(s=>s.classList.add("btn-disabled")),e.parentNode.querySelector(".datagrid-bulk-actions .btn2").classList.add("loading"),V.submit()}))},Gn=(e,t)=>{t.parentNode.classList.contains("hidden")||t.dataset.loaded!=="1"&&(t.dataset.loaded="1",t.addEventListener("click",function(n){n.preventDefault(),V=e.closest("form"),axios.post(V.getAttribute("action")+"?action=edit",{model:Wn(e)}).then(r=>{const s=document.getElementById("primary-dialog");s.innerHTML=r.data,window.openDialog("primary-dialog"),window.triggerEvent()})}))},Wn=e=>{let t=[];return e.querySelectorAll("input[name='model[]']")?.forEach(r=>{r.checked&&t.push(r.value)}),t};Un();Ht();window.onEvent(function(){Ht()});const It=()=>{document.querySelectorAll('[data-animate="collapse"]').forEach(s=>{s.addEventListener("click",Yn)}),document.querySelectorAll('[data-animate="reveal"]').forEach(s=>{s.addEventListener("change",Jn)}),document.querySelectorAll("[data-pulse]").forEach(s=>{s.addEventListener("click",Zn)}),document.querySelectorAll("select.permission-control").forEach(s=>{Pt(s),s.addEventListener("change",Xn)})},Zn=e=>{e.preventDefault();let t=document.querySelector(e.currentTarget.dataset.pulse),n=e.currentTarget.dataset.content;window.showTooltip(t,{content:n,theme:"kanka",placement:e.currentTarget.dataset.placement??"bottom",allowHTML:!0,arrow:!0,interactive:!0,trigger:"manual"})};function Yn(e){e.target.type!=="checkbox"&&e.preventDefault();let t=this.dataset.target;t||(t=this.hash),document.querySelectorAll(t).forEach(r=>{r.classList.toggle("hidden")}),this.classList.toggle("animate-collapsed")}function Jn(e){let t=document.querySelector(this.dataset.target);this.value?t.classList.remove("hidden"):t.classList.add("hidden")}function Xn(e){Pt(this)}function Pt(e){e.classList.remove("text-red-500","text-green-500"),e.value==="deny"?e.classList.add("text-red-500"):e.value==="allow"&&e.classList.add("text-green-500")}window.onEvent(function(){It()});It();const er=()=>{const e=document.getElementById("bookmark-selector");if(!e)return!1;e.addEventListener("change",function(t){t.preventDefault();const n=e.options[e.selectedIndex];document.querySelectorAll(".bookmark-subform").forEach(a=>{a.classList.add("opacity-0","invisible","h-0")});let s=document.querySelector(n.dataset.target);s&&s.classList.remove("opacity-0","invisible","h-0")})};er();const tr=()=>{let e=document.getElementById("webhook-selector");if(!e)return!1;e.addEventListener("change",function(t){t.preventDefault();let n=this.options[this.selectedIndex];document.querySelector(".webhook-subform").classList.add("hidden"),document.querySelector(n.dataset.target)?.classList.remove("hidden")})};tr();window.onEvent(function(){Bt()});const Bt=()=>{document.querySelectorAll(".form-members").forEach(t=>{if(t.dataset.loaded===1)return;t.dataset.loaded=1;let n=t.dataset.allowClear;$(t).select2({tags:!0,allowClear:n||!0,minimumInputLength:2,placeholder:t.dataset.placeholder,ajax:{quietMillis:500,delay:500,url:t.dataset.url,dataType:"json",data:function(r){return{q:r.term?.trim()}},processResults:function(r){return{results:r}},cache:!0},createTag:function(){},escapeMarkup:function(r){return r},templateSelection:function(r){return r.text?`<span>${r.text}</span>`:r.text}})})};Bt();const nr=()=>{if(!document.getElementById("campaign-modules"))return;document.querySelectorAll('input[name="enabled"]').forEach(function(n){rr(n)})},rr=e=>{e.addEventListener("change",function(t){t.preventDefault(),e.closest(".toggle").classList.add("hidden!"),e.closest(".box-module").querySelector(".action-loading").classList.remove("hidden"),axios.post(e.dataset.url).then(n=>{e.closest(".toggle").classList.remove("hidden!"),e.closest(".box-module").querySelector(".action-loading").classList.add("hidden"),n.data.success&&(n.data.status?e.closest(".box-module").classList.add("module-enabled"):e.closest(".box-module").classList.remove("module-enabled"),window.showToast(n.data.toast))})})},sr=()=>{document.querySelectorAll(".public-permission").forEach(t=>{t.addEventListener("click",or)})},or=e=>{e.preventDefault();let t=e.currentTarget;t.querySelector(".module-icon").classList.add("hidden"),t.querySelector(".loading-animation").classList.remove("hidden"),axios.post(t.dataset.url).then(n=>{t.querySelector(".module-icon").classList.remove("hidden"),t.querySelector(".loading-animation").classList.add("hidden"),n.data.success&&(n.data.status?t.classList.add("enabled"):t.classList.remove("enabled"),window.showToast(n.data.toast))})},ar=()=>{document.querySelectorAll(".codemirror").forEach(function(t){CodeMirror.fromTextArea(document.getElementById(t.id),{extraKeys:{"Ctrl-Space":"autocomplete"},lineNumbers:!0,lineWrapping:!0,theme:"dracula"})})},ir=()=>{let e=[].slice.call(document.querySelectorAll(".nested-sortable"));for(let t=0;t<e.length;t++)new ft(e[t],{group:"nested",handle:".dnd-handle",animation:150,fallbackOnBody:!0,swapThreshold:.65,onMove:function(n,r){let s=n.dragged,d=n.related.parentNode.closest(".fixed-position")!=null;return!(s.classList.contains("fixed-position")&&d)}})},lr=()=>{const e=document.querySelector("form#campaign-style");e&&e.addEventListener("submit",function(t){let n=document.querySelector(e.dataset.error);return document.querySelector('textarea[name="content"]').value.length<e.dataset.maxContent?(n.classList.add("hidden"),!0):(n.classList.remove("hidden"),t.preventDefault(),!1)})},cr=()=>{const e=document.querySelector('input[name="vanity"]');e&&e.addEventListener("focusout",function(t){let n=this.value,r=document.getElementById("vanity-error"),s=document.getElementById("vanity-success"),a=document.getElementById("vanity-loading");if(r.innerHTML="",r.classList.add("hidden"),s.classList.add("hidden"),!n)return;s.classList.remove("hidden");let d={};d.vanity=n,axios.post(this.dataset.url,d).then(c=>{e.value=c.data.vanity,s.querySelector("code").innerHTML=c.data.vanity,r.classList.add("hidden"),a.classList.add("hidden"),s.classList.remove("hidden")}).catch(c=>{let u="";c.response.data.errors.vanity.forEach(m=>u+=m+" "),r.innerHTML=u,r.classList.remove("hidden"),s.classList.add("hidden"),a.classList.add("hidden")})})},dr=()=>{document.querySelectorAll(".permission-toggle").forEach(t=>{t.addEventListener("click",function(n){n.preventDefault();let r=this.dataset.action,s=document.querySelectorAll('input[data-action="'+r+'"]'),a=this.dataset.checked!=="1";this.dataset.checked=a?1:0,s.forEach(d=>{a?d.checked=!0:d.checked=!1})})})};nr();ar();ir();sr();lr();cr();dr();const Rt=()=>{document.querySelectorAll("[data-clipboard]").forEach(t=>{t.addEventListener("click",ur,!1)})};function ur(e){e.preventDefault(),mr(this.dataset.clipboard,this);let t=this.dataset.toast;return t&&window.showToast(t),!1}async function mr(e,t){if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(e);else{const n=document.createElement("textarea");n.value=e,n.style.position="absolute",n.style.left="-999999px",t.append(n),n.select();try{document.execCommand("copy")}catch(r){console.error(r)}finally{n.remove()}}}Rt();window.onEvent(function(){Rt()});const Ft=()=>{document.querySelectorAll('.toast-container [data-toggle="dismiss"]').forEach(t=>{t.dataset.init!=="1"&&(t.dataset.init="1",t.addEventListener("click",function(n){n.preventDefault();let r=t.closest(".toast-message");r.classList.remove("opacity-100"),r.classList.add("opacity-0"),setTimeout(function(){r.remove()},150)}))})};window.showToast=function(e,t){t=t||"bg-success text-success-content",t==="error"&&(t="bg-error text-error-content");const n=document.createElement("div");n.classList.add("opacity-100","duration-150","transition-opacity","rounded"),t&&t.split(" ").forEach(s=>{n.classList.add(s)}),n.innerHTML='<div class="toast-message p-2 flex gap-2 items-center"><span class="grow"> '+e+'</span><span class="flex-none"><i class="fa-regular fa-circle-xmark cursor-pointer " data-toggle="dismiss"></i></span></div>',document.querySelector(".toast-container").appendChild(n),setTimeout(function(){n.classList.remove("opacity-100"),n.classList.add("opacity-0"),setTimeout(function(){n.remove()},150)},3e3),Ft()};Ft();const fr=()=>{document.querySelectorAll(".banner-notification-dismiss").forEach(e=>{e.addEventListener("click",hr,!1)}),document.querySelectorAll('[data-dismiss="tutorial"]').forEach(e=>{e.addEventListener("click",gr,!1)})};function hr(e){e.preventDefault();let t=this.dataset.dismiss;axios.post(this.dataset.url).then(()=>{if(!t)return;let n=document.querySelector(t);n&&n.classList.add("hidden")})}function gr(e){e.preventDefault();let t=this.dataset.target,n=e.currentTarget;n.classList.add("loading"),n.disabled=!0,n.querySelector("i")?.remove(),axios.post(this.dataset.url).then(()=>{if(!t)return;let r=document.querySelector(t);r&&r.classList.add("hidden")})}fr();let Nt;const pr=()=>{const e=document.getElementById("element-era-id");e&&(Nt=e.value,e.addEventListener("change",function(){vr(e.value)}))},vr=e=>{e=parseInt(e);let t=document.querySelector('input[name="era-data-url"]').dataset.url.replace("/0/","/"+e+"/"),n=document.querySelector('input[name="oldPosition"]').dataset.url;axios.get(t).then(r=>{let s=document.querySelector('select[name="position"]');s.innerHTML="";let a=1;Object.entries(r.data.positions).forEach(function(c,u){const m=document.createElement("option");m.text=c[1],n&&!u&&Nt==e&&(m.value=1,s.appendChild(m)),u&&(m.value=a,s.appendChild(m)),a++})})};pr();window.initSortable=function(){let e=document.querySelectorAll(".sortable-elements");e.length!==0&&e.forEach(t=>{let n={},r=t.dataset.handle;r&&(n.handle=r),ft.create(t,n)})};window.initSortable();window.formErrorHandler=function(e,t){document.querySelectorAll(".input-error").forEach(f=>{f.classList.remove("input-error")});const r=document.querySelector(".text-error");r&&r.remove();const s=t.querySelector(".btn-primary");if(s&&(s.disabled=!1,s.classList.remove("loading")),e.status===503){window.showToast(e.data.message,"error");return}if(e.status===403){document.querySelector("#entity-form-403-error").classList.remove("hidden");return}if(!e.data.errors){window.showToast("Backend error","error");return}const a=e.data.errors;let d=[];const c=Object.keys(a);let u=!0;c.forEach(function(f){let w=document.querySelector('[name="'+f+'"]');if(w){w.classList.add("input-error");const g=document.createElement("div");g.classList.add("text-error"),g.innerHTML=a[f][0],w.parentNode.append(g)}else u=!1,d.push(a[f][0]);window.showToast(a[f][0],"error")});const m=document.querySelector("#entity-form-generic-error .error-logs");!u&&m&&(m.innerHTML="",d.forEach(function(f){m.append(f)}),document.querySelector("#entity-form-generic-error").classList.remove("hidden")),yr(t,a)};const yr=(e,t)=>{const n=Object.keys(t)[0],r=e.querySelector('[name="'+n+'"]');if(!r)return;if(!e.querySelector(".tab-content")){ct(r);return}document.querySelector(".tab-content .active").classList.remove("active"),document.querySelector(".nav-tabs li.active").classList.remove("active");const s=document.querySelector('[name="'+n+'"').closest(".tab-pane");s&&(s.classList.add("active"),document.querySelector('a[href="#'+s.id+'"]').closest("li").classList.add("active")),ct(r)},ct=e=>{e.focus(),e.scrollIntoView({behavior:"smooth"})},we="recent_colors",dt=10;function wr(){return document.cookie.split(";").reduce((e,t)=>{const[n,r]=t.split("=").map(s=>s.trim());return n&&r&&(e[n]=decodeURIComponent(r)),e},{})}function xr(e,t,n=30){const r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3),document.cookie=`${e}=${encodeURIComponent(t)}; expires=${r.toUTCString()}; path=/`}function br(e){ie({swatches:e})}function Qt(){const e=wr();let t=e[we]?JSON.parse(e[we]):[];ie.init(),ie({el:".spectrum",format:"hex",alpha:!1,theme:"pill",clearButton:!0,closeButton:!0,swatches:t}),document.querySelectorAll(".spectrum").forEach(n=>{n.dataset.init!=="1"&&(n.dataset.init=1,n.addEventListener("click",function(r){ie({parent:n.dataset.appendTo??".container"})}),n.addEventListener("change",function(r){const s=event.target.value;t=[s,...t.filter(a=>a!==s)],t.length>dt&&(t=t.slice(0,dt)),xr(we,JSON.stringify(t)),br(t)}),n.addEventListener("close",r=>{r.stopPropagation()}))})}window.onEvent(function(){Qt()});Qt();const kr={class:""},Lr=["data-title"],_r={class:"sr-only"},Sr=I({__name:"NavToggler",props:{text:{},title:{}},setup(e){const t=e,n=()=>{const a=document.querySelector("body");a.classList.contains("sidebar-collapse")?(a.classList.remove("sidebar-collapse"),r(!1)):(a.classList.add("sidebar-collapse"),r(!0))},r=a=>{let d=new Date;d.setTime(d.getTime()+90*24*60*60*1e3);let u=" expires="+d.toGMTString(),m=location.protocol==="https:"?"secure; ":"";document.cookie="toggleState="+(a?"collapsed":"open")+"; path=/; "+m+"samesite=lax; "+u},s=()=>{let d=new RegExp("toggleState=([^;]+)").exec(document.cookie);(d!=null?decodeURI(d[1]):null)==="collapsed"&&document.querySelector("body").classList.add("sidebar-collapse")};return Te(()=>{s()}),(a,d)=>(i(),l("div",kr,[o("span",{role:"button",class:"sidebar-toggle text-center cursor-pointer fill-current hover:text-primary-focus","data-toggle":"tooltip","data-title":t.title,"data-placement":"right","data-html":"true",tabindex:"",onClick:d[0]||(d[0]=c=>n())},[d[1]||(d[1]=o("svg",{class:"h-6 w-6 transition-all duration-150 hover:rotate-45","data-sidebar":"collapse",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 50 50"},[o("path",{d:"M 7.71875 6.28125 L 6.28125 7.71875 L 23.5625 25 L 6.28125 42.28125 L 7.71875 43.71875 L 25 26.4375 L 42.28125 43.71875 L 43.71875 42.28125 L 26.4375 25 L 43.71875 7.71875 L 42.28125 6.28125 L 25 23.5625 Z"})],-1)),d[2]||(d[2]=o("svg",{class:"h-6 w-6 transition-all duration-150 hover:rotate-90","data-sidebar":"expand",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",viewBox:"0 0 50 50"},[o("path",{d:"M 0 9 L 0 11 L 50 11 L 50 9 Z M 0 24 L 0 26 L 50 26 L 50 24 Z M 0 39 L 0 41 L 50 41 L 50 39 Z"})],-1)),o("span",_r,h(t.text),1)],8,Lr)]))}}),qr=["data-id","href"],Er={class:"flex-none"},Tr=["title"],Cr=["title","innerHTML"],Mr=["innerHTML"],zt=I({__name:"LookupEntity",props:{entity:{}},emits:["preview"],setup(e,{emit:t}){const n=t,r=e,s=c=>"url('"+c.image+"')",a=c=>{c.stopPropagation(),c.preventDefault(),n("preview",r.entity)},d=()=>"flex justify-center gap-1 cursor-pointer hover:bg-base-200 rounded w-full focus:bg-base-200";return(c,u)=>(i(),l("a",{class:_(d()),"data-id":e.entity.id,href:e.entity.link},[o("div",Er,[o("div",{style:F({backgroundImage:s(e.entity)}),title:e.entity.name,class:"rounded cover-background block h-16 w-16"},null,12,Tr)]),o("div",{class:"grow truncate pl-1 text-base-content",onClick:a},[o("div",{class:"font-extrabold entity-name truncate",title:e.entity.name,innerHTML:e.entity.name},null,8,Cr),o("div",{class:"entity-type text-xs",innerHTML:e.entity.type},null,8,Mr)])],10,qr))}}),Ar=["href"],$r={class:"grow truncate"},Dr=["title","innerHTML"],jr=I({__name:"LookupPage",props:{page:{}},setup(e){const t=()=>"flex justify-center gap-2 cursor-pointer w-full text-link";return(n,r)=>(i(),l("a",{class:_(t()),href:e.page.url,tabindex:"0"},[r[0]||(r[0]=o("div",{class:"flex-none h-4 w-4"},[o("i",{class:"fa-solid fa-angles-right","aria-hidden":"true"})],-1)),o("div",$r,[o("div",{class:"entity-name truncate",title:e.page.name,innerHTML:e.page.name},null,8,Dr)])],10,Ar))}}),Hr={class:"entity-header p-3 bg-entity-focus"},Ir={class:"w-full flex items-center"},Pr=["href","title","innerHTML"],Br={key:0,class:"fa-regular fa-skull mx-2","aria-hidden":"true"},Rr=["href"],Fr=["innerHTML"],Nr={key:1,class:"my-1 w-full flex flex-wrap gap-1"},Qr=["href","data-tag-id","data-tag-slug","innerHTML"],zr=["href","data-tag"],Or={key:3,class:"flex gap-1 items-center my-2"},Ur=["href","data-tag"],Kr=["href","title"],Vr={class:"entity-sections"},Gr={class:"tabs flex my-2 justify-center items-center border-solid border-slate-600 border-b-2 border-r-0 border-t-0 border-l-0"},Wr={key:0,class:"tab-profile p-5 flex flex-col gap-5"},Zr={key:0,class:"entity-pinned-attributes flex flex-col gap-3"},Yr=["data-attribute","data-target"],Jr=["innerHTML"],Xr=["innerHTML"],es={key:1},ts={class:"flex flex-col gap-3"},ns=["innerHTML"],rs=["innerHTML"],ss={key:1,class:"tab-links p-3"},os={key:0,class:"text-center italic"},as=I({__name:"EntityPreview",props:{entity:{}},setup(e){const t=e,n=x(!0),r=x(!1),s=x(!1),a=()=>t.entity.title,d=w=>{let g="inline-block rounded-xl px-3 py-1 bg-base-100 text-base-content text-xs";return w.colour&&(g+=" bg-"+w.colour,w.colour==="black"&&(g+=" text-white")),g},c=()=>"url('"+t.entity.image+"')",u=w=>{let g="p-1 px-1 mx-1 pt-2 select-none text-center truncate border-b-2 border-solid border-r-0 border-t-0 border-l-0";return w==="profile"&&n.value||w==="links"&&r.value||w==="access"&&s.value?g+=" font-black border-slate-600":g+=" cursor-pointer border-base-100",g},m=w=>{n.value=!1,r.value=!1,s.value=!1,w==="profile"?n.value=!0:w==="links"?r.value=!0:w==="access"&&(s.value=!0)},f=w=>"entity-profile-"+w.slug;return(w,g)=>(i(),l(S,null,[o("div",Hr,[o("div",Ir,[o("a",{class:"text-2xl font-extrabold entity-name",href:e.entity.link,title:e.entity.name,innerHTML:e.entity.name},null,8,Pr),e.entity.is_dead?(i(),l("i",Br)):v("",!0),o("a",{class:"ml-2 text-xs",target:"_blank",href:e.entity.link},[...g[3]||(g[3]=[o("i",{class:"fa-regular fa-external-link","aria-hidden":"true","aria-label":"Open in a new window"},null,-1)])],8,Rr)]),a()?(i(),l("div",{key:0,class:"block w-full",innerHTML:e.entity.title},null,8,Fr)):v("",!0),e.entity.tags.length>0?(i(),l("div",Nr,[(i(!0),l(S,null,C(e.entity.tags,k=>(i(),l("a",{class:_(d(k)),href:k.link,"data-tag-id":k.id,"data-tag-slug":k.slug,innerHTML:k.name},null,10,Qr))),256))])):v("",!0),e.entity.location?(i(),l("a",{key:2,class:"block w-full cursor-pointer my-2",href:e.entity.location.link,"data-tag":e.entity.id},[g[4]||(g[4]=o("i",{class:"fa-duotone circle-location-arrow","aria-hidden":"true","aria-label":"Location"},null,-1)),A(" "+h(e.entity.location.name),1)],8,zr)):e.entity.locations?(i(),l("div",Or,[(i(!0),l(S,null,C(e.entity.locations,k=>(i(),l("a",{class:"cursor-pointer",href:k.link,"data-tag":k.id},[g[5]||(g[5]=o("i",{class:"fa-duotone circle-location-arrow","aria-hidden":"true","aria-label":"Location"},null,-1)),A(" "+h(k.name),1)],8,Ur))),256))])):v("",!0),e.entity.image?(i(),l("a",{key:4,href:e.entity.link,style:F({backgroundImage:c()}),title:e.entity.name,class:"rounded cover-background block w-full aspect-square"},null,12,Kr)):v("",!0)]),o("div",Vr,[o("div",Gr,[o("div",{class:_(u("profile")),onClick:g[0]||(g[0]=k=>m("profile"))},h(e.entity.texts.profile),3),o("div",{class:_(u("links")),onClick:g[1]||(g[1]=k=>m("links"))},h(e.entity.texts.connections),3),o("div",{class:_(u("access")),onClick:g[2]||(g[2]=k=>m("access"))},null,2)]),n.value?(i(),l("div",Wr,[e.entity.attributes.length>0?(i(),l("div",Zr,[(i(!0),l(S,null,C(e.entity.attributes,k=>(i(),l("div",{class:"","data-attribute":k.name,"data-target":k.id},[o("span",{class:"inline-block uppercase font-extrabold mr-1",innerHTML:k.name},null,8,Jr),o("span",{innerHTML:k.value},null,8,Xr)],8,Yr))),256))])):v("",!0),e.entity.attributes.length>0?(i(),l("hr",es)):v("",!0),o("div",ts,[(i(!0),l(S,null,C(e.entity.profile,k=>(i(),l("div",{class:_(["",f(k)])},[o("div",{class:"uppercase font-extrabold truncate",innerHTML:k.field},null,8,ns),o("div",{innerHTML:k.value},null,8,rs)],2))),256))])])):v("",!0),r.value?(i(),l("div",ss,[(i(!0),l(S,null,C(e.entity.connections,k=>(i(),B(zt,{entity:k},null,8,["entity"]))),256)),e.entity.connections.length===0?(i(),l("p",os,h(e.entity.texts["no-connections"]),1)):v("",!0)])):v("",!0)])],64))}}),is={directives:{clickOutside:pt.directive},props:{api_lookup:String,api_recent:String,placeholder:String,keyboard_tooltip:String},components:{LookupEntity:zt,EntityPreview:as,LookupPage:jr},data(){return{has_drawer:!1,term:null,show_loading:!1,show_recent:!1,show_preview:!1,show_results:!1,show_bookmarks:!1,recent:[],bookmarks:[],indexes:[],results:[],pages:[],cached:{},cachedPages:{},has_recent:!1,texts:{},timeout_id:null,preview_entity:null}},watch:{term(e,t){this.termChanged()}},methods:{termChanged(){this.term.trim().length<3||(this.timeout_id!==void 0&&clearTimeout(this.timeout_id),this.show_loading=!0,this.timeout_id=setTimeout(()=>this.lookup(),500))},lookup(){let e=this.term.trim(),t=e.toLowerCase().replace(/ /g,"-").replace(/ [^\w-]+/g,"");if(this.cached[t])return this.displayCached(t);fetch(this.api_lookup+"?"+new URLSearchParams({q:e,v2:!0})).then(n=>n.json()).then(n=>this.parseLookupResponse(n,t))},focus(){this.api_recent&&(this.show_preview=!1,this.has_drawer=!0,this.fetch())},escape(){this.timeout_id!==void 0&&clearTimeout(this.timeout_id),this.close()},fetch(){if(this.has_recent){this.show_recent=!0;return}this.show_loading=!0,fetch(this.api_recent).then(e=>e.json()).then(e=>{this.recent=e.recent,this.bookmarks=e.bookmarks,this.indexes=e.indexes,this.texts.recents=e.texts.recents,this.texts.results=e.texts.results,this.texts.hint=e.texts.hint,this.texts.bookmarks=e.texts.bookmarks,this.texts.index=e.texts.index,this.texts.keyboard=e.texts.keyboard,this.texts.empty_results=e.texts.empty_results,this.texts.fulltext=e.texts.fulltext,this.texts.fulltext_route=e.fulltext_route,this.show_loading=!1,this.show_recent=!0,this.has_recent=!0,this.show_bookmarks=this.bookmarks.length>0}).catch(e=>{this.show_loading=!1,this.show_recent=!0,this.has_recent=!1})},parseLookupResponse(e,t){this.results=e.entities,this.pages=e.pages,this.cached[t]=e.entities,this.cachedPages[t]=e.pages,this.showResults()},displayCached(e){this.results=this.cached[e],this.pages=this.cachedPages[e],this.showResults()},showResults(){this.timeout_id=null,this.show_preview=!1,this.show_loading=!1,this.show_results=!0},loadPreview(e){this.show_loading=!0,fetch(e.preview).then(t=>t.json()).then(t=>this.parsePreviewResponse(t))},parsePreviewResponse(e){this.preview_entity=e,this.show_loading=!1,this.show_preview=!0,this.show_recent=!1},onClickOutside(e){this.close()},close(){this.show_recent=!1,this.show_loading=!1,this.show_preview=!1,this.$refs.searchField.blur()},showBookmarks(){this.show_bookmarks=!0},searchFullTextUrl(){return`${this.texts.fulltext_route}?term=${this.term}`},showIndexes(){this.show_bookmarks=!1},modeClass(e){return e&&this.show_bookmarks||!e&&!this.show_bookmarks?" underline":""}}},ls={class:"flex grow mr-2"},cs={class:"relative grow field flex items-center"},ds=["placeholder"],us={class:"absolute right-1 hidden md:inline"},ms=["data-title"],fs={key:0,class:"search-drawer absolute top-0 left-0 mt-12 h-sidebar w-sidebar bg-navbar bg-base-100 shadow-r overflow-y-auto",tabindex:"-1"},hs={key:0,class:"text-center"},gs={key:1,class:"search-recent bg-lookup p-2 min-h-full shadow-r flex flex-col items-stretch"},ps={key:0,class:"flex-none"},vs={class:"italic text-xs text-center"},ys={class:"grow flex flex-col gap-5 p-2"},ws={key:0,class:"search-results flex flex-col gap-2"},xs={class:"text-sm uppercase"},bs={key:0,class:"text-neutral-content text-sm"},ks={key:1,class:"flex flex-col gap-2"},Ls=["href"],_s={key:1,class:"recent-searches flex flex-col gap-2"},Ss={class:"text-sm uppercase"},qs={key:2,class:"flex gap-5 justify-center"},Es={key:3,class:"flex flex-col gap-4"},Ts=["href","title"],Cs=["innerHTML"],Ms={key:4,class:"flex flex-col gap-4"},As=["href","title"],$s=["innerHTML"],Ds={key:1,class:"flex-none text-xs text-center"},js=["innerHTML"],Hs={key:2,class:"search-preview bg-lookup min-h-full shadow-r"};function Is(e,t,n,r,s,a){const d=pe("LookupEntity"),c=pe("LookupPage"),u=pe("EntityPreview"),m=ht("click-outside");return te((i(),l("div",ls,[o("div",cs,[te(o("input",{type:"text",class:"leading-4 w-20 md:w-full",maxlength:"25",ref:"searchField",id:"entity-lookup","onUpdate:modelValue":t[0]||(t[0]=f=>s.term=f),onClick:t[1]||(t[1]=f=>a.focus()),onFocus:t[2]||(t[2]=f=>a.focus()),onKeydown:t[3]||(t[3]=ge(f=>a.escape(),["esc"])),placeholder:n.placeholder},null,40,ds),[[ke,s.term]]),o("span",us,[o("span",{class:"flex-none keyboard-shortcut py-1",id:"lookup-kb-shortcut","data-toggle":"tooltip","data-title":n.keyboard_tooltip,"data-html":"true","data-placement":"bottom"}," K ",8,ms)])]),s.show_recent||s.show_loading||s.show_preview?(i(),l("aside",fs,[s.show_loading?(i(),l("div",hs,[...t[10]||(t[10]=[o("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true","aria-label":"Loading"},null,-1)])])):v("",!0),s.show_recent?(i(),l("div",gs,[s.show_results?v("",!0):(i(),l("div",ps,[o("p",vs,h(s.texts.hint),1)])),o("div",ys,[s.show_results?(i(),l("div",ws,[o("div",xs,h(s.texts.results),1),s.results.length===0&&s.pages.length===0?(i(),l("div",bs,h(s.texts.empty_results),1)):(i(),l("div",ks,[(i(!0),l(S,null,C(s.results,f=>(i(),B(d,{entity:f,onKeydown:t[4]||(t[4]=ge(w=>a.escape(),["esc"])),onPreview:a.loadPreview},null,8,["entity","onPreview"]))),256)),(i(!0),l(S,null,C(s.pages,f=>(i(),B(c,{page:f},null,8,["page"]))),256))])),o("a",{class:"grow text-sm uppercase hover:underline text-link",href:a.searchFullTextUrl()},h(s.texts.fulltext),9,Ls)])):v("",!0),s.recent.length>0?(i(),l("div",_s,[o("div",Ss,h(s.texts.recents),1),(i(!0),l(S,null,C(s.recent,f=>(i(),B(d,{entity:f,onPreview:a.loadPreview,onKeydown:t[5]||(t[5]=ge(w=>a.escape(),["esc"]))},null,8,["entity","onPreview"]))),256))])):v("",!0),s.bookmarks.length>0?(i(),l("div",qs,[s.bookmarks.length>0?(i(),l("button",{key:0,class:_(["grow text-sm uppercase hover:underline",this.modeClass(!0)]),onClick:t[6]||(t[6]=f=>a.showBookmarks())},h(s.texts.bookmarks),3)):v("",!0),o("button",{class:_(["grow text-sm uppercase hover:underline",this.modeClass(!1)]),onClick:t[7]||(t[7]=f=>a.showIndexes())},h(s.texts.index),3)])):v("",!0),s.show_bookmarks?(i(),l("div",Es,[(i(!0),l(S,null,C(s.bookmarks,f=>(i(),l("a",{href:f.url,onClick:t[8]||(t[8]=Re(()=>{},["stop"])),title:f.text,class:"flex gap-2 items-center text-link"},[o("i",{class:_(["w-4",f.icon]),"aria-hidden":"true"},null,2),o("span",{innerHTML:f.text},null,8,Cs)],8,Ts))),256))])):(i(),l("div",Ms,[(i(!0),l(S,null,C(s.indexes,f=>(i(),l("a",{href:f.url,onClick:t[9]||(t[9]=Re(()=>{},["stop"])),title:f.name,class:"flex gap-2 items-center text-link"},[o("i",{class:_(["w-4 text-center",f.icon]),"aria-hidden":"true"},null,2),o("span",{innerHTML:f.name},null,8,$s)],8,As))),256))]))]),s.show_loading?v("",!0):(i(),l("div",Ds,[t[11]||(t[11]=o("hr",null,null,-1)),o("p",{class:"italic text-xs text-center",innerHTML:s.texts.keyboard},null,8,js)]))])):v("",!0),s.show_preview?(i(),l("div",Hs,[ee(u,{entity:s.preview_entity},null,8,["entity"])])):v("",!0)])):v("",!0)])),[[m,a.onClickOutside]])}const Ps=tn(is,[["render",Is]]),Bs=["href","title"],Rs={key:0,class:"absolute top-2 right-2 text-sm text-boost"},Fs=["innerHTML"],ut=I({__name:"Campaign",props:{campaign:{}},setup(e){const t=e,n=()=>t.campaign.image?"url("+t.campaign.image+")":"",r=()=>"campaign flex items-end border border-solid rounded-lg cover-background relative h-24 overflow-hidden text-break shadow-xs hover:shadow-md border-0";return(s,a)=>(i(),l("a",{class:_(r()),href:e.campaign.url,style:F({backgroundImage:n()}),title:e.campaign.name},[e.campaign.is_boosted?(i(),l("div",Rs,[...a[0]||(a[0]=[o("i",{class:"fa-regular fa-gem","aria-label":"Premium campaign"},null,-1)])])):v("",!0),o("div",{class:"flex items-end justify-center name w-full text-xs p-2 pt-6 text-center",innerHTML:e.campaign.name},null,8,Fs)],14,Bs))}}),Ns=["data-id"],Qs={class:"flex-none p-2"},zs=["innerHTML","href"],Os=["title"],Us={key:1,class:"flex-none p-2"},Ks=["data-id"],Vs={class:"flex-none p-2"},Gs=["innerHTML"],Ws=["title"],Zs={key:1,class:"flex-none p-2"},Ys=I({__name:"Notification",props:{notification:{}},emits:["read"],setup(e,{emit:t}){const n=t,r=x(!1),s=x(!1),a=u=>{let m="notification bg-base-200 flex justify-center items-center p-2 rounded-md";return u.is_read?m:m+" unread"},d=u=>{let m="fa-regular fa-"+u.icon;return u.colour==="red"&&(m+=" text-red"),m},c=u=>{s.value=!0,axios.post(u.dismiss).then(()=>{r.value=!0,n("read",u)})};return(u,m)=>e.notification.url&&!r.value?(i(),l("div",{key:0,class:_(a(e.notification)),"data-id":e.notification.id},[o("div",Qs,[o("i",{class:_(d(e.notification)),"aria-hidden":"true"},null,2)]),o("a",{class:"grow p-2 break-all text-link",innerHTML:e.notification.text,href:e.notification.url},null,8,zs),s.value?(i(),l("div",Us,[...m[3]||(m[3]=[o("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true"},null,-1)])])):(i(),l("div",{key:0,class:"flex-none p-2 cursor-pointer dismissable",onClick:m[0]||(m[0]=f=>c(e.notification)),title:e.notification.dismiss_text},[...m[2]||(m[2]=[o("i",{class:"fa-solid fa-times","aria-hidden":"true"},null,-1)])],8,Os))],10,Ns)):r.value?v("",!0):(i(),l("div",{key:1,class:_(a(e.notification)),"data-id":e.notification.id},[o("div",Vs,[o("i",{class:_(d(e.notification)),"aria-hidden":"true"},null,2)]),o("div",{class:"grow p-2",innerHTML:e.notification.text},null,8,Gs),s.value?(i(),l("div",Zs,[...m[5]||(m[5]=[o("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true"},null,-1)])])):(i(),l("div",{key:0,class:"flex-none p-2 cursor-pointer dismissable",onClick:m[1]||(m[1]=f=>c(e.notification)),title:e.notification.dismiss_text},[...m[4]||(m[4]=[o("i",{class:"fa-regular fa-times","aria-hidden":"true"},null,-1)])],8,Ws))],10,Ks))}}),Js=["data-id"],Xs={class:"grow p-2"},eo=["innerHTML","href"],to=["innerHTML"],no=["title"],ro={key:1,class:"flex-none p-2"},so=I({__name:"Release",props:{release:{}},emits:["read"],setup(e,{emit:t}){const n=t,r=x(!1),s=x(!1),a=c=>"release bg-base-200 flex justify-center items-center p-2  rounded-md",d=c=>{s.value=!0,axios.post(c.dismiss).then(()=>{r.value=!0,n("read",c)})};return(c,u)=>r.value?v("",!0):(i(),l("div",{key:0,class:_(a(e.release)),"data-id":e.release.id},[o("div",Xs,[o("a",{innerHTML:e.release.title,class:"font-bold cursor-pointer block w-full text-link",href:e.release.url,target:"_blank"},null,8,eo),o("p",{innerHTML:e.release.text},null,8,to)]),s.value?(i(),l("div",ro,[...u[2]||(u[2]=[o("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true"},null,-1)])])):(i(),l("div",{key:0,class:"flex-none p-2 cursor-pointer dismissable",onClick:u[0]||(u[0]=m=>d(e.release)),title:e.release.dismiss_text},[...u[1]||(u[1]=[o("i",{class:"fa-solid fa-times","aria-hidden":"true"},null,-1)])],8,no))],10,Js))}}),xe={__name:"GridSvg",props:{size:Number},setup(e){const t=e;function n(){return"w-"+t.size+" h-"+t.size}return(r,s)=>(i(),l("svg",{class:_(n()),viewBox:"0 -0.5 21 21",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","aria-hidden":"true"},[...s[0]||(s[0]=[o("g",{stroke:"none","stroke-width":"1",fill:"none","fill-rule":"evenodd"},[o("g",{transform:"translate(-219.000000, -200.000000)",fill:"currentcolor"},[o("g",{id:"icons",transform:"translate(56.000000, 160.000000)"},[o("path",{d:"M181.9,54 L179.8,54 C178.63975,54 177.7,54.895 177.7,56 L177.7,58 C177.7,59.105 178.63975,60 179.8,60 L181.9,60 C183.06025,60 184,59.105 184,58 L184,56 C184,54.895 183.06025,54 181.9,54 M174.55,54 L172.45,54 C171.28975,54 170.35,54.895 170.35,56 L170.35,58 C170.35,59.105 171.28975,60 172.45,60 L174.55,60 C175.71025,60 176.65,59.105 176.65,58 L176.65,56 C176.65,54.895 175.71025,54 174.55,54 M167.2,54 L165.1,54 C163.93975,54 163,54.895 163,56 L163,58 C163,59.105 163.93975,60 165.1,60 L167.2,60 C168.36025,60 169.3,59.105 169.3,58 L169.3,56 C169.3,54.895 168.36025,54 167.2,54 M181.9,47 L179.8,47 C178.63975,47 177.7,47.895 177.7,49 L177.7,51 C177.7,52.105 178.63975,53 179.8,53 L181.9,53 C183.06025,53 184,52.105 184,51 L184,49 C184,47.895 183.06025,47 181.9,47 M174.55,47 L172.45,47 C171.28975,47 170.35,47.895 170.35,49 L170.35,51 C170.35,52.105 171.28975,53 172.45,53 L174.55,53 C175.71025,53 176.65,52.105 176.65,51 L176.65,49 C176.65,47.895 175.71025,47 174.55,47 M167.2,47 L165.1,47 C163.93975,47 163,47.895 163,49 L163,51 C163,52.105 163.93975,53 165.1,53 L167.2,53 C168.36025,53 169.3,52.105 169.3,51 L169.3,49 C169.3,47.895 168.36025,47 167.2,47 M181.9,40 L179.8,40 C178.63975,40 177.7,40.895 177.7,42 L177.7,44 C177.7,45.105 178.63975,46 179.8,46 L181.9,46 C183.06025,46 184,45.105 184,44 L184,42 C184,40.895 183.06025,40 181.9,40 M174.55,40 L172.45,40 C171.28975,40 170.35,40.895 170.35,42 L170.35,44 C170.35,45.105 171.28975,46 172.45,46 L174.55,46 C175.71025,46 176.65,45.105 176.65,44 L176.65,42 C176.65,40.895 175.71025,40 174.55,40 M169.3,42 L169.3,44 C169.3,45.105 168.36025,46 167.2,46 L165.1,46 C163.93975,46 163,45.105 163,44 L163,42 C163,40.895 163.93975,40 165.1,40 L167.2,40 C168.36025,40 169.3,40.895 169.3,42"})])])],-1)])],2))}},oo={class:"nav-switcher flex items-center justify-center align-middle h-12 gap-2"},ao={class:"indicator relative inline-flex w-max"},io={key:0,class:"notification-badge left-auto top-auto w-fit inline-flex absolute content-center items-center z-10"},lo={key:1,class:"profile-box rounded-lg p-2 text-center font-bold"},co={key:0,class:"navigation-drawer bg-base-100 h-full overflow-y-auto fixed top-0 right-0 rounded-l-2xl shadow-lg"},uo={key:0,class:"temporary p-8 text-center"},mo={key:1,class:""},fo={class:"header flex"},ho={key:0,class:"full flex items-center gap-4"},go={class:"flex-none"},po={class:"grow"},vo={class:"font-bold"},yo=["title"],wo={key:0,class:"full flex items-center gap-4"},xo={key:0,class:"flex-none profile-box rounded-lg p-2 text-center uppercase font-bold"},bo={class:"grow"},ko={class:"font-bold"},Lo=["title"],_o={key:0,class:"flex-none profile-box rounded-lg p-2 text-center uppercase font-bold"},So={key:0,class:"profile p-5 flex flex-col gap-5"},qo={key:0,class:"notifications"},Eo={class:"flex w-full py-2"},To={class:"grow uppercase font-bold"},Co={class:"grow text-right"},Mo=["href"],Ao={class:"flex flex-col gap-2"},$o={key:0,class:"no-notifications help-block text-neutral-content italic"},Do={key:1,class:"releases"},jo={class:"flex w-full py-2"},Ho={class:"grow uppercase font-bold"},Io={class:"flex flex-col gap-2"},Po={key:2,class:"marketplace"},Bo={class:"flex w-full py-2"},Ro={class:"grow uppercase font-bold"},Fo={class:"grow text-right"},No=["href"],Qo={class:"grid grid-cols-3 gap-2"},zo=["href"],Oo={class:"text-muted text-xs"},Uo=["href"],Ko={class:"text-muted text-xs"},Vo=["href"],Go={class:"text-muted text-xs"},Wo={key:3,class:"subscription"},Zo={class:"uppercase font-bold py-2"},Yo=["href"],Jo={class:"flex-none p-2"},Xo=["src","alt"],ea={class:"grow p-2"},ta={class:"font-bold text-lg"},na={key:0,class:"more"},ra={key:1,class:"more"},sa={class:"link flex gap-1 items-center"},oa={key:0,class:"fa-duotone fa-credit-card","aria-hidden":"true"},aa={key:1,class:"fa-regular fa-credit-card","aria-hidden":"true"},ia={key:4,class:"m-0 p-0 list-none flex flex-col gap-2"},la=["href"],ca=["href"],da=["href"],ua={key:5,class:"m-0 p-0 list-none flex flex-col gap-2"},ma=["href"],fa={key:1,class:"campaigns p-5"},ha={key:0,class:"campaigns flex flex-col gap-5"},ga={class:"flex flex-col gap-2"},pa={class:"flex w-full"},va={class:"grow uppercase font-bold"},ya={key:0,class:"grow text-right"},wa=["href"],xa={class:"grid grid-cols-2 md:grid-cols-3 gap-5"},ba=["href"],ka={class:"text-xs text-break uppercase"},La={key:0},_a={class:"flex flex-col gap-2"},Sa={key:0,class:"uppercase"},qa={key:1,class:"grid grid-cols-2 md:grid-cols-3 gap-5 following"},Ea=["href"],Ta={class:"text-xs uppercase text-break"},Ca=I({__name:"NavSwitcher",props:{user_id:{},api:{},fetch:{},initials:{},avatar:{},campaign_id:{},has_alerts:{}},setup(e){const t=e,n=x(!1),r=x(!1),s=x(!1),a=x(!1),d=x(!1),c=x({}),u=x({}),m=x({}),f=x({}),w=x({}),g=x(!1),k=x(!1),z=x(!1),P=()=>{a.value=!0,d.value=!1,G()},O=()=>{d.value=!0,a.value=!1,G()},G=()=>{r.value=!0,!s.value&&(n.value=!0,axios.get(t.api).then(L=>{c.value=L.data.profile,u.value=L.data.campaigns,m.value=L.data.notifications,f.value=L.data.marketplace,w.value=L.data.releases,g.value=L.data.has_unread,s.value=!0,n.value=!1,k.value=!0,z.value=L.data.fontawesome_pro}))},M=L=>L?"block p-4 grow items-center focus:box-shadow":"block p-4  items-center bg-base-200 cursor-pointer flex-none focus:box-shadow",W=()=>{document.getElementById("logout-form").submit()},se=L=>{r.value=!1},ue=L=>{let p=w.value.releases.findIndex(H=>H.id===L.id);w.value.releases.slice(p,1),U()},me=L=>{let p=m.value.messages.findIndex(H=>H.id==L.id);m.value.messages.slice(p,1),U()},U=()=>{m.value.messages.length===0&&w.value.releases.length===0&&(g.value=!1)},Z=()=>{let L=localStorage.getItem("last_notification-"+t.user_id),H=new Date().getTime()-60*5e3;if(!L||L<H)fe();else if(g.value=localStorage.getItem("notification-has-alerts-"+t.user_id)==="true",oe(),!k.value)return},fe=()=>{let L=new Date().getTime();localStorage.setItem("last_notification-"+t.user_id,L),axios.get(t.fetch).then(p=>{localStorage.setItem("notification-has-alerts-"+t.user_id,p.data.has_alerts),Z()})},oe=()=>{setTimeout(function(){Z()},t.alert_delta)},K=()=>t.avatar.startsWith("/images/"),Y=()=>"url("+t.avatar+")";return Te(()=>{g.value=t.has_alerts,oe()}),(L,p)=>{const H=ht("click-outside");return i(),l(S,null,[o("div",oo,[o("div",{class:"campaigns inline cursor-pointer text-center text-2xl hover:text-primary-focus",onClick:p[0]||(p[0]=E=>P()),"aria-label":"Switch campaigns",tabindex:"0",role:"button"},[ee(xe,{size:7}),p[5]||(p[5]=o("span",{class:"sr-only"},"Campaigns",-1))]),o("div",{class:"profile flex items-center cursor-pointer text-center uppercase",onClick:p[1]||(p[1]=E=>O()),"aria-label":"Profile settings",tabindex:"0",role:"button"},[o("div",ao,[g.value?(i(),l("span",io)):v("",!0),K()?(i(),l("div",lo,h(e.initials),1)):(i(),l("div",{key:2,class:"w-9 h-9 rounded-lg cover-background",style:F({backgroundImage:Y()})},null,4))])])]),r.value?te((i(),l("div",co,[n.value?(i(),l("div",uo,[...p[6]||(p[6]=[o("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true"},null,-1)])])):(i(),l("div",mo,[o("div",fo,[o("div",{class:_(M(a.value)),onClick:p[2]||(p[2]=E=>P()),tabindex:"0",role:"button","aria-label":"Campaign list"},[a.value?(i(),l("div",ho,[o("div",go,[ee(xe,{size:6})]),o("div",po,[o("div",vo,h(u.value.texts.campaigns),1),o("div",null,h(u.value.texts.count),1)])])):(i(),l("div",{key:1,class:"flex items-center justify-center h-full",title:u.value.texts.campaigns},[ee(xe,{size:6})],8,yo))],2),o("div",{class:_(M(d.value)),onClick:p[3]||(p[3]=E=>O()),tabindex:"0",role:"button","aria-label":"Profile pane"},[d.value?(i(),l("div",wo,[K()?(i(),l("div",xo,h(e.initials),1)):(i(),l("div",{key:1,class:"flex-none w-9 h-9 rounded-lg cover-background",style:F({backgroundImage:Y()})},null,4)),o("div",bo,[o("div",ko,h(c.value.name),1),o("div",null,h(c.value.created),1)])])):(i(),l("div",{key:1,class:"",title:c.value.your_profile},[K()?(i(),l("div",_o,h(e.initials),1)):(i(),l("div",{key:1,class:"flex-none w-9 h-9 rounded-lg cover-background",style:F({backgroundImage:Y()})},null,4))],8,Lo))],2)]),d.value?(i(),l("div",So,[m.value.title?(i(),l("div",qo,[o("div",Eo,[o("div",To,h(m.value.title),1),o("div",Co,[o("a",{href:m.value.all.url,class:"text-link"},h(m.value.all.text),9,Mo)])]),o("div",Ao,[(i(!0),l(S,null,C(m.value.messages,E=>(i(),B(Ys,{notification:E,onRead:me},null,8,["notification"]))),256))]),m.value.messages.length===0?(i(),l("div",$o,h(m.value.none),1)):v("",!0)])):v("",!0),w.value.title&&w.value.releases.length>0?(i(),l("div",Do,[o("div",jo,[o("div",Ho,h(w.value.title),1)]),o("div",Io,[(i(!0),l(S,null,C(w.value.releases,E=>(i(),B(so,{release:E,onRead:ue},null,8,["release"]))),256))])])):v("",!0),!c.value.is_impersonating&&f.value.title?(i(),l("div",Po,[o("div",Bo,[o("div",Ro,h(f.value.title),1),o("div",Fo,[o("a",{href:f.value.explore.url,class:"text-link"},h(f.value.explore.text),9,No)])]),o("div",Qo,[o("a",{href:f.value.themes.url,class:"border py-2 items-center justify-center rounded-md hover:shadow-md flex flex-col gap-1 border-base-300 text-link"},[p[7]||(p[7]=o("div",{class:"icon bg-base-200 rounded-full w-14 h-14 text-3xl aspect-square flex justify-center items-center"},[o("i",{class:"fa-duotone fa-palette","aria-hidden":"true"})],-1)),o("div",null,h(f.value.themes.title),1),o("div",Oo,h(f.value.themes.number),1)],8,zo),o("a",{href:f.value.sheets.url,class:"border py-2 items-center justify-center rounded-md hover:shadow-md flex flex-col gap-1 border-base-300 text-link"},[p[8]||(p[8]=o("div",{class:"icon bg-base-200 rounded-full w-14 h-14 text-3xl aspect-square flex justify-center items-center"},[o("i",{class:"fa-duotone fa-table-cells","aria-hidden":"true"})],-1)),o("div",null,h(f.value.sheets.title),1),o("div",Ko,h(f.value.sheets.number),1)],8,Uo),o("a",{href:f.value.content.url,class:"border py-2 items-center justify-center rounded-md hover:shadow-md flex flex-col gap-1 border-base-300 text-link"},[p[9]||(p[9]=o("div",{class:"icon bg-base-200 rounded-full w-14 h-14 text-3xl aspect-square flex justify-center items-center"},[o("i",{class:"fa-duotone fa-dice-d20","aria-hidden":"true"})],-1)),o("div",null,h(f.value.content.title),1),o("div",Go,h(f.value.content.number),1)],8,Vo)])])):v("",!0),!c.value.is_impersonating&&c.value.subscription?(i(),l("div",Wo,[o("div",Zo,h(c.value.subscription.title),1),o("a",{class:"border rounded-lg flex justify-center items-center hover:shadow-md border-base-300 text-link",href:c.value.urls.subscription},[o("div",Jo,[o("img",{class:"w-16 h-16",src:c.value.subscription.image,alt:c.value.subscription.tier},null,8,Xo)]),o("div",ea,[o("div",ta,h(c.value.subscription.tier),1),c.value.subscription.tier!=="Kobold"?(i(),l("div",na,[A(h(c.value.subscription.created),1),p[10]||(p[10]=o("br",null,null,-1)),A(" "+h(c.value.subscription.boosters),1)])):(i(),l("div",ra,[A(h(c.value.subscription.call_to_action)+" ",1),o("div",sa,[A(h(c.value.subscription.call_to_action_2)+" ",1),z.value?(i(),l("i",oa)):(i(),l("i",aa)),p[11]||(p[11]=o("i",{class:"fa-brands fa-paypal","aria-hidden":"true"},null,-1))])]))])],8,Yo)])):v("",!0),c.value.is_impersonating?(i(),l("ul",ua,[o("li",null,[o("a",{href:c.value.return.url,class:"text-link"},[p[16]||(p[16]=o("i",{class:"fa-regular fa-sign-out-alt mr-3","aria-hidden":"true"},null,-1)),A(" "+h(c.value.return.name),1)],8,ma)])])):(i(),l("ul",ia,[o("li",null,[o("a",{href:c.value.urls.settings.url,class:"p-2 block text-link"},[p[12]||(p[12]=o("i",{class:"fa-regular fa-cog mr-3","aria-hidden":"true"},null,-1)),A(" "+h(c.value.urls.settings.name),1)],8,la)]),o("li",null,[o("a",{href:c.value.urls.profile.url,class:"p-2 block text-link"},[p[13]||(p[13]=o("i",{class:"fa-regular fa-user mr-3","aria-hidden":"true"},null,-1)),A(" "+h(c.value.urls.profile.name),1)],8,ca)]),o("li",null,[o("a",{href:c.value.urls.help.url,class:"p-2 block text-link",target:"_blank"},[p[14]||(p[14]=o("i",{class:"fa-regular fa-question-circle mr-3","aria-hidden":"true"},null,-1)),A(" "+h(c.value.urls.help.name),1)],8,da)]),o("li",null,[o("a",{href:"#",onClick:p[4]||(p[4]=E=>W()),class:"p-2 block text-link"},[p[15]||(p[15]=o("i",{class:"fa-regular fa-sign-out mr-3","aria-hidden":"true"},null,-1)),A(" "+h(c.value.urls.logout.name),1)])])]))])):(i(),l("div",fa,[c.value.is_impersonating?v("",!0):(i(),l("div",ha,[o("div",ga,[o("div",pa,[o("div",va,h(u.value.texts.campaigns),1),u.value.member.length>0?(i(),l("div",ya,[o("a",{href:u.value.urls.reorder,class:"text-link"},h(u.value.texts.reorder),9,wa)])):v("",!0)]),o("div",xa,[(i(!0),l(S,null,C(u.value.member,E=>(i(),B(ut,{campaign:E},null,8,["campaign"]))),256)),o("a",{href:u.value.urls.new,class:"new-campaign flex items-center text-center border-dashed border rounded-lg h-24 p-2 overflow-hidden text-link"},[o("span",ka,[p[17]||(p[17]=o("i",{class:"fa-regular fa-plus","aria-hidden":"true",style:{display:"none"}},null,-1)),A(" "+h(u.value.texts.new),1)])],8,ba)])]),c.value.is_impersonating?v("",!0):(i(),l("hr",La)),o("div",_a,[c.value.is_impersonating?v("",!0):(i(),l("p",Sa,h(u.value.texts.followed),1)),c.value.is_impersonating?v("",!0):(i(),l("div",qa,[(i(!0),l(S,null,C(u.value.following,E=>(i(),B(ut,{campaign:E},null,8,["campaign"]))),256)),o("a",{href:u.value.urls.follow,class:"new-campaign flex items-center text-center border-dashed border rounded-lg h-24 p-2 overflow-hidden text-link"},[o("span",Ta,h(u.value.texts.follow),1)],8,Ea)]))])]))]))]))])),[[H,se]]):v("",!0)],64)}}}),re=gt({});re.component("nav-toggler",Sr);re.component("nav-search",Ps);re.component("nav-switcher",Ca);re.use(pt);re.mount("header");const Ma={key:0},Aa=["innerHTML"],$a={key:1,class:"flex items-center gap-1"},Da=["accept"],ja={key:2,class:"flex items-center gap-1"},Ha=["placeholder"],Ia={key:0,class:"fa-solid fa-spin fa-spinner","aria-label":"Downloading"},Pa={key:3,class:"flex items-center gap-1"},Ba=["innerHTML"],Ra={key:0,class:"flex gap-2 flex-col w-full"},Fa={class:"progress h-1 w-full"},Na=["innerHTML"],Qa=["innerHTML"],za=["name"],Oa={key:2,type:"hidden",name:"remove-image",value:"1"},Ua={class:"flex gap-6 items-center p-4 md:p-6 justify-between"},Ka=["innerHTML"],Va={class:"max-w-4xl flex flex-col gap-2 text-left p-4 md:px-6"},Ga={class:"flex flex-col gap-1 w-full"},Wa=["innerHTML"],Za=["innerHTML"],Ya={key:0,class:"p-4 md:px-6"},Ja={class:""},Xa=["href"],ei=["innerHTML"],ti=I({__name:"Selection",props:{file:{},url:{},accepts:{},uuid:{},thumbnail:{},browse:{},field:{},old:{},i18n:{},cta:{},premium:{}},setup(e){const t=e,n=x(!0),r=x(!1),s=x(!1),a=x(),d=x(),c=x(),u=x(),m=x(),f=x(!1),w=x(0),g=x(null);let k;const z=x(null),P=x(!1),O=x(!1),G=x(!1),M=x(null),W=x(),se=x();Te(()=>{n.value=!1,u.value=t.thumbnail,m.value=t.uuid,t.old==="true"&&(P.value=!0),t.premium==="true"&&(O.value=!0),M.value=JSON.parse(t.i18n)});const ue=()=>{let y="relative flex items-end align-middle rounded overflow-hidden bg-no-repeat ";return Z()?y+=" cover-background preview-bg w-48 h-36 p-2 ":y+="w-full",y},me=()=>s.value?"hidden":"flex gap-2 flex-col w-full",U=()=>P.value||m.value!==null&&m.value!=="",Z=()=>g.value||P.value?!0:m.value!==null&&m.value!=="",fe=()=>{m.value=null,u.value=null,P.value&&(P.value=!1,G.value=!0)},oe=()=>g.value?"url('"+g.value+"')":u.value?"url('"+u.value+"')":"",K=()=>w.value+"%",Y=()=>{f.value=!0},L=y=>{a.value=y.clipboardData.getData("text"),p()},p=()=>{!a.value||a.value==k||(k=a.value,r.value=!0,d.value.disabled=!0,axios.post(t.url,{url:a.value}).then(y=>{d.value.disabled=!1,r.value=!1,a.value=null,u.value=y.data.thumbnail,m.value=y.data.uuid}).catch(y=>{d.value.disabled=!1,r.value=!1,d.value.focus(),E(y)}))},H=async y=>{const b=y.target.files[0];if(!b){s.value=!1;return}const q=new FileReader;q.onload=j=>{g.value=j.target.result},q.readAsDataURL(b),s.value=!0,document.addEventListener("keydown",he),z.value=axios.CancelToken.source(),c.value.disabled=!0;const Be=new FormData;Be.append("file",b),axios.post(t.file,Be,{headers:{"Content-Type":"multipart/form-data"},cancelToken:z.value.token,onUploadProgress:function(j){w.value=Math.round(j.loaded*100/j.total)}}).then(j=>{s.value=!1,c.value.disabled=!1,c.value=null,u.value=j.data.thumbnail,m.value=j.data.uuid,g.value=null,document.removeEventListener("keydown",he)}).catch(j=>{s.value=!1,c.value.disabled=!1,g.value=null,axios.isCancel(j)?c.value=null:E(j),document.removeEventListener("keydown",he)})},E=y=>{if(!y.response)return;if(y.response.data.error){window.showToast(y.response.data.error,"error");return}if(y.response&&y.response.status===403&&y.response.data.message){window.showToast(M.value.unauthorized,"error");return}Object.keys(y.response.data.errors).forEach(q=>{if(y.response.data.errors[q][0].includes("(storage_full)")){se.value=y.response.data.errors[q][0].replace("(storage_full)",""),en(W.value);return}window.showToast(y.response.data.errors[q][0],"error")})},Jt=y=>{m.value=y.uuid,u.value=y.thumbnail},Xt=()=>{f.value=!1},he=y=>{y.key==="Escape"&&s.value&&He()},He=y=>{z.value.cancel("Upload canceled by user.")},en=y=>{y.showModal(),y.addEventListener("click",Pe)},Ie=y=>{y.removeEventListener("click",Pe),y.close()},Pe=y=>{let b=y.target.getBoundingClientRect();!(b.top<=y.clientY&&y.clientY<=b.top+b.height&&b.left<=y.clientX&&y.clientX<=b.left+b.width)&&y.target.tagName==="DIALOG"&&Ie(y.target)};return(y,b)=>(i(),l(S,null,[n.value?(i(),l("div",Ma,[...b[7]||(b[7]=[o("i",{class:"fa-solid fa-spin fa-spinner2","aria-label":"Loading"},null,-1)])])):(i(),l("div",{key:1,class:_(ue()),style:F({backgroundImage:oe()})},[o("div",{class:_(me())},[Z()?(i(),l("div",{key:0,class:"rounded p-2 cursor-pointer backdrop-blur-sm backdrop-opacity-30 bg-red-700/50 text-white hover:backdrop-opacity-100 transition",onClick:b[0]||(b[0]=q=>fe()),innerHTML:M.value.remove},null,8,Aa)):v("",!0),U()?v("",!0):(i(),l("div",$a,[o("input",{type:"file",accept:t.accepts,class:"w-full",onChange:H,ref_key:"fileField",ref:c},null,40,Da)])),U()?v("",!0):(i(),l("div",ja,[te(o("input",{ref_key:"urlField",ref:d,type:"text",class:"w-full","onUpdate:modelValue":b[1]||(b[1]=q=>a.value=q),onBlur:b[2]||(b[2]=q=>p()),onPaste:L,placeholder:M.value.url},null,40,Ha),[[ke,a.value]]),r.value?(i(),l("i",Ia)):v("",!0)])),U()?v("",!0):(i(),l("div",Pa,[o("span",{role:"button",class:"btn2 btn-default btn-sm",onClick:b[3]||(b[3]=q=>Y()),innerHTML:M.value.gallery},null,8,Ba)]))],2),s.value?(i(),l("div",Ra,[o("div",Fa,[o("div",{class:"h-1 bg-accent shadow-xs",role:"progressbar","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100",style:F({width:K()})},[...b[8]||(b[8]=[o("span",{class:"sr-only"},null,-1)])],4)]),o("div",{class:"rounded p-2 cursor-pointer backdrop-blur-sm backdrop-opacity-30 bg-red-700/50 text-white hover:backdrop-opacity-100 transition flex items-center gap-2",onClick:b[4]||(b[4]=q=>He())},[o("span",{class:"grow",innerHTML:M.value.cancel},null,8,Na),o("span",{class:"text-xs flex-none",innerHTML:K()},null,8,Qa)])])):v("",!0)],6)),te(o("input",{type:"hidden",name:t.field,"onUpdate:modelValue":b[5]||(b[5]=q=>m.value=q)},null,8,za),[[ke,m.value]]),G.value?(i(),l("input",Oa)):v("",!0),ee(nn,{api:t.browse,opened:f.value,i18n:e.i18n,onSelected:Jt,onClosed:Xt},null,8,["api","opened","i18n"]),n.value?v("",!0):(i(),l("dialog",{key:3,ref_key:"cta",ref:W,class:"dialog rounded-2xl text-center"},[o("header",Ua,[o("h4",{innerHTML:M.value.cta_title,class:"text-lg font-normal"},null,8,Ka),o("button",{type:"button",class:"text-base-content",onClick:b[6]||(b[6]=q=>Ie(W.value)),title:"Close"},[...b[9]||(b[9]=[o("i",{class:"fa-regular fa-circle-xmark","aria-hidden":"true"},null,-1),o("span",{class:"sr-only"},"Close",-1)])])]),o("article",Va,[o("div",Ga,[o("p",{innerHTML:se.value},null,8,Wa),O.value?v("",!0):(i(),l("p",{key:0,innerHTML:M.value.cta_helper},null,8,Za))])]),O.value?v("",!0):(i(),l("footer",Ya,[o("menu",Ja,[o("a",{href:t.cta,class:"btn2 btn-primary"},[b[10]||(b[10]=o("i",{class:"fa-regular fa-gem","aria-hidden":"true"},null,-1)),o("span",{innerHTML:M.value.cta_action},null,8,ei)],8,Xa)])]))],512))],64))}}),Ot=()=>{document.querySelectorAll(".gallery-selection").forEach(t=>{if(t.dataset.init==="1")return;t.dataset.init="1";const n=gt({});n.component("gallery-selection",ti),n.mount(t)})};Ot();window.onEvent(function(){Ot()});const be=Array(),Ut=()=>{document.querySelectorAll('[data-toggle="tooltip-ajax"]').forEach(t=>{t._tippy||de(t,{theme:"entity-tooltip",placement:t.dataset.direction??"bottom",allowHTML:!0,interactive:!0,delay:500,appendTo:t.dataset.append??document.body,content:'<i class="fa-solid fa-spin fa-spinner" aria-hidden="true" aria-label="loading..." />',arrow:!0,onShow(n){let r=t.dataset.id;if(r&&r in be){n.setContent(be[r]);return}fetch(t.dataset.url).then(s=>s.json()).then(s=>{n.setContent(s[0]),be[r]=s[0]}).catch(s=>{n.setContent(`Failed loading tooltip. ${s}`)})}})})},Kt=()=>{let e=document.querySelectorAll('[data-toggle="tooltip"]');e.forEach(t=>{mt(t)}),e=document.querySelectorAll("[data-tooltip]"),e.forEach(t=>{mt(t)})},mt=e=>{e._tippy||de(e,{content:e.dataset.title??e.title,theme:"kanka",delay:250,placement:e.dataset.direction??"bottom",allowHTML:e.dataset.html??!1,appendTo:e.dataset.append??document.body,arrow:!0})},Vt=()=>{document.querySelectorAll("[data-dropdown]").forEach(t=>{if(t._tippy)return;let n=t.parentNode.querySelectorAll(".dropdown-menu")[0];de(t,{content:'<div class="dd-menu flex flex-col max-w-2xl">'+n.innerHTML+"</div>",theme:"kanka-dropdown",placement:t.dataset.direction??"bottom",zIndex:890,allowHTML:!0,arrow:!0,interactive:!0,trigger:"click",onShown(r){window.triggerEvent()}})})},ni=(e,t)=>{de(e,t).show()};Kt();Ut();Vt();window.initTooltips=Kt;window.ajaxTooltip=Ut;window.showTooltip=ni;window.initDropdowns=Vt;const Gt=()=>{document.querySelectorAll('form[data-maintenance="1"]').forEach(function(t){t.addEventListener("submit",ri)})},ri=e=>{window.entityFormHasUnsavedChanges=!1,e.preventDefault();const t=e.target;si(t);let n=new FormData(t);axios.post(t.getAttribute("action"),n).then(()=>{t.submit()}).catch(r=>{r.response&&window.formErrorHandler(r.response,t),oi(t)})},si=e=>{e.querySelectorAll(".btn-primary").forEach((n,r)=>{r===0&&n.classList.add("loading"),n.classList.add("btn-disabled")})},oi=e=>{e.querySelectorAll(".btn-primary").forEach(n=>{n.classList.remove("btn-disabled","loading")})};Gt();window.onEvent(function(){Gt()});window.onEvent(function(){window.initForeignSelect(),window.initTags(),window.initDialogs(),window.initTooltips(),window.ajaxTooltip(),window.initDropdowns(),window.initSortable(),je(),Zt(),Wt(),Yt(),ci()});function ai(){let e=document.getElementById("ad-client");e&&fetch(e.src,{method:"HEAD",mode:"no-cors"}).catch(()=>{document.getElementById("adblock-plea")?.classList.remove("hidden")})}const ii=()=>{document.querySelectorAll(".nav-tabs li a")?.forEach(function(t){t.addEventListener("click",function(n){n.preventDefault();const r=t.closest(".nav-tabs-custom");r.querySelector(".nav-tabs li.active")?.classList.remove("active"),r.querySelector(".tab-pane.active")?.classList.remove("active"),t.parentElement.classList.add("active"),document.querySelector(t.getAttribute("href"))?.classList.add("active")})})},Wt=()=>{document.querySelectorAll('[data-img="delete"]')?.forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),document.querySelector("input[name="+e.dataset.target+"]").value=1,e.closest(".preview").classList.add("hidden")})})},je=()=>{document.querySelectorAll(".pagination-ajax-links a").forEach(function(e){e.dataset.loaded!=="1"&&(e.dataset.loaded="1",e.addEventListener("click",function(t){t.preventDefault();const n=document.querySelector(".pagination-ajax-body");n.querySelector(".modal-loading").classList.remove("hidden"),n.querySelector(".pagination-ajax-content").classList.add("hidden"),fetch(e.getAttribute("href")).then(r=>r.text()).then(r=>{n.parentNode.innerHTML=r,je(),window.triggerEvent()})}))})},Zt=()=>{document.querySelectorAll('[data-toggle="confirm-delete"]')?.forEach(function(e){e.dataset.loaded!=="1"&&(e.dataset.loaded="1",e.addEventListener("click",function(t){if(t.preventDefault(),e.dataset.confirming==="1"){e.classList.add("loading"),e.innerHTML="";const r=document.querySelector(e.dataset.target);r?r.requestSubmit():console.error("Unknown target",r);return}const n=e.innerHTML;e.dataset.confirming="1",e.querySelector("span").classList.add("md:inline"),e.querySelector("span").innerHTML=e.dataset.confirm,e.addEventListener("blur",function(){e.dataset.confirming="0",e.innerHTML=n},{once:!0})}))}),document.querySelectorAll('a[data-toggle="delete-form"]')?.forEach(function(e){e.dataset.loaded!=="1"&&(e.dataset.loaded="1",e.addEventListener("click",function(t){t.preventDefault(),document.querySelector(e.dataset.target).requestSubmit()}))})},li=()=>{document.querySelector(".submenu-switcher")?.addEventListener("change",function(e){e.preventDefault();const t=e.target,n=t.options[t.selectedIndex];window.location.href=n.dataset.route})},Yt=()=>{document.querySelectorAll("[data-dismisses]").forEach(t=>{t.addEventListener("click",function(n){n.preventDefault();let r=document.querySelector(this.dataset.dismisses);r.classList.remove("opacity-100"),r.classList.add("opacity-0"),r.addEventListener("transitionend",()=>{r.remove()},{once:!0})})})},ci=()=>{const e=document.querySelector(".btn-manage-perm");e&&e.addEventListener("click",function(t){t.preventDefault(),window.closeDialog("primary-dialog");let n=e.dataset.target;document.querySelector(n).click()})};window.initForeignSelect();window.initDialogs();li();ii();je();Zt();Wt();Yt();ai();

import{d as j,K as z,D as S,a,c as s,b as t,f as g,e as v,F as N,r as $,n as F,h as o}from"./vendor-tiptap-DFhGOnJZ.js";const V={class:"flex gap-6 items-center p-4 md:p-6 justify-between"},E=["innerHTML"],O={class:"max-w-4xl p-4"},X={key:0,class:"flex gap-1 w-full"},Y={class:"grow"},A=["placeholder"],G=["title"],J=["title"],K={key:1,class:"md:h-36 md:w-80 text-center flex items-center justify-center w-full"},R=["onClick"],q=["title"],P=["innerHTML"],Q=["innerHTML"],U=300,ee=j({__name:"Browser",props:{api:{},opened:{type:Boolean},i18n:{}},emits:["selected","closed"],setup(C,{emit:L}){const r=C,i=o(null);z(()=>{r.i18n&&typeof r.i18n=="string"?i.value=JSON.parse(r.i18n):i.value=r.i18n});const x=L,u=o(!0),m=o(!1),f=o(),p=o([]),h=o(""),w=o(""),b=o(null),d=o(null),c=o("large"),T=()=>{u.value=!0,f.value.showModal(),f.value.addEventListener("click",function(e){let l=this.getBoundingClientRect();!(l.top<=e.clientY&&e.clientY<=l.top+l.height&&l.left<=e.clientX&&e.clientX<=l.left+l.width)&&e.target.tagName==="DIALOG"&&y()}),axios.get(r.api).then(e=>{p.value=e.data.images,u.value=!1}).catch(e=>{u.value=!1,e.response.status===403&&(d.value=e.response.data.message,d.value+="<p>"+i.value.browse.unauthorized+"</p>")})},y=()=>{f.value.close(),x("closed")},k=e=>(e=e??"",c.value==="large"?"w-40 h-28 md:w-48 md:h-36 "+e:"w-20 h-16 "+e),B=e=>(e=e??"",c.value==="large"?"w-40 md:w-48 "+e:"w-20 text-xs "+e),M=()=>c.value==="small"?"flex flex-wrap justify-center gap-2 md:gap-3":"flex flex-wrap justify-center gap-2 md:gap-5",D=e=>{if(e.folder){u.value=!0,axios.get(e.url).then(l=>{p.value=l.data.images,u.value=!1});return}x("selected",e),y()};S(()=>r.opened,(e,l)=>{e&&T()});const I=e=>{h.value=e.target.value,b.value&&clearTimeout(b.value),b.value=setTimeout(()=>{H()},U)},H=()=>{w.value!=h.value&&(w.value=h.value,m.value=!0,axios.get(r.api+"?term="+w.value).then(e=>{p.value=e.data.images,m.value=!1}))},_=e=>{c.value=e};return(e,l)=>(a(),s("dialog",{class:"dialog rounded-2xl text-center bg-base-100 text-base-content",id:"gallery-dialog",ref_key:"galleryDialog",ref:f,"aria-modal":"true","aria-labelledby":"modal-card-label"},[t("header",V,[t("h4",{innerHTML:i.value.browse.title,class:"text-lg font-normal"},null,8,E),t("button",{type:"button",class:"text-base-content",onClick:l[0]||(l[0]=n=>y()),title:"Close"},[...l[3]||(l[3]=[t("i",{class:"fa-regular fa-circle-xmark","aria-hidden":"true"},null,-1),t("span",{class:"sr-only"},"Close",-1)])])]),t("article",O,[!u.value&&!d.value?(a(),s("div",X,[t("div",Y,[t("input",{type:"text",class:"w-full",placeholder:i.value.browse.search.placeholder,onInput:I},null,40,A)]),c.value!=="large"?(a(),s("div",{key:0,class:"flex-none cursor-pointer btn2 btn-ghost btn-sm",onClick:l[1]||(l[1]=n=>_("large")),title:i.value.browse.layouts.large},[...l[4]||(l[4]=[t("i",{class:"fa-regular fa-grid-2","aria-label":"Large previews"},null,-1)])],8,G)):g("",!0),c.value!=="small"?(a(),s("div",{key:1,class:"flex-none cursor-pointer btn2 btn-ghost btn-sm",onClick:l[2]||(l[2]=n=>_("small")),title:i.value.browse.layouts.small},[...l[5]||(l[5]=[t("i",{class:"fa-regular fa-grid-4","aria-label":"Small previews"},null,-1)])],8,J)):g("",!0)])):g("",!0),u.value||m.value?(a(),s("div",K,[...l[6]||(l[6]=[t("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"},null,-1)])])):(a(),s("div",{key:2,class:v(M())},[(a(!0),s(N,null,$(p.value,n=>(a(),s("div",{class:"cursor-pointer shadow-sm rounded hover:shadow-lg overflow-hidden",onClick:W=>D(n)},[n.folder?(a(),s("div",{key:1,class:v(k("flex items-center align-middle justify-center text-4xl"))},[t("i",{class:v(n.icon),"aria-label":"Folder"},null,2)],2)):(a(),s("div",{key:0,class:v(k("cover-background")),style:F({backgroundImage:"url('"+n.thumbnail+"')"})},null,6)),t("div",{class:v(B("truncate px-2 py-1 ")),title:n.name},[t("span",{innerHTML:n.name},null,8,P)],10,q)],8,R))),256)),d.value?(a(),s("div",{key:0,class:"alert alert-error p-2 rounded",innerHTML:d.value},null,8,Q)):g("",!0)],2))])],512))}});export{ee as _};

const l=document.getElementById("dialog-backdrop");let d;const u=()=>{document.querySelectorAll('[data-toggle="dialog"]').forEach(e=>{e.addEventListener("click",s)}),document.querySelectorAll('[data-toggle="dialog-ajax"]').forEach(e=>{e.addEventListener("click",s)})},r=new Event("dialog.loaded");function s(e){e.preventDefault();let n=this.dataset.target;if(!n)return;let o=this.dataset.url,t=this.dataset.focus;a(n,o,t)}const a=(e,n,o)=>{if(e=document.getElementById(e),e.removeAttribute("open"),e.setAttribute("aria-hidden",!1),e.show(),e.focus(),document.addEventListener("keydown",c),l.classList.remove("hidden"),e.dataset.dismissible!=="false"&&l.addEventListener("click",function(t){e.close()}),e.addEventListener("click",function(t){let i=e.getBoundingClientRect();!(i.top<=t.clientY&&t.clientY<=i.top+i.height&&i.left<=t.clientX&&t.clientX<=i.left+i.width)&&t.target.tagName==="DIALOG"&&e.close()}),e.addEventListener("close",function(t){l.classList.add("hidden"),e.setAttribute("aria-hidden",!0),document.removeEventListener("keydown",c)}),n)f(n,e);else if(o){let t=document.querySelector(o);if(!t)return;t.focus()}},c=e=>{if(e.key==="Escape"){const n=document.activeElement;if(["INPUT","SELECT","TEXTAREA"].includes(n.tagName)){document.activeElement.blur();return}const t=document.querySelector('dialog[aria-hidden="false"]');t||document.removeEventListener("keydown",c),t.close()}},f=(e,n)=>{d?n.innerHTML=d:d=n.innerHTML,fetch(e,{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(o=>o.text()).then(o=>{n.innerHTML=o,n.show(),typeof $=="function"?window.triggerEvent():document.dispatchEvent(r)})},m=e=>{document.getElementById(e).close()};window.initDialogs=u;window.openDialog=a;window.closeDialog=m;

let p,v,c,d,i,r,a,h,l,u;const y=document.getElementById("subscribe-confirm"),b=()=>{f(),I(),window.onEvent(function(){g()})},f=()=>{const e=document.getElementById("stripe-token");p=Stripe(e.value),v=p.elements()},g=()=>{var t;if(d=document.querySelector(".subscription-confirm-button"),document.getElementById("card-element")){if(!c){let s={base:{color:"#555555",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"14px","::placeholder":{color:"#777777"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}};c=v.create("card",{hidePostalCode:!0,style:s})}c.mount("#card-element")}(t=document.getElementById("subscription-confirm"))==null||t.addEventListener("submit",E),i=document.getElementById("coupon-check"),i&&(r=document.getElementById("coupon-success"),a=document.getElementById("coupon-invalid"),h=document.getElementById("coupon"),l=document.getElementById("coupon-validating"),u=document.querySelector(".paypal-coupon"),i.addEventListener("change",L),i.addEventListener("focusout",L));const n=document.querySelector('select[name="select-method"]');n&&n.addEventListener("change",S)},S=e=>{console.log("changing method to",e.target.value);const n=document.querySelector("#card-panel"),t=document.querySelector("#paypal-panel");e.target.value==="paypal"?(n.classList.add("hidden"),t.classList.remove("hidden")):(n.classList.remove("hidden"),t.classList.add("hidden"))},L=e=>{const n=e.target,t=n.value,s=n.dataset.url;t||(d.classList.remove("btn-disabled","loading"),d.disabled=!1),l.classList.remove("hidden"),fetch(s+"?coupon="+t).then(o=>o.json()).then(o=>{if(d.classList.remove("btn-disabled","loading"),d.disabled=!1,l.classList.add("hidden"),!o.valid){r.classList.add("hidden"),a.innerHTML=o.error,a.classList.remove("hidden"),h.value="",y.classList.remove("valid-coupon"),u.classList.add("hidden");return}document.getElementById("pricing-now").innerHTML=o.price,a.classList.add("hidden"),r.innerHTML=o.discount,r.classList.remove("hidden"),h.value=o.coupon,y.classList.add("valid-coupon"),u.classList.remove("hidden")}).catch(o=>{l.classList.add("hidden"),o.responseJSON&&(a.innerHTML=o.responseJSON.message,a.classList.remove("hidden")),u.classList.add("hidden")})},E=e=>{const n=e.target;e.preventDefault(),q(e);const t=document.querySelector('input[name="subscription-intent-token"]'),s=document.querySelector(".alert-error");s.classList.add("hidden");const o=document.querySelector('input[name="payment_id"]');if(o.value)return n.submit(),!1;p.confirmCardSetup(t.value,{payment_method:{card:c,billing_details:{name:document.querySelector('input[name="card-holder-name"]').value}}}).then((function(m){if(m.error)return d.classList.remove("disabled","loading"),d.disabled="",s.innerHTML=m.error.message,s.classList.remove("hidden"),!1;o.value=m.setupIntent.payment_method,n.submit()}).bind(void 0))},I=()=>{const e=document.getElementById("pricing-overview"),n=document.querySelector('[data-period="yearly"]'),t=document.querySelector('[data-period="monthly"]'),s=document.querySelectorAll("[data-period]");s==null||s.forEach(o=>{o.addEventListener("click",function(){this.dataset.period==="monthly"?(n.classList.remove("bg-base-100"),n.classList.add("text-neutral-content"),t.classList.add("bg-base-100"),t.classList.remove("text-neutral-content"),e.classList.remove("period-year"),e.classList.add("period-month")):this.dataset.period==="yearly"&&(t.classList.remove("bg-base-100"),t.classList.add("text-neutral-content"),n.classList.add("bg-base-100"),n.classList.remove("text-neutral-content"),e.classList.remove("period-month"),e.classList.add("period-year"))})})},q=e=>{const t=e.target.querySelector(".subscription-confirm-button");return t.classList.add("disabled","loading"),t.disabled=!0,!0};b();

import{c as a,b as s,t as o,f as m,g as u,w as g,z as h,a as r,q as x}from"./vendor-tiptap-BwkKWjOO.js";import{a as v}from"./index-D5GkNzM3.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";const w={props:{initialCampaignPublic:{type:Boolean,required:!0},initialEntityPrivate:{type:Boolean,required:!0},url:{type:String,required:!0},saveEndpoint:{type:String,required:!0},trans:{type:Object,required:!0}},data(){return{loading:!1,errorMessage:null,justMadeCampaignPublic:!1,isCampaignPublic:this.initialCampaignPublic,isEntityPrivate:this.initialEntityPrivate,form:{visibility_mode:"entity"}}},mounted(){window.triggerEvent?.()},computed:{isEntityPublic(){return this.isCampaignPublic&&!this.isEntityPrivate},clipboardToast(){return this.isEntityPublic?this.trans.success_copied_public:this.trans.success_copied_members},showSaveButton(){return this.isCampaignPublic?this.isEntityPrivate:!0}},methods:{async saveChanges(){this.loading=!0,this.errorMessage=null;try{let t={};this.isCampaignPublic?t.visibility_mode=this.form.visibility_mode:t.campaign_visibility="public";const e=await v.post(this.saveEndpoint,t);this.isCampaignPublic?this.isEntityPrivate=!1:(this.isCampaignPublic=!0,this.isEntityPrivate=!0,this.justMadeCampaignPublic=!0),window.showToast(this.trans.success_updated),this.$emit("updated",e.data)}catch(t){console.error(t),this.errorMessage=t.response?.data?.message||this.trans.error_generic}finally{this.loading=!1}},closeModal(){const t=this.$el.closest("dialog");t&&t.close()}}},k={class:"dialog rounded-2xl text-center bg-base-100 text-base-content overflow-hidden"},P={class:"flex gap-6 items-center p-4 md:p-6 justify-between border-b border-base-300"},C={class:"text-lg font-normal"},M=["title"],L={class:"sr-only"},D={class:"max-w-4xl flex flex-col gap-4 text-left p-4 md:px-6"},T={key:0,class:"alert alert-error text-sm rounded-xl"},S={key:1,class:"p-3 bg-info/10 border border-info/20 rounded-xl text-xs text-neutral-content leading-relaxed"},q={key:2},B={key:0,class:"flex flex-col gap-4"},A={class:"p-3 bg-warning/10 border border-warning/20 rounded-xl"},I={class:"text-sm text-warning font-bold mb-1 flex items-center"},j={class:"text-xs text-neutral-content leading-relaxed"},N={class:"flex flex-col gap-2"},H={class:"font-normal"},R={class:"flex flex-col gap-2"},V={class:"flex items-center gap-3 p-3 border border-base-300 rounded-xl cursor-pointer hover:bg-base-200 transition"},X={class:"text-sm"},U={class:"flex items-center gap-3 p-3 border border-base-300 rounded-xl cursor-pointer hover:bg-base-200 transition"},O={class:"text-sm"},Y={key:1,class:"p-4 bg-success/10 border border-success/20 rounded-xl"},z={class:"text-sm text-success font-bold mb-1 flex items-center"},G={class:"text-xs text-neutral-content"},K={key:3,class:"flex flex-col gap-4"},W={class:"p-3 bg-base-300/30 border border-base-300 rounded-xl"},F={class:"text-sm text-neutral-content font-bold mb-1 flex items-center"},J={class:"text-xs text-neutral-content"},Q={class:"p-3 bg-info/10 border border-info/20 rounded-xl text-xs text-neutral-content leading-relaxed"},Z={class:"flex flex-col gap-1 mt-2"},$={class:"font-normal"},ee={class:"flex items-center gap-2"},te=["value"],se=["data-clipboard","data-toast","title"],ie={class:"p-4 md:px-6 border-t border-base-300 mt-2"},ne={class:"flex justify-end gap-3"},oe=["disabled"],le={key:0,class:"loading loading-spinner loading-xs mr-2"};function ae(t,e,i,l,n,d){return r(),a("div",k,[s("header",P,[s("h4",C,o(i.trans.title),1),s("button",{type:"button",class:"text-base-content opacity-50 hover:opacity-100",title:i.trans.btn_close,onClick:e[0]||(e[0]=(...c)=>d.closeModal&&d.closeModal(...c))},[e[4]||(e[4]=s("i",{class:"fa-regular fa-circle-xmark","aria-hidden":"true"},null,-1)),s("span",L,o(i.trans.btn_close),1)],8,M)]),s("article",D,[n.errorMessage?(r(),a("div",T,[e[5]||(e[5]=s("i",{class:"fa-solid fa-circle-exclamation"},null,-1)),s("span",null,o(n.errorMessage),1)])):m("",!0),n.justMadeCampaignPublic?(r(),a("div",S,[e[6]||(e[6]=s("i",{class:"fa-solid fa-circle-info mr-1 text-info"},null,-1)),u(" "+o(i.trans.warning_entity_permissions),1)])):m("",!0),n.isCampaignPublic?(r(),a("div",q,[n.isEntityPrivate?(r(),a("div",B,[s("div",A,[s("div",I,[e[7]||(e[7]=s("i",{class:"fa-solid fa-eye-slash mr-2"},null,-1)),u(" "+o(i.trans.status_hidden),1)]),s("p",j,o(i.trans.helper_hidden),1)]),s("div",N,[s("label",H,o(i.trans.field_visibility_mode),1),s("div",R,[s("label",V,[g(s("input",{type:"radio",name:"visibility_mode",value:"entity",class:"radio radio-primary radio-sm","onUpdate:modelValue":e[1]||(e[1]=c=>n.form.visibility_mode=c)},null,512),[[h,n.form.visibility_mode]]),s("span",X,o(i.trans.option_entity_public),1)]),s("label",U,[g(s("input",{type:"radio",name:"visibility_mode",value:"global",class:"radio radio-primary radio-sm","onUpdate:modelValue":e[2]||(e[2]=c=>n.form.visibility_mode=c)},null,512),[[h,n.form.visibility_mode]]),s("span",O,o(i.trans.option_global_public),1)])])])])):(r(),a("div",Y,[s("div",z,[e[8]||(e[8]=s("i",{class:"fa-solid fa-globe mr-2"},null,-1)),u(" "+o(i.trans.status_public),1)]),s("p",G,o(i.trans.helper_public),1)]))])):(r(),a("div",K,[s("div",W,[s("div",F,[e[9]||(e[9]=s("i",{class:"fa-solid fa-lock mr-2"},null,-1)),u(" "+o(i.trans.status_private),1)]),s("p",J,o(i.trans.helper_private),1)]),s("div",Q,[e[10]||(e[10]=s("i",{class:"fa-solid fa-circle-info mr-1 text-info"},null,-1)),u(" "+o(i.trans.warning_entity_permissions),1)])])),s("div",Z,[s("label",$,o(d.isEntityPublic?i.trans.label_public_link:i.trans.label_member_link),1),s("div",ee,[s("input",{type:"text",class:"input input-bordered w-full text-sm font-mono bg-base-200",readonly:"",value:i.url},null,8,te),s("button",{class:"btn2 btn-sm btn-outline shrink-0","data-clipboard":i.url,"data-toast":d.clipboardToast,title:i.trans.btn_copy},[...e[11]||(e[11]=[s("i",{class:"fa-solid fa-copy"},null,-1)])],8,se)])])]),s("footer",ie,[s("menu",ne,[d.showSaveButton?(r(),a("button",{key:0,type:"submit",class:"btn2 btn-primary",disabled:n.loading,onClick:e[3]||(e[3]=(...c)=>d.saveChanges&&d.saveChanges(...c))},[n.loading?(r(),a("span",le)):m("",!0),u(" "+o(n.isCampaignPublic?i.trans.btn_save:i.trans.btn_make_public),1)],8,oe)):m("",!0)])])])}const re=E(w,[["render",ae]]);window.mountShareModal=function(){const t=document.getElementById("entity-share-container");if(t&&!t.__vue_app__){const e=x({});e.component("entity-share-modal",re),e.mount(t)}};const b=document.getElementById("dialog-backdrop");let f;const de=()=>{document.querySelectorAll('[data-toggle="dialog"]').forEach(t=>{t.addEventListener("click",p)}),document.querySelectorAll('[data-toggle="dialog-ajax"]').forEach(t=>{t.addEventListener("click",p)})};function p(t){t.preventDefault();let e=this.dataset.target??"primary-dialog",i=this.dataset.url??this.url,l=this.dataset.focus;y(e,i,l)}const y=(t,e,i)=>{if(t=document.getElementById(t),t.removeAttribute("open"),t.setAttribute("aria-hidden",!1),t.show(),document.addEventListener("keydown",_),b.classList.remove("hidden"),t.dataset.dismissible!=="false"&&b.addEventListener("click",function(){t.close()}),t.addEventListener("click",function(l){let n=t.getBoundingClientRect();!(n.top<=l.clientY&&l.clientY<=n.top+n.height&&n.left<=l.clientX&&l.clientX<=n.left+n.width)&&l.target.tagName==="DIALOG"&&t.close()}),t.addEventListener("close",function(){b.classList.add("hidden"),t.setAttribute("aria-hidden",!0),document.removeEventListener("keydown",_)}),e)ce(e,t);else if(i){let l=document.querySelector(i);if(!l)return;l.focus()}},_=t=>{if(t.key==="Escape"){const e=document.activeElement;if(["INPUT","SELECT","TEXTAREA"].includes(e.tagName)){document.activeElement.blur();return}const l=document.querySelector('dialog[aria-hidden="false"]');l||document.removeEventListener("keydown",_),l.close()}},ce=(t,e)=>{f?e.innerHTML=f:f=e.innerHTML,fetch(t,{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(i=>i.text()).then(i=>{e.innerHTML=i,e.show(),window.mountShareModal()}).catch(i=>{console.error(i),e.innerHTML="Error loading content."})},ue=t=>{document.getElementById(t).close()};window.initDialogs=de;window.openDialog=y;window.closeDialog=ue;

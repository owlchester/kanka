import{b as t,c as i,a as n,n as m,e as a,F as u,r as _,g as x,h as b,i as f,q as v}from"./vue.esm-bundler-35c332fe.js";import{_ as h}from"./_plugin-vue_export-helper-c27b6911.js";const k={props:["ability","permission","meta","trans"],data(){return{details:!1}},computed:{hasAttribute:function(){return this.ability.attributes.length>0},canDelete:function(){return this.permission},backgroundImage:function(){return this.ability.images.thumb?{backgroundImage:"url("+this.ability.images.thumb+")"}:{}}},methods:{updateAbility:function(s){window.openDialog("abilities-dialog",s.actions.edit)},remainingNumber:function(){return this.ability.charges-this.ability.used_charges},remainingText:function(){return this.ability.i18n.left.replace(/:amount/,"")},useCharge:function(s,l){l>s.used_charges?s.used_charges+=1:s.used_charges-=1,axios.post(s.actions.use,{used:s.used_charges}).then(e=>{e.data.success||(s.used_charges-=1)}).catch(()=>{s.used_charges-=1})}}},p=["data-tags"],T={class:"ability-box p-4 rounded bg-box shadow-xs flex flex-col md:flex-row items-center md:items-start gap-2 md:gap-4"},L={key:0,class:""},H=["href"],M={class:"flex flex-col gap-4 w-full"},w={class:"flex gap-2 md:gap-4 items-center w-full"},C={class:"flex gap-2 items-center text-xl grow"},A=["href","innerHTML"],I=["title"],B=["title"],N=["title"],j=["title"],D=["title"],z=["innerHTML"],F={key:1,class:""},V=["title"],q=["innerHTML"],E={key:0,class:"visible md:hidden"},P=["innerHTML"],S=["innerHTML"],G={key:2,class:"flex gap-2 items-center"},J=["href","innerHTML"],K=["innerHTML"],O={key:4,class:"flex gap-2 md:gap-4 ability-charges w-full items-end"},Q={class:"flex gap-1 flex-wrap grow"},R=["onClick"],U=["innerHTML"],W={class:"flex-none"},X=["innerHTML"],Y=["innerHTML"];function Z(s,l,e,g,d,r){return t(),i("div",{class:"ability","data-tags":e.ability.class},[n("div",T,[e.ability.images.has?(t(),i("div",L,[n("a",{class:"ability-image rounded-xl block w-40 h-40 cover-background",href:e.ability.images.url,style:m(r.backgroundImage)},null,12,H)])):a("",!0),n("div",M,[n("div",w,[n("div",C,[n("a",{href:e.ability.actions.view,class:"ability-name text-2xl",innerHTML:e.ability.name},null,8,A),e.ability.visibility_id===2?(t(),i("i",{key:0,class:"fa-solid fa-lock",title:e.ability.visibility},null,8,I)):a("",!0),e.ability.visibility_id===3?(t(),i("i",{key:1,class:"fa-solid fa-user-lock",title:e.ability.visibility},null,8,B)):a("",!0),e.ability.visibility_id===5?(t(),i("i",{key:2,class:"fa-solid fa-users",title:e.ability.visibility},null,8,N)):a("",!0),e.ability.visibility_id===4?(t(),i("i",{key:3,class:"fa-solid fa-user-secret",title:e.ability.visibility},null,8,j)):a("",!0),e.ability.visibility_id===1?(t(),i("i",{key:4,class:"fa-solid fa-eye",title:e.ability.visibility},null,8,D)):a("",!0)]),e.ability.type?(t(),i("div",{key:0,class:"hidden md:inline bg-base-200 p-2 rounded-xl flex-none",innerHTML:e.ability.type},null,8,z)):a("",!0),e.permission?(t(),i("div",F,[this.canDelete?(t(),i("a",{key:0,role:"button",onClick:l[0]||(l[0]=o=>r.updateAbility(e.ability)),class:"btn2 btn-ghost btn-sm",title:e.ability.i18n.edit},[l[1]||(l[1]=n("i",{class:"fa-solid fa-pencil text-xl","aria-hidden":"true"},null,-1)),n("span",{class:"sr-only",innerHTML:e.ability.i18n.edit},null,8,q)],8,V)):a("",!0)])):a("",!0)]),e.ability.type?(t(),i("div",E,[n("div",{class:"inline-block bg-base-200 p-2 rounded-xl",innerHTML:e.ability.type},null,8,P)])):a("",!0),e.ability.entry?(t(),i("div",{key:1,class:"entity-content",innerHTML:e.ability.entry},null,8,S)):a("",!0),e.ability.tags?(t(),i("div",G,[(t(!0),i(u,null,_(e.ability.tags,o=>(t(),i("a",{class:"rounded-lg bg-base-200 text-xs py-1 px-2 text-base-content",href:o.url,innerHTML:o.name},null,8,J))),256))])):a("",!0),e.ability.note?(t(),i("div",{key:3,class:"entity-content",innerHTML:e.ability.note},null,8,K)):a("",!0),e.ability.charges&&e.permission?(t(),i("div",O,[n("div",Q,[(t(!0),i(u,null,_(e.ability.charges,o=>(t(),i("div",{class:x(["charge cursor-pointer rounded-full p-2 hover:bg-accent hover:text-accent-content w-8 h-8 flex items-center justify-center",{"bg-base-200 charge-used":e.ability.used_charges>=o}]),onClick:c=>r.useCharge(e.ability,o)},[n("span",{innerHTML:o},null,8,U)],10,R))),256))]),n("div",W,[n("span",{class:"text-2xl",innerHTML:r.remainingNumber()},null,8,X),n("span",{innerHTML:r.remainingText()},null,8,Y)])])):a("",!0)])])],8,p)}const $=h(k,[["render",Z]]),ee={components:{Ability:$},props:["group","permission","meta"],data(){return{collapsed:!1}},computed:{backgroundImage:function(){return this.group.has_image?{backgroundImage:"url("+this.group.image+")"}:{}}},methods:{click:function(s){this.collapsed=!this.collapsed}}},te={class:"ability-parent flex flex-col gap-5 w-full"},ie={class:"parent-head flex gap-2 md:gap-5 items-center"},ne={class:"flex flex-col gap-1 grow overflow-hidden"},se={key:0},ae=["href","innerHTML"],le=["innerHTML"],oe=["innerHTML"],re={class:"flex-none self-end"},ce={key:0,"aria-hidden":"true",class:"fa-thin fa-chevron-circle-up fa-2x"},de={key:1,"aria-hidden":"true",class:"fa-thin fa-chevron-circle-down fa-2x"},ue={key:0,class:"parent-abilities flex flex-col gap-5"};function _e(s,l,e,g,d,r){const o=b("ability");return t(),i("div",te,[n("div",ie,[e.group.has_image?(t(),i("div",{key:0,class:"parent-image rounded-full w-12 h-12 md:w-16 md:h-16 cover-background flex-none",style:m(r.backgroundImage)},null,4)):a("",!0),n("div",ne,[e.group.url?(t(),i("div",se,[n("a",{href:e.group.url,innerHTML:e.group.name,class:"parent-name text-xl md:text-2xl"},null,8,ae)])):(t(),i("span",{key:1,class:"parent-name text-xl md:text-2xl",innerHTML:e.group.name},null,8,le)),n("p",{class:"md:text-lg truncate",innerHTML:e.group.type},null,8,oe)]),n("div",re,[n("span",{role:"button",onClick:l[0]||(l[0]=c=>r.click(e.group)),class:"cursor-pointer inline-block"},[this.collapsed?(t(),i("i",de)):(t(),i("i",ce))])])]),this.collapsed?a("",!0):(t(),i("div",ue,[(t(!0),i(u,null,_(e.group.abilities,c=>(t(),f(o,{key:c.id,ability:c,permission:e.permission,meta:e.meta},null,8,["ability","permission","meta"]))),128))]))])}const he=h(ee,[["render",_e]]),ge={props:["id","api","permission"],components:{Parent:he},data(){return{groups:[],meta:[],loading:!0,waiting:!1}},methods:{getAbilities:function(){fetch(this.api).then(s=>s.json()).then(s=>{this.groups=s.data.groups,this.meta=s.data.meta,this.loading=!1,this.waiting=!1})}},mounted(){this.getAbilities()},updated(){window.ajaxTooltip()}},me={class:"viewport box-abilities relative flex flex-col gap-5"},be={key:0,class:"load more text-center text-2xl"},fe={class:"flex gap-5 flex-wrap"};function ye(s,l,e,g,d,r){const o=b("parent");return t(),i("div",me,[d.loading?(t(),i("div",be,l[0]||(l[0]=[n("i",{class:"fa-solid fa-spin fa-spinner","aria-hidden":"true"},null,-1)]))):a("",!0),n("div",fe,[(t(!0),i(u,null,_(d.groups,c=>(t(),f(o,{key:c.id,group:c,permission:e.permission,meta:d.meta},null,8,["group","permission","meta"]))),128))])])}const xe=h(ge,[["render",ye]]),y=v({});y.component("abilities",xe);y.mount("#abilities");

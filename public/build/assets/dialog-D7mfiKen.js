import{c as o,b as t,t as n,f as u,F as m,w as g,C as h,e as C,g as y,a as r,q as x}from"./vendor-tiptap-BeM3cQ0c.js";import{a as v}from"./index-D5GkNzM3.js";import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";const E={props:{initialCampaignVisibility:{type:String,required:!0},initialEntityPrivate:{type:Boolean,required:!0},url:{type:String,required:!0},saveEndpoint:{type:String,required:!0},trans:{type:Object,required:!0}},data(){return{loading:!1,errorMessage:null,justMadeCampaignPublic:!1,campaignVisibility:this.initialCampaignVisibility,isEntityPrivate:this.initialEntityPrivate,form:{visibility_mode:"entity"}}},mounted(){window.triggerEvent?.()},computed:{isCampaignPublic(){return this.campaignVisibility==="public"||this.campaignVisibility==="unlisted"},isEntityPublic(){return this.isCampaignPublic&&!this.isEntityPrivate},clipboardToast(){return this.isEntityPublic?this.trans.success_copied_public:this.trans.success_copied_members},isCampaignUnlisted(){return this.campaignVisibility==="unlisted"},entityVisibleStatus(){return this.isCampaignUnlisted?this.trans.status_unlisted:this.trans.status_public},entityVisibleHelper(){return this.isCampaignUnlisted?this.trans.helper_unlisted:this.trans.helper_public},entityHiddenHelper(){return this.isCampaignUnlisted?this.trans.helper_hidden_unlisted:this.trans.helper_hidden},showSaveButton(){return this.isCampaignPublic?this.isEntityPrivate:!0}},methods:{async saveChanges(){this.loading=!0,this.errorMessage=null;try{let s={};this.isCampaignPublic?s.visibility_mode=this.form.visibility_mode:s.campaign_visibility="public";const e=await v.post(this.saveEndpoint,s);this.isCampaignPublic?this.isEntityPrivate=!1:(this.campaignVisibility="public",this.isEntityPrivate=!0,this.justMadeCampaignPublic=!0),window.showToast(this.trans.success_updated),this.$emit("updated",e.data)}catch(s){console.error(s),this.errorMessage=s.response?.data?.message||this.trans.error_generic}finally{this.loading=!1}},closeModal(){const s=this.$el.closest("dialog");s&&s.close()}}},M={class:"flex gap-6 items-center p-4 md:p-6 justify-between"},P={class:"text-lg font-normal"},S=["title"],V={class:"container"},D={class:"max-w-2xl flex flex-col gap-4 py-4 px-4 md:px-6"},L={key:0,class:"alert alert-error p-4 flex gap-2 rounded-2xl"},T={key:1,class:"alert alert-info p-4 flex gap-2 rounded-2xl"},q={class:"text-sm"},j={class:"alert alert-warning p-4 flex gap-2 rounded-2xl"},B={class:"flex flex-col gap-1"},H={class:"text-sm font-bold"},U={class:"text-xs"},A={class:"flex flex-col gap-1 w-full"},I={class:"font-semibold text-xs opacity-80"},N={class:"flex flex-col gap-2"},R={class:"flex items-center gap-3 p-3 border border-base-300 rounded-xl cursor-pointer hover:bg-base-200 transition"},X={class:"text-sm"},O={class:"flex items-center gap-3 p-3 border border-base-300 rounded-xl cursor-pointer hover:bg-base-200 transition"},F={class:"text-sm"},Y={key:1,class:"alert alert-success p-4 flex gap-2 rounded-2xl"},z={class:"flex flex-col gap-1"},G={class:"text-sm font-bold"},K={class:"text-xs"},W={class:"alert alert-warning p-4 flex gap-2 rounded-2xl"},J={class:"flex flex-col gap-1"},Q={class:"text-sm font-bold"},Z={class:"text-xs"},$={class:"alert alert-info p-4 flex gap-2 rounded-2xl"},tt={class:"text-sm"},et={class:"flex flex-col gap-1 w-full"},st={class:"font-semibold text-xs opacity-80"},it={class:"flex items-center gap-2"},lt=["value"],nt=["data-clipboard","data-toast","title"],at=["innerHTML"],ot={class:"p-4 md:px-6"},rt={class:"flex justify-end gap-3"},dt=["disabled"],ct={key:0,class:"loading loading-spinner loading-xs mr-2"};function ut(s,e,i,d,a,l){return r(),o(m,null,[t("header",M,[t("h4",P,n(i.trans.title),1),t("button",{type:"button",class:"text-2xl opacity-60 hover:opacity-100 hover:bg-base-200 focus:bg-base-200 cursor-pointer w-8 h-8 flex items-center justify-center rounded-lg",title:i.trans.btn_close,onClick:e[0]||(e[0]=(...c)=>l.closeModal&&l.closeModal(...c)),"aria-label":"Close dialog"},[...e[4]||(e[4]=[t("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[t("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1)])],8,S)]),t("div",V,[t("article",D,[a.errorMessage?(r(),o("div",L,[e[5]||(e[5]=t("i",{class:"fa-solid fa-circle-exclamation shrink-0"},null,-1)),t("span",null,n(a.errorMessage),1)])):u("",!0),a.justMadeCampaignPublic?(r(),o("div",T,[e[6]||(e[6]=t("i",{class:"fa-solid fa-circle-info shrink-0 mt-0.5"},null,-1)),t("p",q,n(i.trans.warning_entity_permissions),1)])):u("",!0),l.isCampaignPublic?(r(),o(m,{key:2},[a.isEntityPrivate?(r(),o(m,{key:0},[t("div",j,[e[7]||(e[7]=t("i",{class:"fa-solid fa-eye-slash shrink-0 mt-0.5"},null,-1)),t("div",B,[t("span",H,n(i.trans.status_hidden),1),t("p",U,n(l.entityHiddenHelper),1)])]),t("div",A,[t("label",I,n(i.trans.field_visibility_mode),1),t("div",N,[t("label",R,[g(t("input",{type:"radio",name:"visibility_mode",value:"entity",class:"radio radio-primary radio-sm","onUpdate:modelValue":e[1]||(e[1]=c=>a.form.visibility_mode=c)},null,512),[[h,a.form.visibility_mode]]),t("span",X,n(i.trans.option_entity_public),1)]),t("label",O,[g(t("input",{type:"radio",name:"visibility_mode",value:"global",class:"radio radio-primary radio-sm","onUpdate:modelValue":e[2]||(e[2]=c=>a.form.visibility_mode=c)},null,512),[[h,a.form.visibility_mode]]),t("span",F,n(i.trans.option_global_public),1)])])])],64)):(r(),o("div",Y,[t("i",{class:C([l.isCampaignUnlisted?"fa-solid fa-link":"fa-solid fa-globe","shrink-0 mt-0.5"])},null,2),t("div",z,[t("span",G,n(l.entityVisibleStatus),1),t("p",K,n(l.entityVisibleHelper),1)])]))],64)):(r(),o(m,{key:3},[t("div",W,[e[8]||(e[8]=t("i",{class:"fa-solid fa-lock shrink-0 mt-0.5"},null,-1)),t("div",J,[t("span",Q,n(i.trans.status_private),1),t("p",Z,n(i.trans.helper_private),1)])]),t("div",$,[e[9]||(e[9]=t("i",{class:"fa-solid fa-circle-info shrink-0 mt-0.5"},null,-1)),t("p",tt,n(i.trans.warning_entity_permissions),1)])],64)),t("div",et,[t("label",st,n(l.isEntityPublic?i.trans.label_public_link:i.trans.label_member_link),1),t("div",it,[t("input",{type:"text",class:"input input-bordered w-full text-sm font-mono bg-base-200",readonly:"",value:i.url},null,8,lt),t("button",{class:"btn2 btn-sm btn-outline shrink-0","data-clipboard":i.url,"data-toast":l.clipboardToast,title:i.trans.btn_copy},[...e[10]||(e[10]=[t("i",{class:"fa-solid fa-copy"},null,-1)])],8,nt)]),l.isEntityPublic?u("",!0):(r(),o("p",{key:0,class:"text-xs text-neutral-content",innerHTML:i.trans.helper_member_link},null,8,at))])])]),t("footer",ot,[t("menu",rt,[l.showSaveButton?(r(),o("button",{key:0,type:"submit",class:"btn2 btn-primary",disabled:a.loading,onClick:e[3]||(e[3]=(...c)=>l.saveChanges&&l.saveChanges(...c))},[a.loading?(r(),o("span",ct)):u("",!0),y(" "+n(l.isCampaignPublic?i.trans.btn_save:i.trans.btn_make_public),1)],8,dt)):u("",!0)])])],64)}const mt=k(E,[["render",ut]]),bt={props:{initialVisibility:{type:String,required:!0},url:{type:String,required:!0},saveEndpoint:{type:String,required:!0},settingsUrl:{type:String,required:!0},trans:{type:Object,required:!0}},data(){return{loading:!1,errorMessage:null,visibility:this.initialVisibility}},computed:{isCampaignPublic(){return this.visibility==="public"||this.visibility==="unlisted"},isCampaignUnlisted(){return this.visibility==="unlisted"}},mounted(){window.triggerEvent?.()},methods:{async makePublic(){this.loading=!0,this.errorMessage=null;try{if(await v.post(this.saveEndpoint,{campaign_visibility:"public"}),this.visibility="public",navigator.clipboard)await navigator.clipboard.writeText(this.url);else{const s=document.createElement("textarea");s.value=this.url,document.body.appendChild(s),s.select(),document.execCommand("copy"),document.body.removeChild(s)}window.showToast(this.trans.success_copied_public),this.closeModal()}catch(s){console.error(s),this.errorMessage=s.response?.data?.message||this.trans.error_generic}finally{this.loading=!1}},openVisibilityDialog(){window.openDialog("primary-dialog",this.settingsUrl)},closeModal(){const s=this.$el.closest("dialog");s&&s.close()}}},_t={class:"flex gap-6 items-center p-4 md:p-6 justify-between"},pt={class:"text-lg font-normal"},gt=["title"],ht={class:"max-w-2xl flex flex-col gap-4 py-4 px-4 md:px-6"},ft={key:0,class:"alert alert-error p-4 flex gap-2 rounded-2xl"},yt={key:1,class:"flex flex-col gap-4"},xt={class:"alert alert-info p-4 flex gap-2 rounded-2xl"},vt={class:"flex flex-col gap-1"},kt={class:"text-sm font-bold"},wt={class:"text-xs"},Ct={class:"flex flex-col gap-1"},Et={class:"font-normal text-sm"},Mt={class:"flex items-center gap-2"},Pt=["value"],St=["data-clipboard","data-toast","title"],Vt={key:2,class:"flex flex-col gap-4"},Dt={key:0,class:"alert alert-success p-4 flex gap-2 rounded-2xl"},Lt={class:"flex flex-col gap-1"},Tt={class:"text-sm font-bold"},qt={class:"text-xs"},jt={key:1,class:"alert alert-success p-4 flex gap-2 rounded-2xl"},Bt={class:"flex flex-col gap-1"},Ht={class:"text-sm font-bold"},Ut={class:"text-xs"},At={class:"flex flex-col gap-1"},It={class:"font-normal text-sm"},Nt={class:"flex items-center gap-2"},Rt=["value"],Xt=["data-clipboard","data-toast","title"],Ot={class:"p-4 md:px-6"},Ft={class:"flex justify-end gap-3"},Yt=["disabled"],zt={key:0,class:"loading loading-spinner loading-xs mr-2"},Gt=["data-clipboard","data-toast"];function Kt(s,e,i,d,a,l){return r(),o("div",null,[t("header",_t,[t("h4",pt,n(i.trans.title),1),t("button",{type:"button",class:"text-2xl opacity-60 hover:opacity-100 hover:bg-base-200 focus:bg-base-200 cursor-pointer w-8 h-8 flex items-center justify-center rounded-lg",title:i.trans.btn_close,onClick:e[0]||(e[0]=(...c)=>l.closeModal&&l.closeModal(...c)),"aria-label":"Close dialog"},[...e[4]||(e[4]=[t("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[t("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1)])],8,gt)]),t("article",ht,[a.errorMessage?(r(),o("div",ft,[e[5]||(e[5]=t("i",{class:"fa-solid fa-circle-exclamation shrink-0"},null,-1)),t("span",null,n(a.errorMessage),1)])):u("",!0),l.isCampaignPublic?(r(),o("div",Vt,[l.isCampaignUnlisted?(r(),o("div",Dt,[e[8]||(e[8]=t("i",{class:"fa-solid fa-link shrink-0 mt-0.5"},null,-1)),t("div",Lt,[t("span",Tt,n(i.trans.status_unlisted),1),t("p",qt,n(i.trans.helper_unlisted),1)])])):(r(),o("div",jt,[e[9]||(e[9]=t("i",{class:"fa-solid fa-globe shrink-0 mt-0.5"},null,-1)),t("div",Bt,[t("span",Ht,n(i.trans.status_public),1),t("p",Ut,n(i.trans.helper_public),1)])])),t("div",At,[t("label",It,n(i.trans.label_public_link),1),t("div",Nt,[t("input",{type:"text",class:"input input-bordered w-full text-sm font-mono bg-base-200",readonly:"",value:i.url},null,8,Rt),t("button",{class:"btn2 btn-sm btn-outline shrink-0","data-clipboard":i.url,"data-toast":i.trans.success_copied_public,title:i.trans.btn_copy},[...e[10]||(e[10]=[t("i",{class:"fa-solid fa-copy"},null,-1)])],8,Xt)])])])):(r(),o("div",yt,[t("div",xt,[e[6]||(e[6]=t("i",{class:"fa-solid fa-lock shrink-0 mt-0.5"},null,-1)),t("div",vt,[t("span",kt,n(i.trans.status_private),1),t("p",wt,n(i.trans.helper_private),1)])]),t("div",Ct,[t("label",Et,n(i.trans.label_member_link),1),t("div",Mt,[t("input",{type:"text",class:"input input-bordered w-full text-sm font-mono bg-base-200",readonly:"",value:i.url},null,8,Pt),t("button",{class:"btn2 btn-sm btn-outline shrink-0","data-clipboard":i.url,"data-toast":i.trans.success_copied_members,title:i.trans.btn_copy},[...e[7]||(e[7]=[t("i",{class:"fa-solid fa-copy"},null,-1)])],8,St)])])]))]),t("footer",Ot,[t("menu",Ft,[l.isCampaignPublic?(r(),o("button",{key:0,type:"button",class:"btn2 btn-sm btn-outline",onClick:e[1]||(e[1]=(...c)=>l.openVisibilityDialog&&l.openVisibilityDialog(...c))},n(i.trans.btn_change_visibility),1)):u("",!0),l.isCampaignPublic?(r(),o("button",{key:2,type:"button",class:"btn2 btn-primary","data-clipboard":i.url,"data-toast":i.trans.success_copied_public,onClick:e[3]||(e[3]=(...c)=>l.closeModal&&l.closeModal(...c))},n(i.trans.btn_copy_public_link),9,Gt)):(r(),o("button",{key:1,type:"submit",class:"btn2 btn-primary",disabled:a.loading,onClick:e[2]||(e[2]=(...c)=>l.makePublic&&l.makePublic(...c))},[a.loading?(r(),o("span",zt)):u("",!0),y(" "+n(i.trans.btn_make_public),1)],8,Yt))])])])}const Wt=k(bt,[["render",Kt]]);window.mountShareModal=function(){const s=document.getElementById("entity-share-container");if(s&&!s.__vue_app__){const e=x({});e.component("entity-share-modal",mt),e.mount(s)}};window.mountCampaignShareModal=function(){const s=document.getElementById("campaign-share-container");if(s&&!s.__vue_app__){const e=x({});e.component("campaign-share-modal",Wt),e.mount(s)}};const b=document.getElementById("dialog-backdrop");let _;const Jt=()=>{document.querySelectorAll('[data-toggle="dialog"]').forEach(s=>{s.addEventListener("click",f)}),document.querySelectorAll('[data-toggle="dialog-ajax"]').forEach(s=>{s.addEventListener("click",f)})};function f(s){s.preventDefault();let e=this.dataset.target??"primary-dialog",i=this.dataset.url??this.url,d=this.dataset.focus;w(e,i,d)}const w=(s,e,i)=>{if(s=document.getElementById(s),s.removeAttribute("open"),s.setAttribute("aria-hidden",!1),s.show(),document.addEventListener("keydown",p),b.classList.remove("hidden"),s.dataset.dismissible!=="false"&&b.addEventListener("click",function(){s.close()}),s.addEventListener("click",function(d){let a=s.getBoundingClientRect();!(a.top<=d.clientY&&d.clientY<=a.top+a.height&&a.left<=d.clientX&&d.clientX<=a.left+a.width)&&d.target.tagName==="DIALOG"&&s.close()}),s.addEventListener("close",function(){b.classList.add("hidden"),s.setAttribute("aria-hidden",!0),document.removeEventListener("keydown",p)}),e)Qt(e,s);else if(i){let d=document.querySelector(i);if(!d)return;d.focus()}},p=s=>{if(s.key==="Escape"){const e=document.activeElement;if(["INPUT","SELECT","TEXTAREA"].includes(e.tagName)){document.activeElement.blur();return}const d=document.querySelector('dialog[aria-hidden="false"]');d||document.removeEventListener("keydown",p),d.close()}},Qt=(s,e)=>{_?e.innerHTML=_:_=e.innerHTML,fetch(s,{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(i=>i.text()).then(i=>{e.innerHTML=i,e.show(),window.mountShareModal(),window.mountCampaignShareModal()}).catch(i=>{console.error(i),e.innerHTML="Error loading content."})},Zt=s=>{document.getElementById(s).close()};window.initDialogs=Jt;window.openDialog=w;window.closeDialog=Zt;

import{c as r,b as s,t as l,f as m,g as u,w as h,z as g,a as d,q as v}from"./vendor-tiptap-BwkKWjOO.js";import{a as x}from"./index-D5GkNzM3.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";const w={props:{initialCampaignPublic:{type:Boolean,required:!0},initialEntityPrivate:{type:Boolean,required:!0},url:{type:String,required:!0},saveEndpoint:{type:String,required:!0},trans:{type:Object,required:!0}},data(){return{loading:!1,errorMessage:null,isCampaignPublic:this.initialCampaignPublic,isEntityPrivate:this.initialEntityPrivate,form:{visibility_mode:"entity"}}},mounted(){window.triggerEvent()},computed:{isEntityPublic(){return this.isCampaignPublic&&!this.isEntityPrivate},clipboardToast(){return this.isEntityPublic?this.trans.success_copied_public:this.trans.success_copied_members},showSaveButton(){return this.isCampaignPublic?this.isEntityPrivate:!0}},methods:{async saveChanges(){this.loading=!0,this.errorMessage=null;try{let t={};this.isCampaignPublic?t.visibility_mode=this.form.visibility_mode:t.campaign_visibility="public";const e=await x.post(this.saveEndpoint,t);this.isCampaignPublic?this.isEntityPrivate=!1:(this.isCampaignPublic=!0,this.isEntityPrivate=!0),window.showToast(this.trans.success_updated),this.$emit("updated",e.data)}catch(t){console.error(t),this.errorMessage=t.response?.data?.message||this.trans.error_generic}finally{this.loading=!1}},closeModal(){const t=this.$el.closest("dialog");t&&t.close()}}},k={class:"dialog rounded-2xl text-center bg-base-100 text-base-content overflow-hidden"},P={class:"flex gap-6 items-center p-4 md:p-6 justify-between border-b border-base-300"},M={class:"text-lg font-normal"},C=["title"],L={class:"sr-only"},S={class:"max-w-4xl flex flex-col gap-4 text-left p-4 md:px-6"},D={key:0,class:"alert alert-error text-sm rounded-xl"},T={key:1},q={key:0,class:"flex flex-col gap-4"},B={class:"p-3 bg-warning/10 border border-warning/20 rounded-xl"},A={class:"text-sm text-warning font-bold mb-1 flex items-center"},I={class:"text-xs text-neutral-content leading-relaxed"},N={class:"flex flex-col gap-2"},V={class:"font-normal"},j={class:"flex flex-col gap-2"},H={class:"flex items-center gap-3 p-3 border border-base-300 rounded-xl cursor-pointer hover:bg-base-200 transition"},R={class:"text-sm"},X={class:"flex items-center gap-3 p-3 border border-base-300 rounded-xl cursor-pointer hover:bg-base-200 transition"},U={class:"text-sm"},O={key:1,class:"p-4 bg-success/10 border border-success/20 rounded-xl"},Y={class:"text-sm text-success font-bold mb-1 flex items-center"},z={class:"text-xs text-neutral-content"},G={key:2,class:"flex flex-col gap-4"},K={class:"p-3 bg-base-300/30 border border-base-300 rounded-xl"},W={class:"text-sm text-neutral-content font-bold mb-1 flex items-center"},F={class:"text-xs text-neutral-content"},J={class:"p-3 bg-info/10 border border-info/20 rounded-xl text-xs text-neutral-content leading-relaxed"},Q={class:"flex flex-col gap-1 mt-2"},Z={class:"font-normal"},$={class:"flex items-center gap-2"},ee=["value"],te=["data-clipboard","data-toast","title"],se={class:"p-4 md:px-6 border-t border-base-300 mt-2"},ie={class:"flex justify-end gap-3"},ne=["disabled"],oe={key:0,class:"loading loading-spinner loading-xs mr-2"};function le(t,e,i,o,n,a){return d(),r("div",k,[s("header",P,[s("h4",M,l(i.trans.title),1),s("button",{type:"button",class:"text-base-content opacity-50 hover:opacity-100",title:i.trans.btn_close,onClick:e[0]||(e[0]=(...c)=>a.closeModal&&a.closeModal(...c))},[e[4]||(e[4]=s("i",{class:"fa-regular fa-circle-xmark","aria-hidden":"true"},null,-1)),s("span",L,l(i.trans.btn_close),1)],8,C)]),s("article",S,[n.errorMessage?(d(),r("div",D,[e[5]||(e[5]=s("i",{class:"fa-solid fa-circle-exclamation"},null,-1)),s("span",null,l(n.errorMessage),1)])):m("",!0),n.isCampaignPublic?(d(),r("div",T,[n.isEntityPrivate?(d(),r("div",q,[s("div",B,[s("div",A,[e[6]||(e[6]=s("i",{class:"fa-solid fa-eye-slash mr-2"},null,-1)),u(" "+l(i.trans.status_hidden),1)]),s("p",I,l(i.trans.helper_hidden),1)]),s("div",N,[s("label",V,l(i.trans.field_visibility_mode),1),s("div",j,[s("label",H,[h(s("input",{type:"radio",name:"visibility_mode",value:"entity",class:"radio radio-primary radio-sm","onUpdate:modelValue":e[1]||(e[1]=c=>n.form.visibility_mode=c)},null,512),[[g,n.form.visibility_mode]]),s("span",R,l(i.trans.option_entity_public),1)]),s("label",X,[h(s("input",{type:"radio",name:"visibility_mode",value:"global",class:"radio radio-primary radio-sm","onUpdate:modelValue":e[2]||(e[2]=c=>n.form.visibility_mode=c)},null,512),[[g,n.form.visibility_mode]]),s("span",U,l(i.trans.option_global_public),1)])])])])):(d(),r("div",O,[s("div",Y,[e[7]||(e[7]=s("i",{class:"fa-solid fa-globe mr-2"},null,-1)),u(" "+l(i.trans.status_public),1)]),s("p",z,l(i.trans.helper_public),1)]))])):(d(),r("div",G,[s("div",K,[s("div",W,[e[8]||(e[8]=s("i",{class:"fa-solid fa-lock mr-2"},null,-1)),u(" "+l(i.trans.status_private),1)]),s("p",F,l(i.trans.helper_private),1)]),s("div",J,[e[9]||(e[9]=s("i",{class:"fa-solid fa-circle-info mr-1 text-info"},null,-1)),u(" "+l(i.trans.warning_entity_permissions),1)])])),s("div",Q,[s("label",Z,l(a.isEntityPublic?i.trans.label_public_link:i.trans.label_member_link),1),s("div",$,[s("input",{type:"text",class:"input input-bordered w-full text-sm font-mono bg-base-200",readonly:"",value:i.url},null,8,ee),s("button",{class:"btn2 btn-sm btn-outline shrink-0","data-clipboard":i.url,"data-toast":a.clipboardToast,title:i.trans.btn_copy},[...e[10]||(e[10]=[s("i",{class:"fa-solid fa-copy"},null,-1)])],8,te)])])]),s("footer",se,[s("menu",ie,[a.showSaveButton?(d(),r("button",{key:0,type:"submit",class:"btn2 btn-primary",disabled:n.loading,onClick:e[3]||(e[3]=(...c)=>a.saveChanges&&a.saveChanges(...c))},[n.loading?(d(),r("span",oe)):m("",!0),u(" "+l(n.isCampaignPublic?i.trans.btn_save:i.trans.btn_make_public),1)],8,ne)):m("",!0)])])])}const ae=E(w,[["render",le]]);window.mountShareModal=function(){const t=document.getElementById("entity-share-container");if(t&&!t.__vue_app__){const e=v({});e.component("entity-share-modal",ae),e.mount(t),console.log("Vue Share Modal Mounted")}};const b=document.getElementById("dialog-backdrop");let f;const re=()=>{document.querySelectorAll('[data-toggle="dialog"]').forEach(t=>{t.addEventListener("click",p)}),document.querySelectorAll('[data-toggle="dialog-ajax"]').forEach(t=>{t.addEventListener("click",p)})};new Event("dialog.loaded");function p(t){t.preventDefault();let e=this.dataset.target??"primary-dialog",i=this.dataset.url??this.url,o=this.dataset.focus;y(e,i,o)}const y=(t,e,i)=>{if(t=document.getElementById(t),t.removeAttribute("open"),t.setAttribute("aria-hidden",!1),t.show(),document.addEventListener("keydown",_),b.classList.remove("hidden"),t.dataset.dismissible!=="false"&&b.addEventListener("click",function(o){t.close()}),t.addEventListener("click",function(o){let n=t.getBoundingClientRect();!(n.top<=o.clientY&&o.clientY<=n.top+n.height&&n.left<=o.clientX&&o.clientX<=n.left+n.width)&&o.target.tagName==="DIALOG"&&t.close()}),t.addEventListener("close",function(o){b.classList.add("hidden"),t.setAttribute("aria-hidden",!0),document.removeEventListener("keydown",_)}),e)de(e,t);else if(i){let o=document.querySelector(i);if(!o)return;o.focus()}},_=t=>{if(t.key==="Escape"){const e=document.activeElement;if(["INPUT","SELECT","TEXTAREA"].includes(e.tagName)){document.activeElement.blur();return}const o=document.querySelector('dialog[aria-hidden="false"]');o||document.removeEventListener("keydown",_),o.close()}},de=(t,e)=>{f?e.innerHTML=f:f=e.innerHTML,fetch(t,{headers:{"X-Requested-With":"XMLHttpRequest"}}).then(i=>i.text()).then(i=>{e.innerHTML=i,e.show(),typeof window.mountShareModal=="function"?window.mountShareModal():console.error("mountShareModal is not defined. Is share.js loaded on the main page?")}).catch(i=>{console.error(i),e.innerHTML="Error loading content."})},ce=t=>{document.getElementById(t).close()};window.initDialogs=re;window.openDialog=y;window.closeDialog=ce;

import{S as C}from"./sortable.esm-C83syoBY.js";import{d as E,r as m,o as D,y as I,c as u,f as M,a as p,b as n,w as $,v as A,e as w,q as B}from"./vue.esm-bundler-mQlwGVE3.js";import{v as N}from"./v-click-outside.umd-CFxmCgl1.js";import"./_commonjsHelpers-Cpj98o6Y.js";const O={class:"flex gap-6 items-center p-4 md:p-6 justify-between"},V=["innerHTML"],K={class:"max-w-4xl p-4"},F={class:"flex flex-col gap-4 lg:gap-6"},U=["innerHTML"],j={class:"flex flex-col gap-1"},z=["innerHTML"],J=["placeholder"],P=["innerHTML"],R=["innerHTML"],W={class:"flex flex-col gap-2"},G=["innerHTML"],Q=["innerHTML"],X={class:"flex flex-col gap-4"},Y={key:0,class:"fa-regular fa-check-square text-xl","aria-label":"Selected"},Z={key:1,class:"fa-regular fa-globe text-xl","aria-hidden":"true"},ee={class:"flex flex-col gap-1"},te=["innerHTML"],ne=["innerHTML"],se={key:0,class:"fa-regular fa-check-square text-xl","aria-label":"Selected"},ae={key:1,class:"fa-regular fa-dice-d20 text-xl","aria-hidden":"true"},oe={class:"flex flex-col gap-1"},le=["innerHTML"],ie=["innerHTML"],re={key:0,class:"fa-regular fa-check-square text-xl","aria-label":"Selected"},de={key:1,class:"fa-regular fa-pen-fancy text-xl","aria-hidden":"true"},ce={class:"flex flex-col gap-1"},ue=["innerHTML"],pe=["innerHTML"],me=["innerHTML"],fe={class:"flex justify-between w-full gap-4 items-center mt-6"},ge=["innerHTML"],xe=["innerHTML"],ve={key:1,class:"btn2 btn-primary btn-disabled",disabled:"disabled"},ye=E({__name:"Onboarding",props:{api:{},skip:{},i18n:{},campaign:{}},setup(e){const s=e,a=m(null),l=m(""),d=m(null),c=m(),L=m(!1),f=m(),g=m(!1),y=m(),o=r=>c.value[r]??"unknown",x=()=>{window.closeDialog("onboarding-dialog")},_=r=>{r.target===a.value&&x()},S=()=>{axios.post(s.skip),x()},q=()=>{if(g.value)return;g.value=!0;let r={name:l.value,type:f.value};axios.post(s.api,r).then(t=>{t.data.redirect?window.location.href=t.data.redirect:x()}).catch(t=>{t.response.data.message?(y.value=t.response.data.message,d.value.focus(),d.value.scrollIntoView({behavior:"smooth"})):console.error("onboarding saving error",t),g.value=!1})},v=r=>{f.value=r},h=r=>{let t="flex items-center gap-4 rounded-xl border p-2 px-4 hover:border-primary hover:text-primary focus:border-primary focus:text-primary";return f.value!==r?t+" cursor-pointer":t+"border-primary text-primary"},b=(r,t)=>{(r.key==="Enter"||r.key===" ")&&(r.preventDefault(),v(t))};return D(async()=>{c.value=JSON.parse(s.i18n),l.value=s.campaign,L.value=!0,await I(),a.value.showModal()}),(r,t)=>L.value?(p(),u("dialog",{key:0,class:"dialog rounded-2xl bg-base-100 text-base-content",id:"onboarding-dialog",ref_key:"onboardingDialog",ref:a,"aria-modal":"true","aria-labelledby":"modal-card-label",onClick:t[10]||(t[10]=(...i)=>_&&_(...i))},[n("header",O,[n("h4",{innerHTML:o("title"),class:"text-lg font-normal"},null,8,V),n("button",{type:"button",class:"text-base-content",onClick:t[0]||(t[0]=i=>x()),title:"Close"},t[11]||(t[11]=[n("i",{class:"fa-regular fa-circle-xmark","aria-hidden":"true"},null,-1),n("span",{class:"sr-only"},"Close",-1)]))]),n("article",K,[n("div",F,[n("p",{class:"text-neutral-content",innerHTML:o("intro")},null,8,U),n("div",j,[n("label",{for:"name",innerHTML:o("name")},null,8,z),$(n("input",{type:"text",name:"name",id:"name",ref_key:"nameField",ref:d,class:"","onUpdate:modelValue":t[1]||(t[1]=i=>l.value=i),placeholder:o("name"),"data-1p-ignore":"true"},null,8,J),[[A,l.value]]),n("p",{class:"text-xs text-neutral-content",innerHTML:o("placeholder")},null,8,P),y.value?(p(),u("p",{key:0,innerHTML:y.value,class:"text-error"},null,8,R)):M("",!0)]),n("div",W,[n("h3",{innerHTML:o("type-title")},null,8,G),n("p",{innerHTML:o("type-intro")},null,8,Q),n("div",X,[n("div",{class:w(h("worldbuilding")),onClick:t[2]||(t[2]=i=>v("worldbuilding")),tabindex:"0",onKeydown:t[3]||(t[3]=i=>b(i,"worldbuilding"))},[f.value==="worldbuilding"?(p(),u("i",Y)):(p(),u("i",Z)),n("div",ee,[n("span",{class:"text-lg",innerHTML:o("worldbuilding")},null,8,te),n("p",{class:"text-xs text-neutral-content",innerHTML:o("worldbuilding-description")},null,8,ne)])],34),n("div",{class:w(h("campaign")),onClick:t[4]||(t[4]=i=>v("campaign")),tabindex:"0",onKeydown:t[5]||(t[5]=i=>b(i,"campaign"))},[f.value==="campaign"?(p(),u("i",se)):(p(),u("i",ae)),n("div",oe,[n("span",{class:"text-lg",innerHTML:o("campaign")},null,8,le),n("p",{class:"text-xs text-neutral-content",innerHTML:o("campaign-description")},null,8,ie)])],34),n("div",{class:w(h("story")),onClick:t[6]||(t[6]=i=>v("story")),tabindex:"0",onKeydown:t[7]||(t[7]=i=>b(i,"story"))},[f.value==="story"?(p(),u("i",re)):(p(),u("i",de)),n("div",ce,[n("span",{class:"text-lg",innerHTML:o("story")},null,8,ue),n("p",{class:"text-xs text-neutral-content",innerHTML:o("story-description")},null,8,pe)])],34)]),n("p",{class:"text-xs text-neutral-content",innerHTML:o("type-helper")},null,8,me)])]),n("div",fe,[n("button",{class:"btn2 btn-sm btn-outline",onClick:t[8]||(t[8]=i=>S()),innerHTML:o("skip")},null,8,ge),g.value?(p(),u("span",ve,t[12]||(t[12]=[n("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Saving"},null,-1)]))):(p(),u("button",{key:0,class:"btn2 btn-primary",onClick:t[9]||(t[9]=i=>q()),innerHTML:o("continue")},null,8,xe))])])],512)):M("",!0)}}),he=new IntersectionObserver(function(e){e.forEach(s=>{s.isIntersecting&&e.forEach(a=>{Le(a.target)})})},{threshold:[0]}),be=()=>{if(!document.querySelector(".campaign-dashboard-widgets"))return;let e=document.getElementById("widgets");new C(e,{handle:".handle",onEnd:function(s){const a=document.getElementById("widgets").dataset.url;let l="";document.querySelectorAll('input[name="widgets[]"]').forEach(c=>{l+=`${c.name}=${encodeURIComponent(c.value)}&`}),axios.post(a,l).then(c=>{c.data.success&&c.data.message&&window.showToast(c.data.message)})}}),window.onEvent(function(){document.getElementById("summernote-config")&&window.initSummernote(),document.querySelectorAll('[data-img="delete"]').forEach(l=>{l.addEventListener("click",function(d){d.preventDefault(),document.querySelector("input[name="+l.dataset.target+"]").value=1,l.closest(".preview").classList.add("hidden")})})})},k=()=>{const e=document.querySelectorAll(".widget-calendar-switch");e.length!==0&&e.forEach(s=>{s.addEventListener("click",a=>{a.preventDefault();const l=s.dataset.url,d=s.dataset.widget;document.querySelector("#widget-body-"+d).classList.add("hidden"),document.querySelector("#widget-loading-"+d).classList.remove("hidden"),axios.post(l).then(c=>{H(d,c.data)})})})},we=()=>{const e=document.querySelector("#campaign-follow"),s=document.querySelector("#campaign-follow-text");if(!e)return;e.dataset.following?s.innerHTML=e.dataset.unfollow:s.innerHTML=e.dataset.follow,e.classList.remove("hidden"),e.addEventListener("click",function(l){e.classList.add("loading"),l.preventDefault(),axios.post(e.dataset.url).then(d=>{e.classList.remove("loading"),d.data.following?s.innerHTML=e.dataset.unfollow:s.innerHTML=e.dataset.follow})})},Le=e=>{axios.get(e.dataset.render).then(s=>{let a=e.dataset.id;H(a,s.data)})},H=(e,s)=>{document.querySelector("#widget-loading-"+e).classList.add("hidden"),document.querySelector("#widget-body-"+e).innerHTML=s,document.querySelector("#widget-body-"+e).classList.remove("hidden"),window.triggerEvent(),k()},_e=()=>{document.querySelectorAll(".preview-switch").forEach(e=>{e.addEventListener("click",function(s){s.preventDefault();let a=document.querySelector("#widget-preview-body-"+e.dataset.widget);a.classList.contains("max-h-52")?(a.classList.remove("max-h-52"),e.innerHTML='<i class="fa-solid fa-chevron-up" aria-hidden="true"></i>',e.parentNode.querySelector(".gradient-to-base-100").classList.add("hidden")):(a.classList.add("max-h-52"),e.innerHTML='<i class="fa-solid fa-chevron-down" aria-hidden="true"></i>',e.parentNode.querySelector(".gradient-to-base-100").classList.remove("hidden"))})})},Me=()=>{const e=B({});e.component("onboarding",ye),e.use(N),e.mount("#onboarding")};k();we();_e();be();Me();var T;(T=document.querySelectorAll("[data-render]"))==null||T.forEach(e=>{he.observe(e)});

import{d as We,r as U,o as Wt,E as pn,c as x,a as p,w as Q,v as Ge,A as at,f as R,e as Ae,k as lt,H as mn,I as Ne,y as zt,F as ke,g as Be,l as Ve,m as qt,b as y,i as Kt,j as he,p as Pe,J as gn,K as Pt,q as vn}from"./vue.esm-bundler-Dgt_CrCE.js";import{v as bn}from"./v-click-outside.umd-CFxmCgl1.js";import"./_commonjsHelpers-Cpj98o6Y.js";const wn={key:0,class:"text-center text-4xl p-4"},yn={key:1,class:"flex flex-col gap-2 lg:gap-5 relative"},_n={class:"flex gap-2 lg:gap-2 justify-end px-4 pt-4"},xn=["placeholder"],En={class:"relative"},Tn=["innerHTML"],Dn={key:0,class:"border shadow rounded bg-base-100 p-4 absolute right-0 flex flex-col gap-5 w-60"},Cn={class:"flex gap-2"},Sn=["innerHTML"],kn={class:"flex gap-2 md:gap-5 flex-wrap px-4 pb-4"},In=["innerHTML"],An=["innerHTML"],Mn=["innerHTML"],On={href:"https://docs.kanka.io/en/latest/features/attributes.html",target:"_blank",class:"btn2 btn-ghost"},Ln=["innerHTML"],Nn={class:"w-full flex flex-col gap-2"},Pn={class:"flex gap-2 border-b text-neutral-content text-xs md:text-sm font-light px-4"},$n={class:"w-6 md:w-8 flex-none"},Hn=["innerHTML"],Fn=["innerHTML"],Bn={class:"hidden lg:block w-16 flex-none text-center"},Vn=["innerHTML"],Rn={key:0,class:"hidden lg:block w-16 flex-none text-center"},jn=["innerHTML"],Xn={class:"hidden lg:block w-16 flex-none text-center"},Yn=["innerHTML"],Un=["innerHTML"],Gn=["innerHTML"],Wn={key:2,class:"dialog rounded-top md:rounded-2xl bg-base-100 min-w-fit shadow-md text-base-content",id:"templates-dialog","aria-modal":"true"},zn={class:"bg-base-200 sm:rounded-t"},qn=["innerHTML"],Kn=["innerHTML"],Jn=["label"],Zn=["value","innerHTML"],Qn={class:"bg-base-200 flex flex-wrap gap-3 justify-end items-center p-3 md:rounded-b"},ei={class:"flex flex-wrap gap-3 ps-0"},ti={class:"submit-group"},ni=["innerHTML"],ii=We({__name:"Manager",props:{api:{}},setup(t){const e=t,n=U([]),i=U([]);let o=[],r=[],a=[];const s=U(!0),d=U(!1),c=U([]);U(!1);const u=U(!1),f=U(!1),E=U(!1),k=U(null),_=U(null),C=U(0);Wt(()=>{fetch(e.api).then(T=>T.json()).then(T=>{T.attributes.forEach(m=>{n.value.push(m),i.value.push(m)}),r=T.meta,o=T.i18n,a=T.templates,s.value=!1}),window.addEventListener("keydown",F)}),pn(()=>{window.removeEventListener("keydown",F)});const F=T=>{const z=document.activeElement.tagName.toLowerCase();if(!["select","input","textarea","button"].includes(z)&&T.ctrlKey&&T.key==="z"){if(c.value.length===0)return;T.preventDefault();let Le=c.value.pop(),Ke=n.value.find(pt=>pt.id===Le);Ke&&(Ke.is_deleted=!1),S()}},g=T=>{if(!T.includes("."))return T;let m=T.split(".");return o[m[0]][m[1]]},I=()=>{let T=d.value;n.value.forEach(m=>{m.is_hidden&&!u.value||(m.is_checked=T)})},L=T=>{T.is_deleted=!0,T.is_checked=!1,c.value.push(T.id)},O=T=>{L(T),S()},j=()=>n.value.find(m=>m.is_checked==!0)?"btn2 btn-error":"btn2 btn-ghost",l=()=>{let T=n.value.filter(m=>m.is_checked);if(T.length===0)return window.showToast(g("toasts.no_attributes_selected"),"error");T.forEach(m=>{L(m)}),S(),d.value=!1,window.showToast(g("toasts.toggle_deleted"))},v=()=>n.value.find(m=>m.is_checked==!0)?"btn2":"btn2 btn-ghost",P=()=>{let T=n.value.filter(z=>z.is_checked);if(T.length===0)return window.showToast(g("toasts.no_attributes_selected"),"error");let m=null;T.forEach(z=>{m===null&&(m=!z.is_private),z.is_private=m}),window.showToast(g("toasts.toggled_privacy"))},S=()=>{i.value=te()},Y=()=>r.is_admin,te=()=>n.value.filter(T=>!T.is_deleted),ve=()=>{f.value=!0},ie=()=>{E.value=!0,window.openDialog("templates-dialog")},oe=()=>{window.closeDialog("templates-dialog")},be=()=>{f.value=!1,E.value=!1},ae=()=>{if(!_.value){oe();return}let T=r.template+"?template="+_.value;fetch(T).then(m=>m.json()).then(m=>{m.forEach(z=>Te(z)),oe(),window.showToast(g("toasts.template")),_.value=null})},Te=T=>{let m=n.value.find(z=>z.name==T.name);m&&!m.is_deleted||(T.id=C.value--,n.value.push(T),i.value.push(T))},we=()=>{C.value--};return(T,m)=>{const z=Ve("attributes-manager-attribute"),Le=Ve("draggable"),Ke=Ve("attributes-manager-form"),pt=qt("click-outside");return y(),x(ke,null,[s.value?(y(),x("div",wn,m[12]||(m[12]=[p("i",{class:"fa-solid fa-spinner fa-spin","aria-label":"Loading"},null,-1)]))):(y(),x("div",yn,[p("div",_n,[Q(p("input",{type:"text",placeholder:g("actions.search"),class:"grow md:flex-none md:w-80","onUpdate:modelValue":m[0]||(m[0]=B=>k.value=B)},null,8,xn),[[Ge,k.value]]),p("div",En,[p("a",{role:"button",onClick:m[1]||(m[1]=B=>ve()),class:"btn2 btn-default btn-sm"},[m[13]||(m[13]=p("i",{class:"fa-solid fa-bars-filter","aria-hidden":"true"},null,-1)),p("span",{innerHTML:g("actions.filters")},null,8,Tn)]),f.value?Q((y(),x("div",Dn,[p("div",Cn,[p("div",null,[Q(p("input",{type:"checkbox","onUpdate:modelValue":m[2]||(m[2]=B=>u.value=B),value:"1",id:"_show_hidden_attributes"},null,512),[[at,u.value]])]),p("label",{for:"_show_hidden_attributes",innerHTML:g("filters.show_hidden")},null,8,Sn)])])),[[pt,be]]):R("",!0)])]),p("div",kn,[p("a",{role:"button",class:Ae(j()),onClick:m[3]||(m[3]=B=>l())},[m[14]||(m[14]=p("i",{class:"fa-solid fa-trash-can","aria-hidden":"true"},null,-1)),p("span",{innerHTML:g("columns.delete")},null,8,In)],2),Y()?(y(),x("a",{key:0,role:"button",onClick:m[4]||(m[4]=B=>P()),class:Ae(v())},[m[15]||(m[15]=p("i",{class:"fa-solid fa-lock-open","aria-hidden":"true"},null,-1)),p("span",{innerHTML:g("actions.toggle")},null,8,An)],2)):R("",!0),p("a",{role:"button",class:"btn2 md:ml-auto",onClick:m[5]||(m[5]=B=>ie())},[m[16]||(m[16]=p("i",{class:"fa-regular fa-file-import","aria-hidden":"true"},null,-1)),p("span",{innerHTML:g("actions.load")},null,8,Mn)]),p("a",On,[m[17]||(m[17]=p("i",{class:"fa-solid fa-question-circle","aria-hidden":"true"},null,-1)),p("span",{innerHTML:g("actions.help")},null,8,Ln)])]),p("div",Nn,[p("div",Pn,[m[18]||(m[18]=p("div",{class:"w-6 md:w-8 flex-none"},null,-1)),p("div",$n,[Q(p("input",{type:"checkbox",onChange:m[6]||(m[6]=B=>I()),"onUpdate:modelValue":m[7]||(m[7]=B=>d.value=B)},null,544),[[at,d.value]])]),p("div",{class:"grow md:w-40 md:grow-0 flex-none",innerHTML:g("columns.attribute")},null,8,Hn),p("div",{class:"hidden md:block grow",innerHTML:g("columns.value")},null,8,Fn),p("div",Bn,[p("span",{class:"truncate inline-block",innerHTML:g("columns.pinned")},null,8,Vn)]),Y()?(y(),x("div",Rn,[p("span",{class:"truncate inline-block",innerHTML:g("columns.private")},null,8,jn)])):R("",!0),p("div",Xn,[p("span",{class:"truncate inline-block",innerHTML:g("columns.delete")},null,8,Yn)]),p("div",{class:"lg:hidden flex-none text-center",innerHTML:g("columns.preferences")},null,8,Un)]),lt(Le,{modelValue:i.value,"onUpdate:modelValue":m[8]||(m[8]=B=>i.value=B),handle:".handle",class:"w-full flex flex-col gap-2"},{default:mn(()=>[(y(!0),x(ke,null,Be(i.value,B=>(y(),Kt(z,{key:B.id,attribute:B,attributes:n.value,isAdmin:Y(),showHidden:u.value,i18n:Ne(o),"search-term":k.value,"mention-api":Ne(r).mentions,onRemove:O},null,8,["attribute","attributes","isAdmin","showHidden","i18n","search-term","mention-api"]))),128))]),_:1},8,["modelValue"]),i.value.length===0?(y(),x("div",{key:0,class:"w-full px-5 italic",innerHTML:g("filters.no_results")},null,8,Gn)):R("",!0)]),lt(Ke,{attributes:n.value,"visible-attributes":i.value,i18n:Ne(o),newAttributeID:C.value,max:Ne(r).max,onIncrementNewAttributeID:we},null,8,["attributes","visible-attributes","i18n","newAttributeID","max"])])),s.value?R("",!0):(y(),x("dialog",Wn,[p("header",zn,[p("h4",{innerHTML:g("templates.title")},null,8,qn),p("button",{autofocus:"",type:"button",class:"text-xl opacity-50 hover:opacity-100 focus:opacity-100 cursor-pointer text-decoration-none","aria-label":"Close",onClick:m[9]||(m[9]=B=>oe())},m[19]||(m[19]=[p("i",{class:"fa-regular fa-circle-xmark","aria-hidden":"true"},null,-1),p("span",{class:"sr-only"},"Close",-1)]))]),p("article",null,[p("label",{for:"template_id",innerHTML:g("templates.template")},null,8,Kn),Q(p("select",{"onUpdate:modelValue":m[10]||(m[10]=B=>_.value=B),class:"w-full",id:"template_id"},[(y(!0),x(ke,null,Be(Ne(a),(B,cn)=>(y(),x("optgroup",{label:cn},[(y(!0),x(ke,null,Be(B,(fn,hn)=>(y(),x("option",{value:hn,innerHTML:fn},null,8,Zn))),256))],8,Jn))),256))],512),[[zt,_.value]])]),p("footer",Qn,[p("menu",ei,[p("div",ti,[p("a",{role:"button",class:"btn2 btn-primary",onClick:m[11]||(m[11]=B=>ae()),innerHTML:g("templates.load")},null,8,ni)])])])]))],64)}}}),oi={class:"flex flex-wrap gap-2 md:gap-5 lg:gap-10 justify-center justify-items-stretch items-center lg:border lg:rounded bg-base-200 lg:bg-inherit p-2 lg:p-5 text-xs md:text-sm m-0 lg:m-5"},ri=["innerHTML"],ai=["innerHTML"],li=["innerHTML"],si=["innerHTML"],ui=["innerHTML"],di=["innerHTML"],ci=We({__name:"Form",props:{attributes:{},visibleAttributes:{},i18n:{},newAttributeID:{},max:{}},emits:["incrementNewAttributeID"],setup(t,{emit:e}){const n=t,i=U(!1),o=e,r=c=>{if(!c.includes("."))return c;let u=c.split(".");return n.i18n[u[0]][u[1]]},a=(c,u)=>{if(s(c))return;o("incrementNewAttributeID");let f={id:n.newAttributeID,name:"",value:"",is_deleted:!1,is_hidden:!1,is_pinned:!1,is_private:!1,is_checked:!1,is_section:u==="section",is_number:u==="number",is_multiline:u==="multiline",is_checkbox:u==="checkbox",is_random:u==="random"};n.attributes.push(f),n.visibleAttributes.push(f)},s=c=>{const u=c.target.closest("form"),f=u.getElementsByTagName("input"),E=u.getElementsByTagName("select"),k=u.getElementsByTagName("button"),_=Array.from(f).filter(I=>I.hasAttribute("name")),C=Array.from(E).filter(I=>I.hasAttribute("name")),F=Array.from(k).filter(I=>I.hasAttribute("name")),g=_.length+C.length+F.length;return g>=n.max-1?(window.showToast(n.i18n.toasts.max_reached.replace(/:count/,g),"error"),!0):!1},d=()=>{i.value=!i.value};return(c,u)=>(y(),x("div",oi,[i.value?(y(),x("div",{key:0,role:"button",onClick:u[0]||(u[0]=f=>a(f,"")),class:"flex flex-col gap-1 items-center hover:text-primary"},[u[8]||(u[8]=p("i",{class:"fa-solid fa-person text-xl md:text-2xl","aria-hidden":"true"},null,-1)),p("span",{innerHTML:r("types.attribute"),class:"text-xs"},null,8,ri)])):R("",!0),i.value?(y(),x("div",{key:1,role:"button",onClick:u[1]||(u[1]=f=>a(f,"multiline")),class:"flex flex-col gap-1 items-center hover:text-primary"},[u[9]||(u[9]=p("i",{class:"fa-solid fa-align-justify text-xl md:text-2xl","aria-hidden":"true"},null,-1)),p("span",{innerHTML:r("types.multiline"),class:"text-xs"},null,8,ai)])):R("",!0),i.value?(y(),x("div",{key:2,role:"button",onClick:u[2]||(u[2]=f=>a(f,"number")),class:"flex flex-col gap-1 items-center hover:text-primary"},[u[10]||(u[10]=p("i",{class:"fa-solid fa-hashtag text-xl md:text-2xl","aria-hidden":"true"},null,-1)),p("span",{innerHTML:r("types.number"),class:"text-xs"},null,8,li)])):R("",!0),i.value?(y(),x("div",{key:3,role:"button",onClick:u[3]||(u[3]=f=>d()),class:"rounded-full w-12 lg:w-16 h-12 lg:h-16 bg-primary text-primary-content text-2xl flex items-center justify-center shadow-md flex-none"},u[11]||(u[11]=[p("i",{class:"fa-solid fa-times","aria-hidden":"true"},null,-1),p("span",{class:"sr-only"},"Close new attribute form",-1)]))):R("",!0),i.value?(y(),x("div",{key:4,role:"button",onClick:u[4]||(u[4]=f=>a(f,"section")),class:"flex flex-col gap-1 items-center hover:text-primary"},[u[12]||(u[12]=p("i",{class:"fa-solid fa-layer-group text-xl md:text-2xl","aria-hidden":"true"},null,-1)),p("span",{innerHTML:r("types.section"),class:"text-xs"},null,8,si)])):R("",!0),i.value?(y(),x("div",{key:5,role:"button",onClick:u[5]||(u[5]=f=>a(f,"checkbox")),class:"flex flex-col gap-1 items-center hover:text-primary"},[u[13]||(u[13]=p("i",{class:"fa-regular fa-check-square text-xl md:text-2xl","aria-hidden":"true"},null,-1)),p("span",{innerHTML:r("types.checkbox"),class:"text-xs"},null,8,ui)])):R("",!0),i.value?(y(),x("div",{key:6,role:"button",onClick:u[6]||(u[6]=f=>a(f,"random")),class:"flex flex-col gap-1 items-center hover:text-primary"},[u[14]||(u[14]=p("i",{class:"fa-solid fa-question-circle text-xl md:text-2xl","aria-hidden":"true"},null,-1)),p("span",{innerHTML:r("types.random"),class:"text-xs truncate"},null,8,di)])):R("",!0),i.value?R("",!0):(y(),x("div",{key:7,role:"button",onClick:u[7]||(u[7]=f=>d()),class:"rounded-full w-12 lg:w-16 h-12 lg:h-16 bg-primary text-primary-content text-2xl flex items-center justify-center shadow-md"},u[15]||(u[15]=[p("i",{class:"fa-solid fa-plus","aria-hidden":"true"},null,-1),p("span",{class:"sr-only"},"Open new attribute form",-1)])))]))}}),fi={key:0,class:"basis-full w-full"},hi=["innerHTML"],pi={key:1,class:"w-6 md:w-8 pt-2"},mi={key:2,class:"w-6 md:w-8 pt-2"},gi={class:"w-6 md:w-8 pt-2"},vi=["value","placeholder"],bi={class:"grow flex flex-col md:flex-row gap-2"},wi={key:0,class:"grow"},yi=["id","placeholder"],_i={key:1,class:"md:w-40 flex-none bg-base-200 rounded flex items-center"},xi=["innerHTML"],Ei={key:2,class:"md:w-40 flex-none"},Ti={key:3,class:"grow"},Di={key:4,class:"grow flex items-center"},Ci=["id","placeholder"],Si={key:5,class:"grow relative"},ki=["id","placeholder","min","max"],Ii={key:6,class:"grow bg-base-200 rounded flex items-center select-none"},Ai=["innerHTML"],Mi={key:7,class:"grow"},Oi=["id"],Li=["value","innerHTML"],Ni={class:"flex text-xl gap-2 lg:text-base pt-2 flex-none"},Pi=["aria-label"],$i=["aria-label"],Hi=["aria-label","title"],Fi=["value"],Bi=We({__name:"Attribute",props:{attribute:{},attributes:{},i18n:{},isAdmin:{},showHidden:{},searchTerm:{},mentionApi:{}},emits:["remove"],setup(t,{emit:e}){const n=t,i=U(!1);Wt(()=>{L()});const o=l=>{if(!l.includes("."))return l;let v=l.split(".");return n.i18n[v[0]][v[1]]},r=l=>{if(n.searchTerm){let v=n.searchTerm.toLowerCase();if(!l.name.toLowerCase().includes(v)&&!(l.value&&l.value.toLowerCase().includes(v)))return"hidden"}return!n.showHidden&&l.is_hidden?"hidden":"flex gap-2 w-full px-4 "+(l.template?"flex-wrap":null)},a=l=>l.is_checkbox?o("placeholders.checkbox_name"):l.is_section?o("placeholders.section_name"):l.is_multiline?o("placeholders.multiline_name"):o("placeholders.name"),s=l=>o("placeholders.value"),d=l=>l.is_checkbox?3:l.is_multiline?2:l.is_section?4:l.is_random?5:l.is_number?6:1,c=l=>l.is_pinned?"fa-solid fa-thumbtack rotate-45 transition-all":"fa-regular fa-thumbtack transition-all",u=l=>l.is_pinned?"Pinned":"Unpinned",f=l=>{l.is_pinned=!l.is_pinned},E=l=>l.is_private?"fa-solid fa-lock-keyhole":"fa-regular fa-unlock-keyhole",k=l=>l.is_private?"Private":"Public",_=l=>{l.is_private=!l.is_private},C=l=>l.is_hidden||l.name==="_layout",F=l=>JSON.stringify({id:l.id,name:l.name,value:l.value,type:d(l),is_private:l.is_private,is_pinned:l.is_pinned,is_hidden:l.is_hidden,source_id:l.source_id}),g=l=>{const v=/\[range:(\d+),(\d+)\]/,P=l.name.match(v);return P?parseInt(P[1]):null},I=l=>{const v=/\[range:(\d+),(\d+)\]/,P=l.name.match(v);return P?parseInt(P[2]):null},L=()=>{const l=/\[range:(.*)+\]/;n.attribute.name.match(l)?i.value=!0:i.value=!1},O=l=>{const v=/\[range:(.*)+\]/,P=l.name.match(v);let S=[];return P&&(S=P[1].split(",").map(Y=>Y.trim()).map(Y=>j(Y)),S.unshift([])),S},j=l=>{const v=/\{(.*)+\}/,P=l.match(v);if(!P)return l;const S=P[1],Y=n.attributes.filter(te=>te.name==S);return Y.length===0?l:Y[0].value.trim()};return(l,v)=>{const P=Ve("attributes-manager-mention-field");return y(),x("div",{class:Ae(r(l.attribute))},[l.attribute.template?(y(),x("div",fi,[p("p",{innerHTML:l.attribute.template.text,class:"text-neutral-content"},null,8,hi)])):R("",!0),l.attribute.is_hidden?(y(),x("div",mi,v[10]||(v[10]=[p("i",{class:"fa-solid fa-user-secret","aria-hidden":"true"},null,-1)]))):(y(),x("div",pi,v[9]||(v[9]=[p("i",{class:"fa-light fa-grip-vertical handle cursor-move","aria-hidden":"true"},null,-1)]))),p("div",gi,[Q(p("input",{type:"checkbox","onUpdate:modelValue":v[0]||(v[0]=S=>l.attribute.is_checked=S),tabindex:"-1",value:l.attribute.id,placeholder:a(l.attribute)},null,8,vi),[[at,l.attribute.is_checked]])]),p("div",bi,[l.attribute.is_section?(y(),x("div",wi,[Q(p("input",{type:"text",class:"w-full","onUpdate:modelValue":v[1]||(v[1]=S=>l.attribute.name=S),id:"name-"+l.attribute.id,placeholder:a(l.attribute)},null,8,yi),[[Ge,l.attribute.name]])])):l.attribute.is_hidden?(y(),x("div",_i,[p("div",{class:"w-full break-normal px-2",innerHTML:l.attribute.name},null,8,xi)])):(y(),x("div",Ei,[lt(P,{attribute:l.attribute,placeholder:a(l.attribute),type:"text",property:"name",mentionApi:l.mentionApi,onFieldBlur:v[2]||(v[2]=S=>L())},null,8,["attribute","placeholder","mentionApi"])])),l.attribute.is_multiline?(y(),x("div",Ti,[lt(P,{attribute:l.attribute,placeholder:s(l.attribute),type:"textarea",property:"value",mentionApi:l.mentionApi},null,8,["attribute","placeholder","mentionApi"])])):l.attribute.is_checkbox?(y(),x("div",Di,[Q(p("input",{type:"checkbox","onUpdate:modelValue":v[3]||(v[3]=S=>l.attribute.value=S),id:"value-"+l.attribute.id,placeholder:s(l.attribute)},null,8,Ci),[[at,l.attribute.value]])])):l.attribute.is_number?(y(),x("div",Si,[Q(p("input",{type:"number",class:"w-full","onUpdate:modelValue":v[4]||(v[4]=S=>l.attribute.value=S),id:"value-"+l.attribute.id,placeholder:s(l.attribute),min:g(l.attribute),max:I(l.attribute)},null,8,ki),[[Ge,l.attribute.value]])])):C(l.attribute)?(y(),x("div",Ii,[p("div",{class:"w-full break-normal px-2",innerHTML:l.attribute.value},null,8,Ai)])):l.attribute.is_section?R("",!0):(y(),x("div",Mi,[i.value?Q((y(),x("select",{key:1,class:"w-full","onUpdate:modelValue":v[5]||(v[5]=S=>l.attribute.value=S),id:"value-"+l.attribute.id},[(y(!0),x(ke,null,Be(O(l.attribute),(S,Y)=>(y(),x("option",{key:Y,value:S,innerHTML:S},null,8,Li))),128))],8,Oi)),[[zt,l.attribute.value]]):(y(),Kt(P,{key:0,attribute:l.attribute,placeholder:s(l.attribute),type:"text",property:"value",mentionApi:l.mentionApi},null,8,["attribute","placeholder","mentionApi"]))]))]),p("div",Ni,[l.attribute.is_hidden?R("",!0):(y(),x("a",{key:0,role:"button",onClick:v[6]||(v[6]=S=>f(l.attribute)),class:"w-6 lg:w-16 text-center inline-block cursor-pointer text-base-content hover:text-accent"},[p("i",{class:Ae(c(l.attribute)),"aria-label":u(l.attribute)},null,10,Pi)])),n.isAdmin&&!l.attribute.is_hidden?(y(),x("a",{key:1,role:"button",onClick:v[7]||(v[7]=S=>_(l.attribute)),class:"w-6 lg:w-16 inline-block text-center cursor-pointer text-base-content hover:text-accent"},[p("i",{class:Ae(E(l.attribute)),"aria-label":k(l.attribute)},null,10,$i)])):R("",!0),l.attribute.is_hidden?R("",!0):(y(),x("a",{key:2,role:"button",class:"w-6 lg:w-16 inline-block text-center flex-none cursor-pointer hover:text-error text-base-content",onClick:v[8]||(v[8]=S=>l.$emit("remove",l.attribute))},[p("i",{class:"fa-regular fa-trash-can","aria-label":o("columns.delete"),title:o("columns.delete")},null,8,Hi)]))]),p("input",{type:"hidden",name:"attribute[]",value:F(l.attribute)},null,8,Fi)],2)}}}),Vi={class:"relative"},Ri=["id","placeholder","onKeydown"],ji=["id","placeholder","onKeydown"],Xi={key:2,class:"absolute w-full left-0 bg-base-100 shadow list-none p-2 m-0 z-[1000]"},Yi=["onClick","innerHTML"],Ui=We({__name:"MentionField",props:{attribute:{},placeholder:{},type:{},property:{},mentionApi:{}},emits:["update:modelValue","field-blur"],setup(t,{emit:e}){const n=t,i=U([]),o=U(-1),r=U(null),a=U(null),s=e,d=g=>{const I=g.target.value,L=g.target.selectionStart,j=I.substring(0,L).match(/@(\w{3,})$/);if(r.value=g.target.dataset.type,j){let l=n.mentionApi+"?q="+j[1];fetch(l).then(v=>v.json()).then(v=>{i.value=v,o.value=0})}else i.value=[]},c=()=>{o.value<i.value.length-1?o.value++:i.value.length>0&&(o.value=0)},u=()=>{o.value>0?o.value--:i.value.length>0&&(o.value=i.value.length-1)},f=g=>{i.value.length>0&&o.value>=0&&(g.preventDefault(),E())},E=()=>{o.value>=0&&o.value<i.value.length&&C(i.value[o.value])},k=g=>g===o.value?"p-1 bg-primary text-primary-content":"p-1",_=()=>{i.value=[],o.value=-1},C=g=>{const I=a.value.selectionStart,L=n.attribute[n.property].substring(0,I),O=L.match(/@(\w{3,})$/);if(O){const j=`@${O[1]}`,l=L.lastIndexOf(j),v=`[${g.model_type}:${g.id}] `;n.attribute[n.property]=n.attribute[n.property].replace(j,v),i.value=[],o.value=-1,gn(()=>{a.value.setSelectionRange(l+v.length,l+v.length),a.value.focus()})}},F=()=>{s("field-blur")};return(g,I)=>{const L=qt("click-outside");return y(),x("div",Vi,[g.type==="text"?Q((y(),x("input",{key:0,type:"text",class:"w-full","onUpdate:modelValue":I[0]||(I[0]=O=>g.attribute[g.property]=O),id:g.property+"-"+g.attribute.id,placeholder:g.placeholder,onInput:d,ref_key:"textarea",ref:a,onKeydown:[he(Pe(c,["prevent"]),["down"]),he(Pe(u,["prevent"]),["up"]),he(Pe(E,["prevent"]),["enter"]),he(_,["esc"])],onBlur:F},null,40,Ri)),[[Ge,g.attribute[g.property]]]):g.type==="textarea"?Q((y(),x("textarea",{key:1,type:"text",class:"w-full","onUpdate:modelValue":I[1]||(I[1]=O=>g.attribute[g.property]=O),id:g.property+"-"+g.attribute.id,placeholder:g.placeholder,onInput:d,rows:"3",ref_key:"textarea",ref:a,onKeydown:[he(Pe(c,["prevent"]),["down"]),he(Pe(u,["prevent"]),["up"]),he(f,["enter"]),he(_,["esc"])],onBlur:F},null,40,ji)),[[Ge,g.attribute[g.property]]]):R("",!0),i.value.length?Q((y(),x("ul",Xi,[(y(!0),x(ke,null,Be(i.value,(O,j)=>(y(),x("li",{key:O.id,class:Ae(k(j)),onClick:l=>C(O),innerHTML:O.name},null,10,Yi))),128))])),[[L,_]]):R("",!0)])}}});/*!
  * vue-draggable-next v2.2.0
  * (c) 2023 Anish George
  * @license MIT
  *//**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function $t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,i)}return n}function ue(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?$t(Object(n),!0).forEach(function(i){Gi(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$t(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function tt(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?tt=function(e){return typeof e}:tt=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(t)}function Gi(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ce(){return ce=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ce.apply(this,arguments)}function Wi(t,e){if(t==null)return{};var n={},i=Object.keys(t),o,r;for(r=0;r<i.length;r++)o=i[r],!(e.indexOf(o)>=0)&&(n[o]=t[o]);return n}function zi(t,e){if(t==null)return{};var n=Wi(t,e),i,o;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}var qi="1.14.0";function de(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var fe=de(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),ze=de(/Edge/i),Ht=de(/firefox/i),Re=de(/safari/i)&&!de(/chrome/i)&&!de(/android/i),Jt=de(/iP(ad|od|hone)/i),Ki=de(/chrome/i)&&de(/android/i),Zt={capture:!1,passive:!1};function M(t,e,n){t.addEventListener(e,n,!fe&&Zt)}function A(t,e,n){t.removeEventListener(e,n,!fe&&Zt)}function st(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function Ji(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function le(t,e,n,i){if(t){n=n||document;do{if(e!=null&&(e[0]===">"?t.parentNode===n&&st(t,e):st(t,e))||i&&t===n)return t;if(t===n)break}while(t=Ji(t))}return null}var Ft=/\s+/g;function J(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var i=(" "+t.className+" ").replace(Ft," ").replace(" "+e+" "," ");t.className=(i+(n?" "+e:"")).replace(Ft," ")}}function b(t,e,n){var i=t&&t.style;if(i){if(n===void 0)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),e===void 0?n:n[e];!(e in i)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),i[e]=n+(typeof n=="string"?"":"px")}}function Me(t,e){var n="";if(typeof t=="string")n=t;else do{var i=b(t,"transform");i&&i!=="none"&&(n=i+" "+n)}while(!e&&(t=t.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function Qt(t,e,n){if(t){var i=t.getElementsByTagName(e),o=0,r=i.length;if(n)for(;o<r;o++)n(i[o],o);return i}return[]}function se(){var t=document.scrollingElement;return t||document.documentElement}function X(t,e,n,i,o){if(!(!t.getBoundingClientRect&&t!==window)){var r,a,s,d,c,u,f;if(t!==window&&t.parentNode&&t!==se()?(r=t.getBoundingClientRect(),a=r.top,s=r.left,d=r.bottom,c=r.right,u=r.height,f=r.width):(a=0,s=0,d=window.innerHeight,c=window.innerWidth,u=window.innerHeight,f=window.innerWidth),(e||n)&&t!==window&&(o=o||t.parentNode,!fe))do if(o&&o.getBoundingClientRect&&(b(o,"transform")!=="none"||n&&b(o,"position")!=="static")){var E=o.getBoundingClientRect();a-=E.top+parseInt(b(o,"border-top-width")),s-=E.left+parseInt(b(o,"border-left-width")),d=a+r.height,c=s+r.width;break}while(o=o.parentNode);if(i&&t!==window){var k=Me(o||t),_=k&&k.a,C=k&&k.d;k&&(a/=C,s/=_,f/=_,u/=C,d=a+u,c=s+f)}return{top:a,left:s,bottom:d,right:c,width:f,height:u}}}function Bt(t,e,n){for(var i=ge(t,!0),o=X(t)[e];i;){var r=X(i)[n],a=void 0;if(a=o>=r,!a)return i;if(i===se())break;i=ge(i,!1)}return!1}function Oe(t,e,n,i){for(var o=0,r=0,a=t.children;r<a.length;){if(a[r].style.display!=="none"&&a[r]!==w.ghost&&(i||a[r]!==w.dragged)&&le(a[r],n.draggable,t,!1)){if(o===e)return a[r];o++}r++}return null}function Ot(t,e){for(var n=t.lastElementChild;n&&(n===w.ghost||b(n,"display")==="none"||e&&!st(n,e));)n=n.previousElementSibling;return n||null}function ne(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==w.clone&&(!e||st(t,e))&&n++;return n}function Vt(t){var e=0,n=0,i=se();if(t)do{var o=Me(t),r=o.a,a=o.d;e+=t.scrollLeft*r,n+=t.scrollTop*a}while(t!==i&&(t=t.parentNode));return[e,n]}function Zi(t,e){for(var n in t)if(t.hasOwnProperty(n)){for(var i in e)if(e.hasOwnProperty(i)&&e[i]===t[n][i])return Number(n)}return-1}function ge(t,e){if(!t||!t.getBoundingClientRect)return se();var n=t,i=!1;do if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=b(n);if(n.clientWidth<n.scrollWidth&&(o.overflowX=="auto"||o.overflowX=="scroll")||n.clientHeight<n.scrollHeight&&(o.overflowY=="auto"||o.overflowY=="scroll")){if(!n.getBoundingClientRect||n===document.body)return se();if(i||e)return n;i=!0}}while(n=n.parentNode);return se()}function Qi(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function mt(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var je;function en(t,e){return function(){if(!je){var n=arguments,i=this;n.length===1?t.call(i,n[0]):t.apply(i,n),je=setTimeout(function(){je=void 0},e)}}}function eo(){clearTimeout(je),je=void 0}function tn(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function nn(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}var ee="Sortable"+new Date().getTime();function to(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var i=[].slice.call(this.el.children);i.forEach(function(o){if(!(b(o,"display")==="none"||o===w.ghost)){t.push({target:o,rect:X(o)});var r=ue({},t[t.length-1].rect);if(o.thisAnimationDuration){var a=Me(o,!0);a&&(r.top-=a.f,r.left-=a.e)}o.fromRect=r}})}},addAnimationState:function(i){t.push(i)},removeAnimationState:function(i){t.splice(Zi(t,{target:i}),1)},animateAll:function(i){var o=this;if(!this.options.animation){clearTimeout(e),typeof i=="function"&&i();return}var r=!1,a=0;t.forEach(function(s){var d=0,c=s.target,u=c.fromRect,f=X(c),E=c.prevFromRect,k=c.prevToRect,_=s.rect,C=Me(c,!0);C&&(f.top-=C.f,f.left-=C.e),c.toRect=f,c.thisAnimationDuration&&mt(E,f)&&!mt(u,f)&&(_.top-f.top)/(_.left-f.left)===(u.top-f.top)/(u.left-f.left)&&(d=io(_,E,k,o.options)),mt(f,u)||(c.prevFromRect=u,c.prevToRect=f,d||(d=o.options.animation),o.animate(c,_,f,d)),d&&(r=!0,a=Math.max(a,d),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},d),c.thisAnimationDuration=d)}),clearTimeout(e),r?e=setTimeout(function(){typeof i=="function"&&i()},a):typeof i=="function"&&i(),t=[]},animate:function(i,o,r,a){if(a){b(i,"transition",""),b(i,"transform","");var s=Me(this.el),d=s&&s.a,c=s&&s.d,u=(o.left-r.left)/(d||1),f=(o.top-r.top)/(c||1);i.animatingX=!!u,i.animatingY=!!f,b(i,"transform","translate3d("+u+"px,"+f+"px,0)"),this.forRepaintDummy=no(i),b(i,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),b(i,"transform","translate3d(0,0,0)"),typeof i.animated=="number"&&clearTimeout(i.animated),i.animated=setTimeout(function(){b(i,"transition",""),b(i,"transform",""),i.animated=!1,i.animatingX=!1,i.animatingY=!1},a)}}}}function no(t){return t.offsetWidth}function io(t,e,n,i){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*i.animation}var De=[],gt={initializeByDefault:!0},qe={mount:function(e){for(var n in gt)gt.hasOwnProperty(n)&&!(n in e)&&(e[n]=gt[n]);De.forEach(function(i){if(i.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),De.push(e)},pluginEvent:function(e,n,i){var o=this;this.eventCanceled=!1,i.cancel=function(){o.eventCanceled=!0};var r=e+"Global";De.forEach(function(a){n[a.pluginName]&&(n[a.pluginName][r]&&n[a.pluginName][r](ue({sortable:n},i)),n.options[a.pluginName]&&n[a.pluginName][e]&&n[a.pluginName][e](ue({sortable:n},i)))})},initializePlugins:function(e,n,i,o){De.forEach(function(s){var d=s.pluginName;if(!(!e.options[d]&&!s.initializeByDefault)){var c=new s(e,n,e.options);c.sortable=e,c.options=e.options,e[d]=c,ce(i,c.defaults)}});for(var r in e.options)if(e.options.hasOwnProperty(r)){var a=this.modifyOption(e,r,e.options[r]);typeof a<"u"&&(e.options[r]=a)}},getEventProperties:function(e,n){var i={};return De.forEach(function(o){typeof o.eventProperties=="function"&&ce(i,o.eventProperties.call(n[o.pluginName],e))}),i},modifyOption:function(e,n,i){var o;return De.forEach(function(r){e[r.pluginName]&&r.optionListeners&&typeof r.optionListeners[n]=="function"&&(o=r.optionListeners[n].call(e[r.pluginName],i))}),o}};function oo(t){var e=t.sortable,n=t.rootEl,i=t.name,o=t.targetEl,r=t.cloneEl,a=t.toEl,s=t.fromEl,d=t.oldIndex,c=t.newIndex,u=t.oldDraggableIndex,f=t.newDraggableIndex,E=t.originalEvent,k=t.putSortable,_=t.extraEventProperties;if(e=e||n&&n[ee],!!e){var C,F=e.options,g="on"+i.charAt(0).toUpperCase()+i.substr(1);window.CustomEvent&&!fe&&!ze?C=new CustomEvent(i,{bubbles:!0,cancelable:!0}):(C=document.createEvent("Event"),C.initEvent(i,!0,!0)),C.to=a||n,C.from=s||n,C.item=o||n,C.clone=r,C.oldIndex=d,C.newIndex=c,C.oldDraggableIndex=u,C.newDraggableIndex=f,C.originalEvent=E,C.pullMode=k?k.lastPutMode:void 0;var I=ue(ue({},_),qe.getEventProperties(i,e));for(var L in I)C[L]=I[L];n&&n.dispatchEvent(C),F[g]&&F[g].call(e,C)}}var ro=["evt"],K=function(e,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.evt,r=zi(i,ro);qe.pluginEvent.bind(w)(e,n,ue({dragEl:h,parentEl:$,ghostEl:D,rootEl:N,nextEl:xe,lastDownEl:nt,cloneEl:H,cloneHidden:me,dragStarted:$e,putSortable:G,activeSortable:w.active,originalEvent:o,oldIndex:Ie,oldDraggableIndex:Xe,newIndex:Z,newDraggableIndex:pe,hideGhostForTarget:ln,unhideGhostForTarget:sn,cloneNowHidden:function(){me=!0},cloneNowShown:function(){me=!1},dispatchSortableEvent:function(s){q({sortable:n,name:s,originalEvent:o})}},r))};function q(t){oo(ue({putSortable:G,cloneEl:H,targetEl:h,rootEl:N,oldIndex:Ie,oldDraggableIndex:Xe,newIndex:Z,newDraggableIndex:pe},t))}var h,$,D,N,xe,nt,H,me,Ie,Z,Xe,pe,Je,G,Se=!1,ut=!1,dt=[],ye,re,vt,bt,Rt,jt,$e,Ce,Ye,Ue=!1,Ze=!1,it,W,wt=[],Ct=!1,ct=[],ht=typeof document<"u",Qe=Jt,Xt=ze||fe?"cssFloat":"float",ao=ht&&!Ki&&!Jt&&"draggable"in document.createElement("div"),on=function(){if(ht){if(fe)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),rn=function(e,n){var i=b(e),o=parseInt(i.width)-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-parseInt(i.borderLeftWidth)-parseInt(i.borderRightWidth),r=Oe(e,0,n),a=Oe(e,1,n),s=r&&b(r),d=a&&b(a),c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+X(r).width,u=d&&parseInt(d.marginLeft)+parseInt(d.marginRight)+X(a).width;if(i.display==="flex")return i.flexDirection==="column"||i.flexDirection==="column-reverse"?"vertical":"horizontal";if(i.display==="grid")return i.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&s.float&&s.float!=="none"){var f=s.float==="left"?"left":"right";return a&&(d.clear==="both"||d.clear===f)?"vertical":"horizontal"}return r&&(s.display==="block"||s.display==="flex"||s.display==="table"||s.display==="grid"||c>=o&&i[Xt]==="none"||a&&i[Xt]==="none"&&c+u>o)?"vertical":"horizontal"},lo=function(e,n,i){var o=i?e.left:e.top,r=i?e.right:e.bottom,a=i?e.width:e.height,s=i?n.left:n.top,d=i?n.right:n.bottom,c=i?n.width:n.height;return o===s||r===d||o+a/2===s+c/2},so=function(e,n){var i;return dt.some(function(o){var r=o[ee].options.emptyInsertThreshold;if(!(!r||Ot(o))){var a=X(o),s=e>=a.left-r&&e<=a.right+r,d=n>=a.top-r&&n<=a.bottom+r;if(s&&d)return i=o}}),i},an=function(e){function n(r,a){return function(s,d,c,u){var f=s.options.group.name&&d.options.group.name&&s.options.group.name===d.options.group.name;if(r==null&&(a||f))return!0;if(r==null||r===!1)return!1;if(a&&r==="clone")return r;if(typeof r=="function")return n(r(s,d,c,u),a)(s,d,c,u);var E=(a?s:d).options.group.name;return r===!0||typeof r=="string"&&r===E||r.join&&r.indexOf(E)>-1}}var i={},o=e.group;(!o||tt(o)!="object")&&(o={name:o}),i.name=o.name,i.checkPull=n(o.pull,!0),i.checkPut=n(o.put),i.revertClone=o.revertClone,e.group=i},ln=function(){!on&&D&&b(D,"display","none")},sn=function(){!on&&D&&b(D,"display","")};ht&&document.addEventListener("click",function(t){if(ut)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),ut=!1,!1},!0);var _e=function(e){if(h){e=e.touches?e.touches[0]:e;var n=so(e.clientX,e.clientY);if(n){var i={};for(var o in e)e.hasOwnProperty(o)&&(i[o]=e[o]);i.target=i.rootEl=n,i.preventDefault=void 0,i.stopPropagation=void 0,n[ee]._onDragOver(i)}}},uo=function(e){h&&h.parentNode[ee]._isOutsideThisEl(e.target)};function w(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=ce({},e),t[ee]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return rn(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,s){a.setData("Text",s.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:w.supportPointer!==!1&&"PointerEvent"in window&&!Re,emptyInsertThreshold:5};qe.initializePlugins(this,t,n);for(var i in n)!(i in e)&&(e[i]=n[i]);an(e);for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));this.nativeDraggable=e.forceFallback?!1:ao,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?M(t,"pointerdown",this._onTapStart):(M(t,"mousedown",this._onTapStart),M(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(M(t,"dragover",this),M(t,"dragenter",this)),dt.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),ce(this,to())}w.prototype={constructor:w,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Ce=null)},_getDirection:function(e,n){return typeof this.options.direction=="function"?this.options.direction.call(this,e,n,h):this.options.direction},_onTapStart:function(e){if(e.cancelable){var n=this,i=this.el,o=this.options,r=o.preventOnFilter,a=e.type,s=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,d=(s||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||d,u=o.filter;if(bo(i),!h&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||o.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&Re&&d&&d.tagName.toUpperCase()==="SELECT")&&(d=le(d,o.draggable,i,!1),!(d&&d.animated)&&nt!==d)){if(Ie=ne(d),Xe=ne(d,o.draggable),typeof u=="function"){if(u.call(this,e,d,this)){q({sortable:n,rootEl:c,name:"filter",targetEl:d,toEl:i,fromEl:i}),K("filter",n,{evt:e}),r&&e.cancelable&&e.preventDefault();return}}else if(u&&(u=u.split(",").some(function(f){if(f=le(c,f.trim(),i,!1),f)return q({sortable:n,rootEl:f,name:"filter",targetEl:d,fromEl:i,toEl:i}),K("filter",n,{evt:e}),!0}),u)){r&&e.cancelable&&e.preventDefault();return}o.handle&&!le(c,o.handle,i,!1)||this._prepareDragStart(e,s,d)}}},_prepareDragStart:function(e,n,i){var o=this,r=o.el,a=o.options,s=r.ownerDocument,d;if(i&&!h&&i.parentNode===r){var c=X(i);if(N=r,h=i,$=h.parentNode,xe=h.nextSibling,nt=i,Je=a.group,w.dragged=h,ye={target:h,clientX:(n||e).clientX,clientY:(n||e).clientY},Rt=ye.clientX-c.left,jt=ye.clientY-c.top,this._lastX=(n||e).clientX,this._lastY=(n||e).clientY,h.style["will-change"]="all",d=function(){if(K("delayEnded",o,{evt:e}),w.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!Ht&&o.nativeDraggable&&(h.draggable=!0),o._triggerDragStart(e,n),q({sortable:o,name:"choose",originalEvent:e}),J(h,a.chosenClass,!0)},a.ignore.split(",").forEach(function(u){Qt(h,u.trim(),yt)}),M(s,"dragover",_e),M(s,"mousemove",_e),M(s,"touchmove",_e),M(s,"mouseup",o._onDrop),M(s,"touchend",o._onDrop),M(s,"touchcancel",o._onDrop),Ht&&this.nativeDraggable&&(this.options.touchStartThreshold=4,h.draggable=!0),K("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||n)&&(!this.nativeDraggable||!(ze||fe))){if(w.eventCanceled){this._onDrop();return}M(s,"mouseup",o._disableDelayedDrag),M(s,"touchend",o._disableDelayedDrag),M(s,"touchcancel",o._disableDelayedDrag),M(s,"mousemove",o._delayedDragTouchMoveHandler),M(s,"touchmove",o._delayedDragTouchMoveHandler),a.supportPointer&&M(s,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(d,a.delay)}else d()}},_delayedDragTouchMoveHandler:function(e){var n=e.touches?e.touches[0]:e;Math.max(Math.abs(n.clientX-this._lastX),Math.abs(n.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){h&&yt(h),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;A(e,"mouseup",this._disableDelayedDrag),A(e,"touchend",this._disableDelayedDrag),A(e,"touchcancel",this._disableDelayedDrag),A(e,"mousemove",this._delayedDragTouchMoveHandler),A(e,"touchmove",this._delayedDragTouchMoveHandler),A(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,n){n=n||e.pointerType=="touch"&&e,!this.nativeDraggable||n?this.options.supportPointer?M(document,"pointermove",this._onTouchMove):n?M(document,"touchmove",this._onTouchMove):M(document,"mousemove",this._onTouchMove):(M(h,"dragend",this),M(N,"dragstart",this._onDragStart));try{document.selection?ot(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,n){if(Se=!1,N&&h){K("dragStarted",this,{evt:n}),this.nativeDraggable&&M(document,"dragover",uo);var i=this.options;!e&&J(h,i.dragClass,!1),J(h,i.ghostClass,!0),w.active=this,e&&this._appendGhost(),q({sortable:this,name:"start",originalEvent:n})}else this._nulling()},_emulateDragOver:function(){if(re){this._lastX=re.clientX,this._lastY=re.clientY,ln();for(var e=document.elementFromPoint(re.clientX,re.clientY),n=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(re.clientX,re.clientY),e!==n);)n=e;if(h.parentNode[ee]._isOutsideThisEl(e),n)do{if(n[ee]){var i=void 0;if(i=n[ee]._onDragOver({clientX:re.clientX,clientY:re.clientY,target:e,rootEl:n}),i&&!this.options.dragoverBubble)break}e=n}while(n=n.parentNode);sn()}},_onTouchMove:function(e){if(ye){var n=this.options,i=n.fallbackTolerance,o=n.fallbackOffset,r=e.touches?e.touches[0]:e,a=D&&Me(D,!0),s=D&&a&&a.a,d=D&&a&&a.d,c=Qe&&W&&Vt(W),u=(r.clientX-ye.clientX+o.x)/(s||1)+(c?c[0]-wt[0]:0)/(s||1),f=(r.clientY-ye.clientY+o.y)/(d||1)+(c?c[1]-wt[1]:0)/(d||1);if(!w.active&&!Se){if(i&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<i)return;this._onDragStart(e,!0)}if(D){a?(a.e+=u-(vt||0),a.f+=f-(bt||0)):a={a:1,b:0,c:0,d:1,e:u,f};var E="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");b(D,"webkitTransform",E),b(D,"mozTransform",E),b(D,"msTransform",E),b(D,"transform",E),vt=u,bt=f,re=r}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!D){var e=this.options.fallbackOnBody?document.body:N,n=X(h,!0,Qe,!0,e),i=this.options;if(Qe){for(W=e;b(W,"position")==="static"&&b(W,"transform")==="none"&&W!==document;)W=W.parentNode;W!==document.body&&W!==document.documentElement?(W===document&&(W=se()),n.top+=W.scrollTop,n.left+=W.scrollLeft):W=se(),wt=Vt(W)}D=h.cloneNode(!0),J(D,i.ghostClass,!1),J(D,i.fallbackClass,!0),J(D,i.dragClass,!0),b(D,"transition",""),b(D,"transform",""),b(D,"box-sizing","border-box"),b(D,"margin",0),b(D,"top",n.top),b(D,"left",n.left),b(D,"width",n.width),b(D,"height",n.height),b(D,"opacity","0.8"),b(D,"position",Qe?"absolute":"fixed"),b(D,"zIndex","100000"),b(D,"pointerEvents","none"),w.ghost=D,e.appendChild(D),b(D,"transform-origin",Rt/parseInt(D.style.width)*100+"% "+jt/parseInt(D.style.height)*100+"%")}},_onDragStart:function(e,n){var i=this,o=e.dataTransfer,r=i.options;if(K("dragStart",this,{evt:e}),w.eventCanceled){this._onDrop();return}K("setupClone",this),w.eventCanceled||(H=nn(h),H.draggable=!1,H.style["will-change"]="",this._hideClone(),J(H,this.options.chosenClass,!1),w.clone=H),i.cloneId=ot(function(){K("clone",i),!w.eventCanceled&&(i.options.removeCloneOnHide||N.insertBefore(H,h),i._hideClone(),q({sortable:i,name:"clone"}))}),!n&&J(h,r.dragClass,!0),n?(ut=!0,i._loopId=setInterval(i._emulateDragOver,50)):(A(document,"mouseup",i._onDrop),A(document,"touchend",i._onDrop),A(document,"touchcancel",i._onDrop),o&&(o.effectAllowed="move",r.setData&&r.setData.call(i,o,h)),M(document,"drop",i),b(h,"transform","translateZ(0)")),Se=!0,i._dragStartId=ot(i._dragStarted.bind(i,n,e)),M(document,"selectstart",i),$e=!0,Re&&b(document.body,"user-select","none")},_onDragOver:function(e){var n=this.el,i=e.target,o,r,a,s=this.options,d=s.group,c=w.active,u=Je===d,f=s.sort,E=G||c,k,_=this,C=!1;if(Ct)return;function F(we,T){K(we,_,ue({evt:e,isOwner:u,axis:k?"vertical":"horizontal",revert:a,dragRect:o,targetRect:r,canSort:f,fromSortable:E,target:i,completed:I,onMove:function(z,Le){return et(N,n,h,o,z,X(z),e,Le)},changed:L},T))}function g(){F("dragOverAnimationCapture"),_.captureAnimationState(),_!==E&&E.captureAnimationState()}function I(we){return F("dragOverCompleted",{insertion:we}),we&&(u?c._hideClone():c._showClone(_),_!==E&&(J(h,G?G.options.ghostClass:c.options.ghostClass,!1),J(h,s.ghostClass,!0)),G!==_&&_!==w.active?G=_:_===w.active&&G&&(G=null),E===_&&(_._ignoreWhileAnimating=i),_.animateAll(function(){F("dragOverAnimationComplete"),_._ignoreWhileAnimating=null}),_!==E&&(E.animateAll(),E._ignoreWhileAnimating=null)),(i===h&&!h.animated||i===n&&!i.animated)&&(Ce=null),!s.dragoverBubble&&!e.rootEl&&i!==document&&(h.parentNode[ee]._isOutsideThisEl(e.target),!we&&_e(e)),!s.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),C=!0}function L(){Z=ne(h),pe=ne(h,s.draggable),q({sortable:_,name:"change",toEl:n,newIndex:Z,newDraggableIndex:pe,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),i=le(i,s.draggable,n,!0),F("dragOver"),w.eventCanceled)return C;if(h.contains(e.target)||i.animated&&i.animatingX&&i.animatingY||_._ignoreWhileAnimating===i)return I(!1);if(ut=!1,c&&!s.disabled&&(u?f||(a=$!==N):G===this||(this.lastPutMode=Je.checkPull(this,c,h,e))&&d.checkPut(this,c,h,e))){if(k=this._getDirection(e,i)==="vertical",o=X(h),F("dragOverValid"),w.eventCanceled)return C;if(a)return $=N,g(),this._hideClone(),F("revert"),w.eventCanceled||(xe?N.insertBefore(h,xe):N.appendChild(h)),I(!0);var O=Ot(n,s.draggable);if(!O||po(e,k,this)&&!O.animated){if(O===h)return I(!1);if(O&&n===e.target&&(i=O),i&&(r=X(i)),et(N,n,h,o,i,r,e,!!i)!==!1)return g(),n.appendChild(h),$=n,L(),I(!0)}else if(O&&ho(e,k,this)){var j=Oe(n,0,s,!0);if(j===h)return I(!1);if(i=j,r=X(i),et(N,n,h,o,i,r,e,!1)!==!1)return g(),n.insertBefore(h,j),$=n,L(),I(!0)}else if(i.parentNode===n){r=X(i);var l=0,v,P=h.parentNode!==n,S=!lo(h.animated&&h.toRect||o,i.animated&&i.toRect||r,k),Y=k?"top":"left",te=Bt(i,"top","top")||Bt(h,"top","top"),ve=te?te.scrollTop:void 0;Ce!==i&&(v=r[Y],Ue=!1,Ze=!S&&s.invertSwap||P),l=mo(e,i,r,k,S?1:s.swapThreshold,s.invertedSwapThreshold==null?s.swapThreshold:s.invertedSwapThreshold,Ze,Ce===i);var ie;if(l!==0){var oe=ne(h);do oe-=l,ie=$.children[oe];while(ie&&(b(ie,"display")==="none"||ie===D))}if(l===0||ie===i)return I(!1);Ce=i,Ye=l;var be=i.nextElementSibling,ae=!1;ae=l===1;var Te=et(N,n,h,o,i,r,e,ae);if(Te!==!1)return(Te===1||Te===-1)&&(ae=Te===1),Ct=!0,setTimeout(fo,30),g(),ae&&!be?n.appendChild(h):i.parentNode.insertBefore(h,ae?be:i),te&&tn(te,0,ve-te.scrollTop),$=h.parentNode,v!==void 0&&!Ze&&(it=Math.abs(v-X(i)[Y])),L(),I(!0)}if(n.contains(h))return I(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){A(document,"mousemove",this._onTouchMove),A(document,"touchmove",this._onTouchMove),A(document,"pointermove",this._onTouchMove),A(document,"dragover",_e),A(document,"mousemove",_e),A(document,"touchmove",_e)},_offUpEvents:function(){var e=this.el.ownerDocument;A(e,"mouseup",this._onDrop),A(e,"touchend",this._onDrop),A(e,"pointerup",this._onDrop),A(e,"touchcancel",this._onDrop),A(document,"selectstart",this)},_onDrop:function(e){var n=this.el,i=this.options;if(Z=ne(h),pe=ne(h,i.draggable),K("drop",this,{evt:e}),$=h&&h.parentNode,Z=ne(h),pe=ne(h,i.draggable),w.eventCanceled){this._nulling();return}Se=!1,Ze=!1,Ue=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),St(this.cloneId),St(this._dragStartId),this.nativeDraggable&&(A(document,"drop",this),A(n,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Re&&b(document.body,"user-select",""),b(h,"transform",""),e&&($e&&(e.cancelable&&e.preventDefault(),!i.dropBubble&&e.stopPropagation()),D&&D.parentNode&&D.parentNode.removeChild(D),(N===$||G&&G.lastPutMode!=="clone")&&H&&H.parentNode&&H.parentNode.removeChild(H),h&&(this.nativeDraggable&&A(h,"dragend",this),yt(h),h.style["will-change"]="",$e&&!Se&&J(h,G?G.options.ghostClass:this.options.ghostClass,!1),J(h,this.options.chosenClass,!1),q({sortable:this,name:"unchoose",toEl:$,newIndex:null,newDraggableIndex:null,originalEvent:e}),N!==$?(Z>=0&&(q({rootEl:$,name:"add",toEl:$,fromEl:N,originalEvent:e}),q({sortable:this,name:"remove",toEl:$,originalEvent:e}),q({rootEl:$,name:"sort",toEl:$,fromEl:N,originalEvent:e}),q({sortable:this,name:"sort",toEl:$,originalEvent:e})),G&&G.save()):Z!==Ie&&Z>=0&&(q({sortable:this,name:"update",toEl:$,originalEvent:e}),q({sortable:this,name:"sort",toEl:$,originalEvent:e})),w.active&&((Z==null||Z===-1)&&(Z=Ie,pe=Xe),q({sortable:this,name:"end",toEl:$,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){K("nulling",this),N=h=$=D=xe=H=nt=me=ye=re=$e=Z=pe=Ie=Xe=Ce=Ye=G=Je=w.dragged=w.ghost=w.clone=w.active=null,ct.forEach(function(e){e.checked=!0}),ct.length=vt=bt=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":h&&(this._onDragOver(e),co(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],n,i=this.el.children,o=0,r=i.length,a=this.options;o<r;o++)n=i[o],le(n,a.draggable,this.el,!1)&&e.push(n.getAttribute(a.dataIdAttr)||vo(n));return e},sort:function(e,n){var i={},o=this.el;this.toArray().forEach(function(r,a){var s=o.children[a];le(s,this.options.draggable,o,!1)&&(i[r]=s)},this),n&&this.captureAnimationState(),e.forEach(function(r){i[r]&&(o.removeChild(i[r]),o.appendChild(i[r]))}),n&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,n){return le(e,n||this.options.draggable,this.el,!1)},option:function(e,n){var i=this.options;if(n===void 0)return i[e];var o=qe.modifyOption(this,e,n);typeof o<"u"?i[e]=o:i[e]=n,e==="group"&&an(i)},destroy:function(){K("destroy",this);var e=this.el;e[ee]=null,A(e,"mousedown",this._onTapStart),A(e,"touchstart",this._onTapStart),A(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(A(e,"dragover",this),A(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(n){n.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),dt.splice(dt.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!me){if(K("hideClone",this),w.eventCanceled)return;b(H,"display","none"),this.options.removeCloneOnHide&&H.parentNode&&H.parentNode.removeChild(H),me=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(me){if(K("showClone",this),w.eventCanceled)return;h.parentNode==N&&!this.options.group.revertClone?N.insertBefore(H,h):xe?N.insertBefore(H,xe):N.appendChild(H),this.options.group.revertClone&&this.animate(h,H),b(H,"display",""),me=!1}}};function co(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function et(t,e,n,i,o,r,a,s){var d,c=t[ee],u=c.options.onMove,f;return window.CustomEvent&&!fe&&!ze?d=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(d=document.createEvent("Event"),d.initEvent("move",!0,!0)),d.to=e,d.from=t,d.dragged=n,d.draggedRect=i,d.related=o||e,d.relatedRect=r||X(e),d.willInsertAfter=s,d.originalEvent=a,t.dispatchEvent(d),u&&(f=u.call(c,d,a)),f}function yt(t){t.draggable=!1}function fo(){Ct=!1}function ho(t,e,n){var i=X(Oe(n.el,0,n.options,!0)),o=10;return e?t.clientX<i.left-o||t.clientY<i.top&&t.clientX<i.right:t.clientY<i.top-o||t.clientY<i.bottom&&t.clientX<i.left}function po(t,e,n){var i=X(Ot(n.el,n.options.draggable)),o=10;return e?t.clientX>i.right+o||t.clientX<=i.right&&t.clientY>i.bottom&&t.clientX>=i.left:t.clientX>i.right&&t.clientY>i.top||t.clientX<=i.right&&t.clientY>i.bottom+o}function mo(t,e,n,i,o,r,a,s){var d=i?t.clientY:t.clientX,c=i?n.height:n.width,u=i?n.top:n.left,f=i?n.bottom:n.right,E=!1;if(!a){if(s&&it<c*o){if(!Ue&&(Ye===1?d>u+c*r/2:d<f-c*r/2)&&(Ue=!0),Ue)E=!0;else if(Ye===1?d<u+it:d>f-it)return-Ye}else if(d>u+c*(1-o)/2&&d<f-c*(1-o)/2)return go(e)}return E=E||a,E&&(d<u+c*r/2||d>f-c*r/2)?d>u+c/2?1:-1:0}function go(t){return ne(h)<ne(t)?1:-1}function vo(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,i=0;n--;)i+=e.charCodeAt(n);return i.toString(36)}function bo(t){ct.length=0;for(var e=t.getElementsByTagName("input"),n=e.length;n--;){var i=e[n];i.checked&&ct.push(i)}}function ot(t){return setTimeout(t,0)}function St(t){return clearTimeout(t)}ht&&M(document,"touchmove",function(t){(w.active||Se)&&t.cancelable&&t.preventDefault()});w.utils={on:M,off:A,css:b,find:Qt,is:function(e,n){return!!le(e,n,e,!1)},extend:Qi,throttle:en,closest:le,toggleClass:J,clone:nn,index:ne,nextTick:ot,cancelNextTick:St,detectDirection:rn,getChild:Oe};w.get=function(t){return t[ee]};w.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach(function(i){if(!i.prototype||!i.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(i));i.utils&&(w.utils=ue(ue({},w.utils),i.utils)),qe.mount(i)})};w.create=function(t,e){return new w(t,e)};w.version=qi;var V=[],He,kt,It=!1,_t,xt,ft,Fe;function wo(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(n){var i=n.originalEvent;this.sortable.nativeDraggable?M(document,"dragover",this._handleAutoScroll):this.options.supportPointer?M(document,"pointermove",this._handleFallbackAutoScroll):i.touches?M(document,"touchmove",this._handleFallbackAutoScroll):M(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(n){var i=n.originalEvent;!this.options.dragOverBubble&&!i.rootEl&&this._handleAutoScroll(i)},drop:function(){this.sortable.nativeDraggable?A(document,"dragover",this._handleAutoScroll):(A(document,"pointermove",this._handleFallbackAutoScroll),A(document,"touchmove",this._handleFallbackAutoScroll),A(document,"mousemove",this._handleFallbackAutoScroll)),Yt(),rt(),eo()},nulling:function(){ft=kt=He=It=Fe=_t=xt=null,V.length=0},_handleFallbackAutoScroll:function(n){this._handleAutoScroll(n,!0)},_handleAutoScroll:function(n,i){var o=this,r=(n.touches?n.touches[0]:n).clientX,a=(n.touches?n.touches[0]:n).clientY,s=document.elementFromPoint(r,a);if(ft=n,i||this.options.forceAutoScrollFallback||ze||fe||Re){Et(n,this.options,s,i);var d=ge(s,!0);It&&(!Fe||r!==_t||a!==xt)&&(Fe&&Yt(),Fe=setInterval(function(){var c=ge(document.elementFromPoint(r,a),!0);c!==d&&(d=c,rt()),Et(n,o.options,c,i)},10),_t=r,xt=a)}else{if(!this.options.bubbleScroll||ge(s,!0)===se()){rt();return}Et(n,this.options,ge(s,!1),!1)}}},ce(t,{pluginName:"scroll",initializeByDefault:!0})}function rt(){V.forEach(function(t){clearInterval(t.pid)}),V=[]}function Yt(){clearInterval(Fe)}var Et=en(function(t,e,n,i){if(e.scroll){var o=(t.touches?t.touches[0]:t).clientX,r=(t.touches?t.touches[0]:t).clientY,a=e.scrollSensitivity,s=e.scrollSpeed,d=se(),c=!1,u;kt!==n&&(kt=n,rt(),He=e.scroll,u=e.scrollFn,He===!0&&(He=ge(n,!0)));var f=0,E=He;do{var k=E,_=X(k),C=_.top,F=_.bottom,g=_.left,I=_.right,L=_.width,O=_.height,j=void 0,l=void 0,v=k.scrollWidth,P=k.scrollHeight,S=b(k),Y=k.scrollLeft,te=k.scrollTop;k===d?(j=L<v&&(S.overflowX==="auto"||S.overflowX==="scroll"||S.overflowX==="visible"),l=O<P&&(S.overflowY==="auto"||S.overflowY==="scroll"||S.overflowY==="visible")):(j=L<v&&(S.overflowX==="auto"||S.overflowX==="scroll"),l=O<P&&(S.overflowY==="auto"||S.overflowY==="scroll"));var ve=j&&(Math.abs(I-o)<=a&&Y+L<v)-(Math.abs(g-o)<=a&&!!Y),ie=l&&(Math.abs(F-r)<=a&&te+O<P)-(Math.abs(C-r)<=a&&!!te);if(!V[f])for(var oe=0;oe<=f;oe++)V[oe]||(V[oe]={});(V[f].vx!=ve||V[f].vy!=ie||V[f].el!==k)&&(V[f].el=k,V[f].vx=ve,V[f].vy=ie,clearInterval(V[f].pid),(ve!=0||ie!=0)&&(c=!0,V[f].pid=setInterval((function(){i&&this.layer===0&&w.active._onTouchMove(ft);var be=V[this.layer].vy?V[this.layer].vy*s:0,ae=V[this.layer].vx?V[this.layer].vx*s:0;typeof u=="function"&&u.call(w.dragged.parentNode[ee],ae,be,t,ft,V[this.layer].el)!=="continue"||tn(V[this.layer].el,ae,be)}).bind({layer:f}),24))),f++}while(e.bubbleScroll&&E!==d&&(E=ge(E,!1)));It=c}},30),un=function(e){var n=e.originalEvent,i=e.putSortable,o=e.dragEl,r=e.activeSortable,a=e.dispatchSortableEvent,s=e.hideGhostForTarget,d=e.unhideGhostForTarget;if(n){var c=i||r;s();var u=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:n,f=document.elementFromPoint(u.clientX,u.clientY);d(),c&&!c.el.contains(f)&&(a("spill"),this.onSpill({dragEl:o,putSortable:i}))}};function Lt(){}Lt.prototype={startIndex:null,dragStart:function(e){var n=e.oldDraggableIndex;this.startIndex=n},onSpill:function(e){var n=e.dragEl,i=e.putSortable;this.sortable.captureAnimationState(),i&&i.captureAnimationState();var o=Oe(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(n,o):this.sortable.el.appendChild(n),this.sortable.animateAll(),i&&i.animateAll()},drop:un};ce(Lt,{pluginName:"revertOnSpill"});function Nt(){}Nt.prototype={onSpill:function(e){var n=e.dragEl,i=e.putSortable,o=i||this.sortable;o.captureAnimationState(),n.parentNode&&n.parentNode.removeChild(n),o.animateAll()},drop:un};ce(Nt,{pluginName:"removeOnSpill"});w.mount(new wo);w.mount(Nt,Lt);function yo(){return typeof window<"u"?window.console:global.console}const _o=yo();function xo(t){const e=Object.create(null);return function(i){return e[i]||(e[i]=t(i))}}const Eo=/-(\w)/g,Ut=xo(t=>t.replace(Eo,(e,n)=>n?n.toUpperCase():""));function Tt(t){t.parentElement!==null&&t.parentElement.removeChild(t)}function Gt(t,e,n){const i=n===0?t.children[0]:t.children[n-1].nextSibling;t.insertBefore(e,i)}function To(t,e){return Object.values(t).indexOf(e)}function Do(t,e,n,i){if(!t)return[];const o=Object.values(t),r=e.length-i;return[...e].map((s,d)=>d>=r?o.length:o.indexOf(s))}function dn(t,e){this.$nextTick(()=>this.$emit(t.toLowerCase(),e))}function Co(t){return e=>{this.realList!==null&&this["onDrag"+t](e),dn.call(this,t,e)}}function So(t){return["transition-group","TransitionGroup"].includes(t)}function ko(t){if(!t||t.length!==1)return!1;const[{type:e}]=t;return e?So(e.name):!1}function Io(t,e){return e?{...e.props,...e.attrs}:t}const At=["Start","Add","Remove","Update","End"],Mt=["Choose","Unchoose","Sort","Filter","Clone"],Ao=["Move",...At,...Mt].map(t=>"on"+t);let Dt=null;const Mo={options:Object,list:{type:Array,required:!1,default:null},noTransitionOnDrag:{type:Boolean,default:!1},clone:{type:Function,default:t=>t},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null},component:{type:String,default:null},modelValue:{type:Array,required:!1,default:null}},Oo=We({name:"VueDraggableNext",inheritAttrs:!1,emits:["update:modelValue","move","change",...At.map(t=>t.toLowerCase()),...Mt.map(t=>t.toLowerCase())],props:Mo,data(){return{transitionMode:!1,noneFunctionalComponentMode:!1,headerOffset:0,footerOffset:0,_sortable:{},visibleIndexes:[],context:{}}},render(){const t=this.$slots.default?this.$slots.default():null,e=Io(this.$attrs,this.componentData);return t?(this.transitionMode=ko(t),Pt(this.getTag(),e,t)):Pt(this.getTag(),e,[])},created(){this.list!==null&&this.modelValue!==null&&_o.error("list props are mutually exclusive! Please set one.")},mounted(){const t={};At.forEach(o=>{t["on"+o]=Co.call(this,o)}),Mt.forEach(o=>{t["on"+o]=dn.bind(this,o)});const e=Object.keys(this.$attrs).reduce((o,r)=>(o[Ut(r)]=this.$attrs[r],o),{}),n=Object.assign({},e,t,{onMove:(o,r)=>this.onDragMove(o,r)});!("draggable"in n)&&(n.draggable=">*");const i=this.$el.nodeType===1?this.$el:this.$el.parentElement;this._sortable=new w(i,n),i.__draggable_component__=this,this.computeIndexes()},beforeUnmount(){try{this._sortable!==void 0&&this._sortable.destroy()}catch{}},computed:{realList(){return this.list?this.list:this.modelValue}},watch:{$attrs:{handler(t){this.updateOptions(t)},deep:!0},realList(){this.computeIndexes()}},methods:{getTag(){return this.component?Ve(this.component):this.tag},updateOptions(t){for(var e in t){const n=Ut(e);Ao.indexOf(n)===-1&&this._sortable.option(n,t[e])}},getChildrenNodes(){return this.$el.children},computeIndexes(){this.$nextTick(()=>{this.visibleIndexes=Do(this.getChildrenNodes(),this.$el.children,this.transitionMode,this.footerOffset)})},getUnderlyingVm(t){const e=To(this.getChildrenNodes()||[],t);if(e===-1)return null;const n=this.realList[e];return{index:e,element:n}},emitChanges(t){this.$nextTick(()=>{this.$emit("change",t)})},alterList(t){if(this.list){t(this.list);return}const e=[...this.modelValue];t(e),this.$emit("update:modelValue",e)},spliceList(){const t=e=>e.splice(...arguments);this.alterList(t)},updatePosition(t,e){const n=i=>i.splice(e,0,i.splice(t,1)[0]);this.alterList(n)},getVmIndex(t){const e=this.visibleIndexes,n=e.length;return t>n-1?n:e[t]},getComponent(){return this.$slots.default?this.$slots.default()[0].componentInstance:null},resetTransitionData(t){if(!this.noTransitionOnDrag||!this.transitionMode)return;var e=this.getChildrenNodes();e[t].data=null;const n=this.getComponent();n.children=[],n.kept=void 0},onDragStart(t){this.computeIndexes(),this.context=this.getUnderlyingVm(t.item),this.context&&(t.item._underlying_vm_=this.clone(this.context.element),Dt=t.item)},onDragAdd(t){const e=t.item._underlying_vm_;if(e===void 0)return;Tt(t.item);const n=this.getVmIndex(t.newIndex);this.spliceList(n,0,e),this.computeIndexes();const i={element:e,newIndex:n};this.emitChanges({added:i})},onDragRemove(t){if(Gt(this.$el,t.item,t.oldIndex),t.pullMode==="clone"){Tt(t.clone);return}if(!this.context)return;const e=this.context.index;this.spliceList(e,1);const n={element:this.context.element,oldIndex:e};this.resetTransitionData(e),this.emitChanges({removed:n})},onDragUpdate(t){Tt(t.item),Gt(t.from,t.item,t.oldIndex);const e=this.context.index,n=this.getVmIndex(t.newIndex);this.updatePosition(e,n);const i={element:this.context.element,oldIndex:e,newIndex:n};this.emitChanges({moved:i})},updateProperty(t,e){t.hasOwnProperty(e)&&(t[e]+=this.headerOffset)},onDragMove(t,e){const n=this.move;if(!n||!this.realList)return!0;const i=this.getRelatedContextFromMoveEvent(t),o=this.context,r=this.computeFutureIndex(i,t);Object.assign(o,{futureIndex:r});const a=Object.assign({},t,{relatedContext:i,draggedContext:o});return n(a,e)},onDragEnd(){this.computeIndexes(),Dt=null},getTrargetedComponent(t){return t.__draggable_component__},getRelatedContextFromMoveEvent({to:t,related:e}){const n=this.getTrargetedComponent(t);if(!n)return{component:n};const i=n.realList,o={list:i,component:n};if(t!==e&&i&&n.getUnderlyingVm){const r=n.getUnderlyingVm(e);if(r)return Object.assign(r,o)}return o},computeFutureIndex(t,e){const n=[...e.to.children].filter(a=>a.style.display!=="none");if(n.length===0)return 0;const i=n.indexOf(e.related),o=t.component.getVmIndex(i);return n.indexOf(Dt)!==-1||!e.willInsertAfter?o:o+1}}}),Ee=vn({});Ee.component("attributes-manager",ii);Ee.component("attributes-manager-form",ci);Ee.component("attributes-manager-attribute",Bi);Ee.component("attributes-manager-mention-field",Ui);Ee.component("draggable",Oo);Ee.use(bn);Ee.mount("#attributes-manager");

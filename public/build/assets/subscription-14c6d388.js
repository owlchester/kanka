var p,v,t,u=!1,o,a,r,f,d,m,l;$(document).ready(function(){C(),k(),l=$("#subscribe-confirm"),l.on("shown.bs.modal",()=>{g()})});function C(){let i=$("#stripe-token");p=Stripe(i.val()),v=p.elements()}function g(){if(o=$(".subscription-confirm-button"),$("#card-element").length===1){if(!t){let n={base:{color:"#555555",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"14px","::placeholder":{color:"#777777"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}};t=v.create("card",{hidePostalCode:!0,style:n})}t.mount("#card-element")}$("#subscription-confirm").submit(function(n){if(u)return!0;n.preventDefault(),o.addClass("disabled").addClass("loading"),o.prop("disabled","disabled");let e=$('input[name="subscription-intent-token"]'),s=$(".alert-error");s.hide();let h=$('input[name="payment_id"]');if(h.val())return u=!0,$("#subscription-confirm").submit(),!1;p.confirmCardSetup(e.val(),{payment_method:{card:t,billing_details:{name:$('input[name="card-holder-name"]').val()}}}).then(function(c){if(c.error)return o.removeClass("disabled").removeClass("loading"),o.prop("disabled",""),s.text(c.error.message).show(),!1;h.val(c.setupIntent.payment_method),u=!0,$("#subscription-confirm").submit()}.bind(this))}),$(".subscription-form").submit(function(){return o.addClass("disabled").find("span").hide().parent().find(".spinner").show(),!0}),a=$("#coupon-check-btn"),r=$("#coupon-check"),f=$("#coupon-success"),d=$("#coupon-invalid"),m=$("#coupon"),a.click(function(){b()}),r.change(function(){b()}),r.focus(function(){o.addClass("disabled").prop("disabled",!0)}),r.focusout(function(){r.val()||o.removeClass("disabled").prop("disabled",!1)})}function b(){let i=r.val(),n=r.data("url");a.prop("disabled",!0).find(".check").hide().parent().find(".spinner").show(),i||o.removeClass("disabled").prop("disabled",!1),$.ajax({url:n+"?coupon="+i,context:this}).done(function(e){if(a.prop("disabled",!1).find(".check").show().parent().find(".spinner").hide(),o.removeClass("disabled").prop("disabled",!1),!e.valid){f.hide(),d.html(e.error).show(),m.val(""),l.removeClass("valid-coupon");return}d.hide(),f.html(e.discount).show(),m.val(e.coupon),l.addClass("valid-coupon")}).fail(function(e){a.prop("disabled",!1).find(".check").show().parent().find(".spinner").hide(),e.responseJSON&&d.html(e.responseJSON.message).show()})}function k(){$('input[name="period"]').change(function(){let n=$("#pricing-overview");console.log("checked?",this.checked),this.checked?n.removeClass("period-month").addClass("period-year"):n.removeClass("period-year").addClass("period-month")});let i=$("#currency-selector");if(i.length===0)return!1;i.change(function(n){n.preventDefault();let e=$(this).find(":selected").val(),s=$("#pricing-overview");e=="eur"?s.removeClass("currency-usd").addClass("currency-eur"):e=="usd"&&s.removeClass("currency-eur").addClass("currency-usd")})}

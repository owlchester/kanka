let s,r;const l=()=>{if(u(),!document.getElementById("add_attribute_target"))return;const e=document.querySelector("[data-max-fields]");e&&e.dataset.maxFields},u=()=>{const e=document.querySelector('[name="live-attribute-config"]');if(!e)return;s=e.dataset.live,r=document.getElementById("live-attribute-dialog");let a=1;document.querySelectorAll(".live-edit").forEach(i=>{i.classList.add("live-edit-parsed"),i.dataset.uid=a,a++}),document.querySelectorAll(".live-edit-parsed").forEach(i=>{i.addEventListener("click",function(t){if(t.target.tagName==="A")return;const d=i.dataset.id,c=s+"?id="+d+"&uid="+i.dataset.uid;window.onEvent(function(){m()}),window.openDialog("live-attribute-dialog",c)})}),window.onEvent(function(){v()})},m=()=>{r.querySelector("form").onsubmit=function(e){e.preventDefault();const a=e.target,n=new FormData(a);return axios.post(a.getAttribute("action"),n).then(o=>{r.querySelector("article").innerHTML="",document.getElementById("live-attribute-dialog").close();const t=document.querySelector('[data-uid="'+o.data.uid+'"]');t.dataset.attribute=o.data.attribute,t.innerHTML=o.data.value,o.data.value?t.classList.remove("empty-value"):t.classList.add("empty-value"),window.showToast(o.data.success)}).catch(()=>{document.getElementById("live-attribute-dialog").close()}),!1}},v=()=>{const e=document.querySelectorAll("form.live-attribute-form"),a=document.getElementById("primary-dialog");e.forEach(function(n){n.onsubmit=o=>{o.preventDefault();const i=new FormData(n);axios.post(n.getAttribute("action"),i).then(t=>{a.querySelector("article").innerHTML="",a.close();const d=document.querySelector('[data-live-id="'+t.data.id+'"]');d.dataset.dataAttribute=t.data.attribute,d.innerHTML=t.data.value,window.showToast(t.data.success)}).catch(t=>{t.response.data.message&&window.showToast(t.response.data.message,"error"),a.close()})}})};l();

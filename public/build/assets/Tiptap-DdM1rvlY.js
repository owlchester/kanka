const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/GalleryDialog-B9joQH7N.js","assets/vendor-tiptap-DFhGOnJZ.js","assets/index-D5GkNzM3.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/GalleryDialog-DSssiTYx.css","assets/SourceEditor-DGWxyXMw.js","assets/SourceEditor-BKF0zshA.css"])))=>i.map(i=>d[i]);
import{_ as re}from"./preload-helper-I4rgV-VL.js";import{T as Ce,U as Q,V as ne,W as me,X as se,d as K,D as Z,a as p,c as b,F as j,r as W,b as n,e as y,g as B,t as ee,f as I,h as S,y as D,Y as pe,Z as be,_ as he,$ as ve,a0 as ye,a1 as le,a2 as Fe,a3 as Ae,a4 as Le,w as O,v as J,p as v,u as h,o as xe,E as we,n as Y,B as te,j as Me,k as P,a5 as Te,a6 as $e,a7 as He,a8 as Ee,a9 as Ie,aa as Se,ab as Re,ac as Be,ad as De,ae as Pe,af as je,ag as Ue,ah as Ke,ai as Oe,i as oe,s as V,aj as q,ak as ae,al as ze,P as ue}from"./vendor-tiptap-DFhGOnJZ.js";import{_ as ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as Ne}from"./index-D5GkNzM3.js";const Ve=Ce.extend({addAttributes(){return{...this.parent?.(),class:{default:null,parseHTML:e=>e.getAttribute("class"),renderHTML:e=>e.class?{class:e.class}:{}},style:{default:null,parseHTML:e=>e.getAttribute("style"),renderHTML:e=>e.style?{style:e.style}:{}}}},renderHTML({HTMLAttributes:e}){return["table",Q(this.options.HTMLAttributes,e),["tbody",0]]}}),qe=new se("mention"),We=ne.create({name:"mention",addOptions(){return{HTMLAttributes:{},renderLabel({options:e,node:l}){return l.attrs.label||l.attrs.name||l.attrs.id},suggestion:{char:"@",pluginKey:qe,command:({editor:e,range:l,props:s})=>{e.view.state.selection.$to.nodeAfter?.text?.startsWith(" ")&&(l.to+=1);const u=s.section==="entities"?s.mention:s.inject;e.chain().focus().insertContentAt(l,[{type:"text",text:u},{type:"text",text:" "}]).run(),window.getSelection()?.collapseToEnd()},allow:({state:e,range:l})=>{const s=e.doc.resolve(l.from),i=e.schema.nodes[this.name];return!!s.parent.type.contentMatch.matchType(i)}}}},group:"inline",inline:!0,selectable:!0,atom:!0,draggable:!0,addAttributes(){return{id:{default:null,parseHTML:e=>e.getAttribute("data-id"),renderHTML:e=>e.id?{"data-id":e.id}:{}},label:{default:null,parseHTML:e=>e.getAttribute("data-label"),renderHTML:e=>({})},name:{default:null,parseHTML:e=>e.getAttribute("data-name"),renderHTML:e=>e.name?{"data-name":e.name}:{}},mention:{default:null,parseHTML:e=>e.getAttribute("data-mention"),renderHTML:e=>{if(!e.mention)return{};const l=[`${e.mention}`];return e.label&&l.push(e.label),e.config&&l.push(e.config),{"data-mention":`[${l.join("|")}]`}}},image:{default:null,parseHTML:e=>e.getAttribute("data-image"),renderHTML:e=>({})},entity:{default:null,parseHTML:e=>e.getAttribute("data-entity"),renderHTML:e=>({})},url:{default:null,parseHTML:e=>e.getAttribute("data-url"),renderHTML:e=>({})},config:{default:null,parseHTML:e=>e.getAttribute("data-config"),renderHTML:e=>e.config?{"data-config":e.config}:{"data-config":""}}}},parseHTML(){return[{tag:"span[data-mention]"}]},renderHTML({node:e,HTMLAttributes:l}){const s=this.options.renderLabel({options:this.options,node:e}),i=[];if(e.attrs.image&&i.push(["img",{src:e.attrs.image,class:"inline-block w-4 h-4 rounded-full object-cover mr-1 align-middle",alt:s}]),i.push(s),e.attrs.config){const u=e.attrs.config.split("|").find(c=>c.startsWith("alias:"));if(u){const c=u.split(":")[1],f=e.attrs.entity.aliases.find(a=>a.id===parseInt(c));f&&(i.push(["i",{class:"fa-regular fa-masks-theater"}]),i.push(`(${f.name})`))}}return["a",Q({"data-type":"mention"},this.options.HTMLAttributes,l),["span",{class:"rounded-xl bg-base-200 hover:bg-base-300 text-base-content px-2 py-0.5 inline-flex items-center gap-1 cursor-pointer"},...i]]},renderText({node:e}){return e.attrs.mention||`[${e.attrs.label}]`},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:e,state:l})=>{let s=!1;const{selection:i}=l,{empty:d,anchor:u}=i;return d?(l.doc.nodesBetween(u-1,u,(c,f)=>{if(c.type.name===this.name)return s=!0,e.insertText(this.options.suggestion.char||"",f,f+c.nodeSize),!1}),s):!1})}},addProseMirrorPlugins(){return[me({editor:this.editor,...this.options.suggestion})]}}),Ge={class:"mention-list bg-base-100 shadow-lg rounded-lg z-50 max-h-[300px] overflow-y-auto"},Ze={class:"section-header px-3 py-1 text-xs font-semibold text-neutral-content/70 bg-base-200/50 flex items-center gap-2"},Je=["onClick"],Qe={class:"flex gap-2 items-center"},Xe={key:0,class:"fa-regular fa-plus text-success","aria-hidden":"true"},Ye=["src","alt"],_e=["innerHTML"],et=["innerHTML"],tt=["innerHTML"],nt={key:1,class:"px-3 py-2 text-neutral-content text-xs"},st={key:0},lt={key:1},it={key:2},rt=K({__name:"MentionList",props:{items:{},command:{type:Function},loading:{type:Boolean},query:{}},setup(e,{expose:l}){const s=e,i=S(0);Z(()=>s.items,()=>{i.value=0});const d={entities:{label:"Entities",icon:"fa-regular fa-bookmark"},posts:{label:"Posts",icon:"fa-regular fa-newspaper"},attributes:{label:"Attributes",icon:"fa-regular fa-heart"},new:{label:"Create New",icon:"fa-regular fa-plus"}},u=D(()=>["entities","posts","attributes","new"].map(F=>({key:F,label:d[F].label,icon:d[F].icon,items:s.items.filter(A=>A.section===F)})).filter(F=>F.items.length>0)),c=D(()=>s.query.length<3),f=D(()=>!c.value&&s.loading),a=D(()=>!c.value&&!s.loading&&s.items.length===0),x=({event:m})=>m.key==="ArrowUp"?(T(),!0):m.key==="ArrowDown"?(C(),!0):m.key==="Enter"?(w(),!0):!1,T=()=>{i.value=(i.value+s.items.length-1)%s.items.length},C=()=>{i.value=(i.value+1)%s.items.length},w=()=>{k(i.value)},k=m=>{const F=s.items[m];F&&s.command(F)},$=(m,F)=>{let A=0;for(const L of u.value){if(L.key===m)return A+F;A+=L.items.length}return A};return l({onKeyDown:x}),(m,F)=>(p(),b("div",Ge,[e.items.length?(p(!0),b(j,{key:0},W(u.value,A=>(p(),b("div",{key:A.key,class:"mention-section"},[n("div",Ze,[n("i",{class:y(A.icon),"aria-hidden":"true"},null,2),B(" "+ee(A.label),1)]),(p(!0),b(j,null,W(A.items,(L,g)=>(p(),b("button",{key:L.id??`${A.key}-${g}`,onClick:o=>k($(A.key,g)),class:y(["mention-item flex items-center gap-2 w-full text-left px-3 py-2 hover:bg-base-200 text-xs justify-between cursor-pointer",{"bg-base-200":$(A.key,g)===i.value}])},[n("div",Qe,[A.key==="new"?(p(),b("i",Xe)):L.image?(p(),b("img",{key:1,src:L.image,alt:L.name,loading:"lazy",class:"w-6 h-6 rounded-full object-cover"},null,8,Ye)):I("",!0),n("span",{class:"mention-name",innerHTML:L.name},null,8,_e)]),L.type?(p(),b("span",{key:0,class:"mention-type text-neutral-content",innerHTML:L.type},null,8,et)):I("",!0),L.value?(p(),b("span",{key:1,class:"text-neutral-content",innerHTML:L.value},null,8,tt)):I("",!0)],10,Je))),128))]))),128)):(p(),b("div",nt,[c.value?(p(),b("span",st," Type at least 3 characters ")):f.value?(p(),b("span",lt,[...F[0]||(F[0]=[n("i",{class:"fa-solid fa-spinner fa-spin","aria-hidden":"true"},null,-1),B(" Loading... ",-1)])])):a.value?(p(),b("span",it," No results ")):I("",!0)]))]))}}),ot=ie(rt,[["__scopeId","data-v-d6739cd7"]]),de=(e,l)=>{be({getBoundingClientRect:()=>ye(e.view,e.state.selection.from,e.state.selection.to)},l,{placement:"bottom-start",strategy:"absolute",middleware:[he(),ve()]}).then(({x:i,y:d,strategy:u})=>{l.style.width="max-content",l.style.position=u,l.style.left=`${i}px`,l.style.top=`${d}px`})},at=(e,l)=>{let s=null;return{char:"@",items:async({query:i})=>{if(i.length<3)return[];s&&s.abort(),s=new AbortController;try{const d=new URL(e);d.searchParams.set("q",i);const u=await fetch(d.toString(),{signal:s.signal});if(!u.ok)return[];const c=await u.json(),f=[];return c.entities?.length&&c.entities.forEach(a=>{f.push({id:a.id,name:a.name,image:a.image,url:a.url,aliases:a.aliases,mention:a.mention,type:a.type,section:"entities"})}),c.posts?.length&&c.posts.forEach(a=>{f.push({id:a.id,name:a.name,inject:a.inject,section:"posts"})}),c.attributes?.length&&c.attributes.forEach(a=>{f.push({id:a.id,name:a.name,value:a.value,inject:a.inject,section:"attributes"})}),c.new?.length&&c.new.forEach(a=>{f.push({name:a.name,type:a.type,inject:a.inject,section:"new"})}),f}catch(d){return d.name==="AbortError"?[]:(console.error("Error fetching mentions:",d),[])}},render:()=>{let i;return{onStart:d=>{i=new pe(ot,{props:{items:d.items,command:u=>{l&&u.section==="entities"&&l({id:parseInt(u.id),name:u.name,type:u.type,image:u.image,url:u.url,aliases:u.aliases}),d.command(u)},loading:d.query&&d.query.length>=3,query:d.query||""},editor:d.editor}),d.clientRect&&(i.element.style.position="absolute",document.body.appendChild(i.element),de(d.editor,i.element))},onUpdate(d){const u=d.query&&d.query.length>=3&&d.items.length===0,c=f=>{l&&f.section==="entities"&&l({id:parseInt(f.id),name:f.name,type:f.type,image:f.image,url:f.url,aliases:f.aliases}),d.command(f)};i.updateProps({items:d.items,command:c,loading:u,query:d.query||""}),d.clientRect&&de(d.editor,i.element)},onKeyDown(d){return d.event.key==="Escape"?(i.destroy(),!0):i.ref?.onKeyDown(d)},onExit(){i.destroy()}}}}},ut=new se("mentionParser"),dt=le.create({name:"mentionParser",addOptions(){return{entities:[]}},addProseMirrorPlugins(){return[new Fe({key:ut,appendTransaction:(e,l,s)=>{if(!e.some(a=>a.docChanged))return null;const d="value"in this.options.entities?this.options.entities.value:this.options.entities||[],u=s.tr;let c=!1;const f=/\[([a-zA-Z_]+):(\d+)(?:\|[^\]]+)?\]/g;return s.doc.descendants((a,x)=>{if(a.isText&&a.text){const T=a.text;let C;const w=[];for(;(C=f.exec(T))!==null;){const k=C[0],$=C[1],m=C[2];if($==="post")continue;const F=`${$}:${m}`;let A,L;const g=k.indexOf("|");if(g!==-1){const o=k.substring(g+1,k.length-1).split("|"),t=[];for(const r of o)r.includes(":")?t.push(r):A||(A=r);t.length>0&&(L=t.join("|"))}w.push({start:x+C.index,end:x+C.index+C[0].length,mention:F,module:$,id:m,customLabel:A,config:L})}for(let k=w.length-1;k>=0;k--){const{start:$,end:m,mention:F,module:A,id:L,customLabel:g,config:o}=w[k],t=u.mapping.map($),r=u.mapping.map(m);if(u.doc.resolve(t),u.doc.nodeAt(t)?.type.name!=="mention"){const E=s.schema.nodes.mention;if(E){const R=d.find(ke=>ke.id===parseInt(L)),U=R?R.name:`${A}:${L}`,z=g||"",G=R?.image||null,N=R?.url||null;console.log("parsed",F,U,o);const X=E.create({id:L,name:R?R.name:`${A}:${L}`,label:z,mention:F,image:G,url:N,config:o||null,entity:R});u.replaceWith(t,r,X),c=!0}}}}}),c?u:null}})]}}),ct=new se("slashCommand"),ft=le.create({name:"slashCommand",addOptions(){return{suggestion:{char:"/",pluginKey:ct,command:({editor:e,range:l,props:s})=>{e.chain().focus().deleteRange(l).run(),s.command(e)}}}},addProseMirrorPlugins(){return[me({editor:this.editor,...this.options.suggestion})]}}),gt={class:"slash-command-list bg-base-100 shadow-lg rounded-lg z-50 max-h-[300px] overflow-y-auto min-w-[200px]"},mt=["onClick"],pt={class:"w-6 h-6 rounded bg-base-200 flex items-center justify-center"},bt={class:"flex flex-col"},ht={class:"font-medium text-sm"},vt={class:"text-xs text-neutral-content"},yt={key:1,class:"px-3 py-2 text-neutral-content text-sm"},xt=K({__name:"SlashCommandList",props:{items:{},command:{type:Function}},setup(e,{expose:l}){const s=e,i=S(0);Z(()=>s.items,()=>{i.value=0});const d=({event:x})=>x.key==="ArrowUp"?(u(),!0):x.key==="ArrowDown"?(c(),!0):x.key==="Enter"?(f(),!0):!1,u=()=>{i.value=(i.value+s.items.length-1)%s.items.length},c=()=>{i.value=(i.value+1)%s.items.length},f=()=>{a(i.value)},a=x=>{const T=s.items[x];T&&s.command(T)};return l({onKeyDown:d}),(x,T)=>(p(),b("div",gt,[e.items.length?(p(!0),b(j,{key:0},W(e.items,(C,w)=>(p(),b("button",{key:C.title,onClick:k=>a(w),class:y(["slash-command-item flex items-center gap-2 w-full text-left px-3 py-2 hover:bg-base-300 text-sm cursor-pointer",{"bg-base-300":w===i.value}])},[n("div",pt,[n("i",{class:y([C.icon,"text-xs"]),"aria-hidden":"true"},null,2)]),n("div",bt,[n("span",ht,ee(C.title),1),n("span",vt,ee(C.description),1)])],10,mt))),128)):(p(),b("div",yt," No commands found "))]))}}),wt=ie(xt,[["__scopeId","data-v-aa19753b"]]),ce=(e,l)=>{be({getBoundingClientRect:()=>ye(e.view,e.state.selection.from,e.state.selection.to)},l,{placement:"bottom-start",strategy:"absolute",middleware:[he(),ve()]}).then(({x:i,y:d,strategy:u})=>{l.style.width="max-content",l.style.position=u,l.style.left=`${i}px`,l.style.top=`${d}px`})},kt=`
  <table class="table table-striped table-bordered" style="width: 200px;">
    <thead>
        <tr>
            <th>a</th>
            <th>b</th>
        </tr>
    </thead>
    <tbody>
        <tr>
          <td>1</td>
          <td>2</td>
        </tr>
        <tr>
          <td>3</td>
          <td>4</td>
        </tr>
    </tbody>
  </table>`,Ct=[{title:"Source",description:"Edit raw HTML source",icon:"fa-regular fa-code",command:e=>{window.dispatchEvent(new CustomEvent("tiptap:source-mode"))}},{title:"Gallery",description:"Insert an image from gallery",icon:"fa-regular fa-images",searchTerms:["image","photo","picture","media"],command:e=>{e.commands.openGallery()}},{title:"Insert Media",description:"Upload an image from your device",icon:"fa-regular fa-upload",searchTerms:["image","photo","picture","media","upload","file"],command:e=>{e.commands.uploadMedia()}},{title:"Table",description:"Insert a table",icon:"fa-regular fa-table",command:e=>{e.chain().focus().insertContent(kt,{parseOptions:{preserveWhitespace:!0}}).run()}},{title:"Heading 1",description:"Huge heading",icon:"fa-regular fa-heading",command:e=>{e.chain().focus().toggleHeading({level:1}).run()}},{title:"Heading 2",description:"Large heading",icon:"fa-regular fa-heading",command:e=>{e.chain().focus().toggleHeading({level:2}).run()}},{title:"Heading 3",description:"Medium heading",icon:"fa-regular fa-heading",command:e=>{e.chain().focus().toggleHeading({level:3}).run()}},{title:"Bullet List",description:"Create a bullet list",icon:"fa-regular fa-list-ul",command:e=>{e.chain().focus().toggleBulletList().run()}},{title:"Numbered List",description:"Create a numbered list",icon:"fa-regular fa-list-ol",command:e=>{e.chain().focus().toggleOrderedList().run()}},{title:"Task List",description:"Create a checklist",icon:"fa-regular fa-square-check",searchTerms:["checkbox","checklist","todo","task"],command:e=>{e.chain().focus().toggleTaskList().run()}},{title:"Quote",description:"Insert a quote block",icon:"fa-regular fa-quote-right",command:e=>{e.chain().focus().toggleBlockquote().run()}},{title:"Code Block",description:"Insert a code block",icon:"fa-regular fa-code",command:e=>{e.chain().focus().toggleCodeBlock().run()}},{title:"Horizontal Rule",description:"Insert a divider",icon:"fa-regular fa-minus",command:e=>{e.chain().focus().setHorizontalRule().run()}}],Ft=()=>({items:({query:e})=>{const l=e.toLowerCase();return Ct.filter(s=>s.title.toLowerCase().includes(l)||s.searchTerms?.some(i=>i.includes(l)))},render:()=>{let e;return{onStart:l=>{e=new pe(wt,{props:{items:l.items,command:l.command},editor:l.editor}),l.clientRect&&(e.element.style.position="absolute",document.body.appendChild(e.element),ce(l.editor,e.element))},onUpdate(l){e.updateProps({items:l.items,command:l.command}),l.clientRect&&ce(l.editor,e.element)},onKeyDown(l){return l.event.key==="Escape"?(e.destroy(),!0):e.ref?.onKeyDown(l)},onExit(){e.destroy()}}}}),At=le.create({name:"gallery",addOptions(){return{galleryUrl:""}},addCommands(){return{openGallery:()=>({editor:e})=>{const l=new CustomEvent("tiptap:open-gallery",{detail:{editor:e,galleryUrl:this.options.galleryUrl}});return window.dispatchEvent(l),!0},uploadMedia:()=>({editor:e})=>{const l=this.options.galleryUrl,s=document.createElement("input");return s.type="file",s.accept="image/png,image/jpg,image/jpeg,image/gif,image/webp",s.onchange=async()=>{const i=s.files?.[0];if(!i)return;const d=new FormData;d.append("file",i);try{const u=await Ne.post(l,d);u.status===200&&u.data&&e.chain().focus().setImage({src:u.data.src,"data-uuid":u.data.uuid}).run()}catch(u){if(u.response?.status===204||u.response?.data){const c=u.response?.data?.errors||u.response?.data||"Upload failed";window.showToast(c,"error")}else window.showToast("Upload failed","error")}},s.click(),!0}}}}),Lt=Ae.extend({name:"image",addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null},"data-gallery-uuid":{default:null},class:{default:null,parseHTML:e=>(e.getAttribute("class")||"").split(/\s+/).filter(i=>!["note-float-left","note-float-right","float-left","float-right"].includes(i)).join(" ").trim()||null},width:{default:null,parseHTML:e=>{const s=(e.getAttribute("style")||"").match(/width:\s*(\d+(?:\.\d+)?)px/);if(s)return parseFloat(s[1]);const i=e.getAttribute("width");return i?parseFloat(i):null},renderHTML:()=>({})},height:{default:null,parseHTML:e=>{const s=(e.getAttribute("style")||"").match(/height:\s*(\d+(?:\.\d+)?)px/);if(s)return parseFloat(s[1]);const i=e.getAttribute("height");return i?parseFloat(i):null},renderHTML:()=>({})},widthStyle:{default:null,parseHTML:e=>{const s=(e.getAttribute("style")||"").match(/width:\s*(\d+%)/);return s?s[1]:null},renderHTML:()=>({})},floatStyle:{default:null,parseHTML:e=>{const s=(e.getAttribute("style")||"").match(/float:\s*(left|right)/);if(s)return s[1];const i=e.getAttribute("class")||"";return i.includes("note-float-left")||i.includes("float-left")?"left":i.includes("note-float-right")||i.includes("float-right")?"right":null},renderHTML:()=>({})}}},renderHTML({node:e,HTMLAttributes:l}){const{width:s,height:i,widthStyle:d,floatStyle:u}=e.attrs,c=[];d?c.push(`width: ${d}`):s!=null&&c.push(`width: ${typeof s=="number"?`${s}px`:s}`),!d&&i!=null&&c.push(`height: ${typeof i=="number"?`${i}px`:i}`),u&&(c.push(`float: ${u}`),u==="left"&&c.push("margin-right: 0.5rem"),u==="right"&&c.push("margin-left: 0.5rem"));const f=c.length>0?{style:c.join("; ")}:{};return["img",Q(this.options.HTMLAttributes,l,f)]},addCommands(){return{...this.parent?.(),setImageWidth:e=>({commands:l})=>l.updateAttributes("image",{widthStyle:e,width:null,height:null}),setImageFloat:e=>({commands:l})=>l.updateAttributes("image",{floatStyle:e})}},addNodeView(){if(!this.options.resize?.enabled||typeof document>"u")return null;const{directions:e,minWidth:l,minHeight:s,alwaysPreserveAspectRatio:i}=this.options.resize;return({node:d,getPos:u,HTMLAttributes:c,editor:f})=>{const a=document.createElement("img");Object.entries(c).forEach(([w,k])=>{if(k!=null)switch(w){case"width":case"height":break;default:a.setAttribute(w,k);break}}),a.src=c.src;const x=(w,k)=>{const{widthStyle:$,floatStyle:m}=w;$?(k.style.width=$,a.style.width="100%",a.style.height="auto"):k.style.width="",k.style.float=m||"",k.style.marginRight=m==="left"?"0.5rem":"",k.style.marginLeft=m==="right"?"0.5rem":""},T=new Le({element:a,editor:f,node:d,getPos:u,onResize:(w,k)=>{a.style.width=`${w}px`,a.style.height=`${k}px`},onCommit:(w,k)=>{const $=u();$!==void 0&&this.editor.chain().setNodeSelection($).updateAttributes(this.name,{width:w,height:k,widthStyle:null}).run()},onUpdate:w=>w.type!==d.type?!1:(x(w.attrs,T.dom),!0),options:{directions:e,min:{width:l,height:s},preserveAspectRatio:i===!0}}),C=T.dom;return C.style.visibility="hidden",C.style.pointerEvents="none",a.onload=()=>{C.style.visibility="",C.style.pointerEvents=""},x(d.attrs,C),T}}}),Mt=ne.create({name:"iframe",group:"block",atom:!0,addOptions(){return{allowFullscreen:!0,HTMLAttributes:{class:"iframe-wrapper relative overflow-hidden max-w-full h-fit"}}},addAttributes(){return{src:{default:null,parseHTML:e=>e.getAttribute("src")},frameborder:{default:0,parseHTML:e=>e.getAttribute("frameborder")||0},allowfullscreen:{default:this.options.allowFullscreen,parseHTML:e=>e.hasAttribute("allowfullscreen")},width:{default:"100%",parseHTML:e=>e.getAttribute("width")||"100%"},height:{default:315,parseHTML:e=>e.getAttribute("height")||315},allow:{default:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",parseHTML:e=>e.getAttribute("allow")},title:{default:null,parseHTML:e=>e.getAttribute("title")},style:{default:null,parseHTML:e=>e.getAttribute("style")}}},parseHTML(){return[{tag:"iframe"}]},renderHTML({HTMLAttributes:e}){return["div",this.options.HTMLAttributes,["iframe",e]]},addCommands(){return{setIframe:e=>({tr:l,dispatch:s})=>{const{selection:i}=l,d=this.type.create(e);return s&&l.replaceRangeWith(i.from,i.to,d),!0}}}}),Tt=ne.create({name:"div",group:"block",content:"block+",defining:!0,addAttributes(){return{class:{default:null,parseHTML:e=>e.getAttribute("class")},style:{default:null,parseHTML:e=>e.getAttribute("style")}}},parseHTML(){return[{tag:"div",getAttrs:e=>e.parentElement?.getAttribute("data-type")==="taskItem"?!1:{}}]},renderHTML({HTMLAttributes:e}){return["div",Q(e),0]}}),$t={class:"flex items-center gap-2 text-xs text-neutral-content px-2"},Ht=["placeholder"],Et=["href"],It={key:1,class:"text-neutral-content flex items-center gap-1"},St=K({__name:"MentionBubbleMenu",props:{editor:{},mentions:{}},setup(e,{expose:l}){const s=e,i=S(null),d=S(""),u=S(null),c=S(""),f=S(!1);l({syncLabel:()=>{const g=s.editor.getAttributes("mention");g?.entity&&(d.value=g?.label||"")}});const x=()=>{s.editor.chain().focus().deleteSelection().run()},T=()=>{},C=()=>{let g=d.value.trim();const t=s.editor.getAttributes("mention")?.id,r=s.mentions.find(M=>M.id===parseInt(t));g===r?.name&&(g=""),s.editor.chain().focus().updateAttributes("mention",{label:g}).run(),d.value=""},w=g=>{const o=g.relatedTarget;o&&o.closest(".bubble-menu")||C()},k=g=>{g.key==="Enter"?(g.preventDefault(),C()):g.key==="Escape"&&(g.preventDefault(),d.value="",s.editor.commands.focus())},$=()=>{const g=s.editor.getAttributes("mention");c.value=g?.config||"",f.value=!0,setTimeout(()=>{u.value?.focus(),u.value?.select()},10)},m=()=>{const g=c.value.trim();s.editor.chain().focus().updateAttributes("mention",{config:g||null}).run(),f.value=!1,c.value=""},F=g=>{const o=g.relatedTarget;o&&o.closest(".bubble-menu")||m()},A=()=>{s.editor.chain().focus().updateAttributes("mention",{config:null}).run(),f.value=!1,c.value=""},L=g=>{g.key==="Enter"?(g.preventDefault(),m()):g.key==="Escape"&&(g.preventDefault(),f.value=!1,c.value="",s.editor.commands.focus())};return(g,o)=>(p(),b("div",$t,[f.value?(p(),b(j,{key:0},[O(n("input",{ref_key:"mentionConfigInput",ref:u,"onUpdate:modelValue":o[0]||(o[0]=t=>c.value=t),type:"text",placeholder:"page:abilities|anchor:#ability-1",class:"p-0 px-1 rounded text-xs outline-none focus:ring-1 focus:ring-primary min-w-[250px]",onBlur:F,onKeydown:L},null,544),[[J,c.value]]),e.editor.getAttributes("mention").config?(p(),b("button",{key:0,onClick:v(A,["prevent"]),class:"hover:text-warning",title:"Clear config"},[...o[2]||(o[2]=[n("i",{class:"fa-regular fa-times"},null,-1)])])):I("",!0)],64)):(p(),b(j,{key:1},[e.editor.getAttributes("mention").entity?(p(),b(j,{key:0},[O(n("input",{ref_key:"mentionLabelInput",ref:i,"onUpdate:modelValue":o[1]||(o[1]=t=>d.value=t),type:"text",placeholder:e.editor.getAttributes("mention").entity.name,class:"p-0 px-1 rounded text-xs outline-none focus:ring-1 focus:ring-primary min-w-[150px]",onFocus:T,onBlur:w,onKeydown:k},null,40,Ht),[[J,d.value]]),e.editor.getAttributes("mention").url?(p(),b("a",{key:0,class:"text-link",href:e.editor.getAttributes("mention").url,title:"Go to entity"},[...o[3]||(o[3]=[n("i",{class:"fa-regular fa-external-link-alt","aria-hidden":"true"},null,-1)])],8,Et)):I("",!0)],64)):(p(),b("span",It,[...o[4]||(o[4]=[n("i",{class:"fa-regular fa-exclamation-triangle","aria-hidden":"true"},null,-1),B(" Unknown entity ",-1)])])),n("button",{onClick:v($,["prevent"]),class:y(["hover:text-primary",{"text-primary":e.editor.getAttributes("mention").config}]),title:"Customize mention"},[...o[5]||(o[5]=[n("i",{class:"fa-regular fa-cog","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:v(x,["prevent"]),class:"hover:text-error",title:"Remove mention"},[...o[6]||(o[6]=[n("i",{class:"fa-regular fa-trash","aria-hidden":"true"},null,-1)])])],64))]))}}),Rt={class:"flex gap-2 items-center text-xs text-neutral-content px-2"},Bt=["href"],Dt=K({__name:"LinkBubbleMenu",props:{editor:{}},setup(e){const l=e,s=S(null),i=S("");Z(()=>l.editor.getAttributes("link").href,a=>{i.value=a||""},{immediate:!0}),Z(()=>l.editor.isActive("link")&&l.editor.state.selection.empty,a=>{a&&setTimeout(()=>s.value?.focus(),10)});const d=()=>{if(!i.value){l.editor.chain().focus().extendMarkRange("link").unsetLink().run();return}let a=i.value;/^https?:\/\//i.test(a)||(a="https://"+a),l.editor.chain().focus().extendMarkRange("link").setLink({href:a}).run()},u=()=>{l.editor.chain().focus().extendMarkRange("link").unsetLink().run()},c=()=>{l.editor.getAttributes("link").href?l.editor.commands.focus():l.editor.chain().focus().extendMarkRange("link").unsetLink().run()},f=a=>{a.key==="Enter"?(a.preventDefault(),d()):a.key==="Escape"&&(a.preventDefault(),c())};return(a,x)=>(p(),b("div",Rt,[O(n("input",{ref_key:"linkInputRef",ref:s,"onUpdate:modelValue":x[0]||(x[0]=T=>i.value=T),type:"text",placeholder:"Enter URL...",class:"p-0 px-1 rounded text-xs outline-none focus:ring-1 focus:ring-primary min-w-[200px]",onKeydown:f},null,544),[[J,i.value]]),e.editor.isActive("link")?(p(),b("a",{key:0,href:e.editor.getAttributes("link").href,target:"_blank",class:"hover:text-base-content",title:"Open in a new window"},[...x[1]||(x[1]=[n("i",{class:"fa-regular fa-external-link-alt"},null,-1)])],8,Bt)):I("",!0),e.editor.isActive("link")?(p(),b("button",{key:1,onClick:v(u,["prevent"]),class:"hover:text-error",title:"Remove link"},[...x[2]||(x[2]=[n("i",{class:"fa-regular fa-unlink","aria-label":"Removal icon"},null,-1)])])):I("",!0)]))}}),H=e=>{const l="px-2 py-1 rounded-lg hover:bg-base-200 block hover:text-base-content ",s=e?"bg-base-300 border-primary text-base-content":"text-neutral-content ";return l+" "+s},Pt={class:"flex gap-1 items-center text-xs text-neutral-content px-2"},jt=K({__name:"TableBubbleMenu",props:{editor:{}},setup(e){const l=e,s=()=>{const{selection:t}=l.editor.state,{$from:r}=t;for(let M=r.depth;M>0;M--){const E=r.node(M);if(E.type.name==="table")return{node:E,pos:r.before(M)}}return null},i=()=>(s()?.node.attrs.class||"").split(" ").filter(Boolean),d=t=>i().includes(t),u=D(()=>d("table-bordered")),c=D(()=>d("table-striped")),f=D(()=>d("table-left")),a=D(()=>d("table-right")),x=t=>{const r=s();if(!r)return;t.some(E=>E.startsWith("table-"))&&!t.includes("table")&&t.unshift("table");const{tr:M}=l.editor.state;M.setNodeMarkup(r.pos,void 0,{...r.node.attrs,class:t.join(" ")||null}),l.editor.view.dispatch(M)},T=(t,r=[])=>{const M=i(),E=M.filter(R=>!r.includes(R));M.includes(t)?x(E.filter(R=>R!==t)):x([...E,t])},C=()=>T("table-bordered"),w=()=>T("table-striped"),k=()=>T("table-left",["table-right"]),$=()=>T("table-right",["table-left"]),m=()=>{l.editor.chain().focus().addColumnAfter().run()},F=()=>{l.editor.chain().focus().addRowAfter().run()},A=()=>{l.editor.chain().focus().deleteTable().run()},L=()=>{l.editor.chain().focus().deleteRow().run()},g=()=>{l.editor.chain().focus().deleteColumn().run()},o=()=>{l.editor.chain().focus().toggleHeaderRow().run()};return(t,r)=>(p(),b("div",Pt,[n("button",{onClick:v(m,["prevent"]),class:y(h(H)(!1)),title:"Add column"},[...r[0]||(r[0]=[n("i",{class:"fa-regular fa-table-columns","aria-hidden":"true"},null,-1),n("i",{class:"fa-regular fa-plus text-[8px]","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:v(F,["prevent"]),class:y(h(H)(!1)),title:"Add row"},[...r[1]||(r[1]=[n("i",{class:"fa-regular fa-table-rows","aria-hidden":"true"},null,-1),n("i",{class:"fa-regular fa-plus text-[8px]","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:v(g,["prevent"]),class:y(h(H)(!1)),title:"Delete column"},[...r[2]||(r[2]=[n("i",{class:"fa-regular fa-table-columns","aria-hidden":"true"},null,-1),n("i",{class:"fa-regular fa-minus text-[8px]","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:v(L,["prevent"]),class:y(h(H)(!1)),title:"Delete row"},[...r[3]||(r[3]=[n("i",{class:"fa-regular fa-table-rows","aria-hidden":"true"},null,-1),n("i",{class:"fa-regular fa-minus text-[8px]","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:v(o,["prevent"]),class:y(h(H)(!1)),title:"Toggle header row"},[...r[4]||(r[4]=[n("i",{class:"fa-regular fa-heading","aria-hidden":"true"},null,-1)])],2),r[10]||(r[10]=n("span",{class:"w-px h-4 bg-base-content/20 mx-1"},null,-1)),n("button",{onClick:v(C,["prevent"]),class:y(h(H)(u.value)),title:"Toggle bordered"},[...r[5]||(r[5]=[n("i",{class:"fa-regular fa-border-all","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:v(w,["prevent"]),class:y(h(H)(c.value)),title:"Toggle striped"},[...r[6]||(r[6]=[n("i",{class:"fa-regular fa-bars","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:v(k,["prevent"]),class:y(h(H)(f.value)),title:"Align left"},[...r[7]||(r[7]=[n("i",{class:"fa-regular fa-align-left","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:v($,["prevent"]),class:y(h(H)(a.value)),title:"Align right"},[...r[8]||(r[8]=[n("i",{class:"fa-regular fa-align-right","aria-hidden":"true"},null,-1)])],2),r[11]||(r[11]=n("span",{class:"w-px h-4 bg-base-content/20 mx-1"},null,-1)),n("button",{onClick:v(A,["prevent"]),class:"hover:text-error px-2 py-1",title:"Delete table"},[...r[9]||(r[9]=[n("i",{class:"fa-regular fa-trash","aria-hidden":"true"},null,-1)])])]))}}),Ut={class:"flex gap-1 items-center text-xs text-neutral-content px-2"},Kt={class:"flex items-center gap-0.5 border-r border-base-300 pr-2 mr-1"},Ot={class:"flex items-center gap-0.5 border-r border-base-300 pr-2 mr-1"},zt=K({__name:"ImageBubbleMenu",props:{editor:{}},setup(e){const l=e,s=f=>{l.editor.commands.setImageWidth(f)},i=f=>{l.editor.commands.setImageFloat(f)},d=()=>{l.editor.chain().focus().deleteSelection().run()},u=()=>l.editor.getAttributes("image").widthStyle||null,c=()=>l.editor.getAttributes("image").floatStyle||null;return(f,a)=>(p(),b("div",Ut,[n("div",Kt,[n("button",{onClick:a[0]||(a[0]=v(x=>s("25%"),["prevent"])),class:y(h(H)(u()==="25%")),title:"25% width"}," 25% ",2),n("button",{onClick:a[1]||(a[1]=v(x=>s("50%"),["prevent"])),class:y(h(H)(u()==="50%")),title:"50% width"}," 50% ",2),n("button",{onClick:a[2]||(a[2]=v(x=>s("100%"),["prevent"])),class:y(h(H)(u()==="100%")),title:"100% width"}," 100% ",2),n("button",{onClick:a[3]||(a[3]=v(x=>s(null),["prevent"])),class:y(h(H)(u()===null)),title:"Reset width"},[...a[7]||(a[7]=[n("i",{class:"fa-regular fa-undo","aria-hidden":"true"},null,-1)])],2)]),n("div",Ot,[n("button",{onClick:a[4]||(a[4]=v(x=>i("left"),["prevent"])),class:y(h(H)(c()==="left")),title:"Float left"},[...a[8]||(a[8]=[n("i",{class:"fa-regular fa-align-left","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:a[5]||(a[5]=v(x=>i("right"),["prevent"])),class:y(h(H)(c()==="right")),title:"Float right"},[...a[9]||(a[9]=[n("i",{class:"fa-regular fa-align-right","aria-hidden":"true"},null,-1)])],2),n("button",{onClick:a[6]||(a[6]=v(x=>i(null),["prevent"])),class:y(h(H)(c()===null)),title:"No float"},[...a[10]||(a[10]=[n("i",{class:"fa-regular fa-align-justify","aria-hidden":"true"},null,-1)])],2)]),n("button",{onClick:v(d,["prevent"]),class:"hover:text-error px-2 py-1",title:"Delete image"},[...a[11]||(a[11]=[n("i",{class:"fa-regular fa-trash","aria-hidden":"true"},null,-1)])])]))}}),Nt={class:"relative"},Vt=["title"],qt={class:"absolute top-full left-0 mt-1 bg-base-100 shadow-lg rounded-lg p-3 z-50 w-[220px]"},Wt={key:0,class:"mb-2"},Gt={class:"flex flex-wrap gap-1"},Zt=["onMousedown","title"],Jt={class:"mb-2"},Qt={class:"grid grid-cols-7 gap-1"},Xt=["onMousedown","title"],Yt={class:"mb-2"},_t=["onKeydown"],_="recent_colors",fe=10,ge=K({__name:"ColorPicker",props:{currentColor:{},icon:{},title:{}},emits:["select"],setup(e,{emit:l}){const s=e,i=l,d=Math.random().toString(36).substring(7),u=S(!1),c=S(""),f=S([]),a=["#000000","#434343","#666666","#999999","#cccccc","#efefef","#ffffff","#FB0300","#FF9900","#FFFF01","#00FF00","#00FFFF","#0000FF","#9900FF","#FB3533","#FFAD33","#FFFF34","#33FF33","#33FFFF","#3333FF","#AD33FF","#FC6866","#FFC266","#FFFF67","#66FF66","#66FFFF","#6666FF","#C266FF","#FD9B99","#FFD699","#FFFF9A","#99FF99","#99FFFF","#9999FF","#D699FF","#FECECC","#FFEBCC","#FFFFCD","#CCFFCC","#CCFFFF","#CCCCFF","#EBCCFF","#FEE1E0","#FFF3E0","#FFFFE1","#E0FFE0","#E0FFFF","#E0E0FF","#F3E0FF","#FFF5F4","#FFF9F4","#FFFFF5","#F4FFF4","#F4FFFF","#F4F4FF","#F9F4FF"],x=()=>document.cookie.split(";").reduce((g,o)=>{const[t,r]=o.split("=").map(M=>M.trim());return t&&r&&(g[t]=decodeURIComponent(r)),g},{}),T=(g,o,t=30)=>{const r=new Date;r.setTime(r.getTime()+t*24*60*60*1e3),document.cookie=`${g}=${encodeURIComponent(o)}; expires=${r.toUTCString()}; path=/`},C=()=>{const g=x();f.value=g[_]?JSON.parse(g[_]):[]},w=g=>{f.value=[g,...f.value.filter(o=>o!==g)],f.value.length>fe&&(f.value=f.value.slice(0,fe)),T(_,JSON.stringify(f.value))},k=g=>{w(g),i("select",g),u.value=!1},$=()=>{c.value&&/^#[0-9A-Fa-f]{6}$/.test(c.value)&&(k(c.value),c.value="")},m=()=>{i("select",null),u.value=!1},F=g=>{g.detail!==d&&(u.value=!1)},A=()=>{u.value||(window.dispatchEvent(new CustomEvent("colorpicker:close",{detail:d})),C()),u.value=!u.value},L=D(()=>!!s.currentColor);return xe(()=>{C(),window.addEventListener("colorpicker:close",F)}),we(()=>{window.removeEventListener("colorpicker:close",F)}),(g,o)=>(p(),b("div",Nt,[n("button",{onClick:v(A,["prevent"]),class:y([h(H)(L.value),"flex items-center gap-0.5"]),title:e.title},[n("i",{class:y(e.icon),"aria-hidden":"true"},null,2),e.currentColor?(p(),b("span",{key:0,class:"w-2 h-2 rounded-full border border-base-300",style:Y({backgroundColor:e.currentColor})},null,4)):I("",!0)],10,Vt),O(n("div",qt,[f.value.length>0?(p(),b("div",Wt,[o[1]||(o[1]=n("div",{class:"text-xs text-neutral-content mb-1"},"Recent",-1)),n("div",Gt,[(p(!0),b(j,null,W(f.value,t=>(p(),b("button",{key:t,onMousedown:v(r=>k(t),["prevent"]),class:"w-5 h-5 rounded border border-base-300 hover:scale-110 transition-transform",style:Y({backgroundColor:t}),title:t},null,44,Zt))),128))])])):I("",!0),n("div",Jt,[o[2]||(o[2]=n("div",{class:"text-xs text-neutral-content mb-1"},"Colors",-1)),n("div",Qt,[(p(),b(j,null,W(a,t=>n("button",{key:t,onMousedown:v(r=>k(t),["prevent"]),class:"w-5 h-5 rounded border border-base-300 hover:scale-110 transition-transform",style:Y({backgroundColor:t}),title:t},null,44,Xt)),64))])]),n("div",Yt,[O(n("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>c.value=t),type:"text",placeholder:"#000000",maxlength:"7",class:"w-full p-1 text-xs rounded border border-base-300 outline-none focus:ring-1 focus:ring-primary",onKeydown:Me(v($,["prevent"]),["enter"]),onBlur:$},null,40,_t),[[J,c.value]])]),n("button",{onMousedown:v(m,["prevent"]),class:"w-full text-xs text-neutral-content hover:text-error py-1 flex items-center justify-center gap-1 cursor-pointer"},[...o[3]||(o[3]=[n("i",{class:"fa-regular fa-eraser","aria-hidden":"true"},null,-1),B(" Remove color ",-1)])],32)],512),[[te,u.value]])]))}}),en={class:"relative"},tn={key:0,class:"text-xs"},nn=["innerHTML"],sn={key:0,class:"fa-regular fa-check"},ln={key:0,class:"fa-regular fa-check"},rn={key:0,class:"fa-regular fa-check"},on={key:0,class:"fa-regular fa-check"},an={key:0,class:"fa-regular fa-check"},un={key:0,class:"fa-regular fa-check"},dn={class:"flex items-center gap-0.5 border-r border-base-300 pr-2 mr-1"},cn={class:"flex items-center gap-0.5 border-r border-base-300 pr-2 mr-1"},fn={class:"relative"},gn={key:0,class:"fa-regular fa-check"},mn={key:0,class:"fa-regular fa-check"},pn=K({__name:"TextBubbleMenu",props:{editor:{}},emits:["openLink"],setup(e,{emit:l}){const s=e,i=l,d=S(!1),u=S(!1),c=D(()=>s.editor.getAttributes("textStyle").color||null),f=D(()=>s.editor.getAttributes("highlight").color||null),a=o=>{o?s.editor.chain().focus().setColor(o).run():s.editor.chain().focus().unsetColor().run()},x=o=>{o?s.editor.chain().focus().setHighlight({color:o}).run():s.editor.chain().focus().unsetHighlight().run()},T=D(()=>!s.editor||s.editor.isActive("paragraph")?"fa-regular fa-paragraph":"fa-regular fa-heading"),C=()=>s.editor.isActive("heading",{level:1})?"1":s.editor.isActive("heading",{level:2})?"2":s.editor.isActive("heading",{level:3})?"3":s.editor.isActive("heading",{level:4})?"4":s.editor.isActive("heading",{level:5})?"5":0,w=o=>{o===null?s.editor.chain().focus().setParagraph().run():s.editor.chain().focus().toggleHeading({level:o}).run(),d.value=!1},k=()=>{d.value=!d.value},$=()=>{d.value=!1},m=D(()=>s.editor?s.editor.isActive("bulletList")?"fa-regular fa-list-ul":s.editor.isActive("orderedList")?"fa-regular fa-list-ol":"fa-regular fa-list-ul":"fa-regular fa-list-ol"),F=o=>{o==="bullet"?s.editor.chain().focus().toggleBulletList().run():s.editor.chain().focus().toggleOrderedList().run(),u.value=!1},A=()=>{u.value=!u.value},L=()=>{u.value=!1},g=()=>{s.editor.chain().focus().unsetAllMarks().clearNodes().run()};return(o,t)=>(p(),b(j,null,[n("div",en,[n("button",{onClick:v(k,["prevent"]),class:y([h(H)(!1),"flex items-center gap-0.5"]),onBlur:$},[n("i",{class:y(T.value)},null,2),e.editor.isActive("heading")?(p(),b("sub",tn,[n("span",{innerHTML:C()},null,8,nn)])):I("",!0),t[16]||(t[16]=n("i",{class:"fa-regular fa-chevron-down","aria-label":"Toggle paragraph styles"},null,-1))],34),O(n("div",{class:"absolute top-full left-0 mt-1 bg-base-100 shadow-lg rounded-lg py-1 z-50 min-w-[200px]",onMousedown:t[6]||(t[6]=v(()=>{},["prevent"]))},[n("button",{onClick:t[0]||(t[0]=v(r=>w(null),["prevent"])),class:y(["block w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content text-xs flex items-center justify-between gap-1",{"text-semibold text-base-content":e.editor.isActive("paragraph")}])},[t[17]||(t[17]=B(" Paragraph ",-1)),e.editor.isActive("paragraph")?(p(),b("i",sn)):I("",!0)],2),n("button",{onClick:t[1]||(t[1]=v(r=>w(1),["prevent"])),class:y(["block w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content flex items-center justify-between gap-1 text-[1.4rem]",{"font-semibold text-base-content":e.editor.isActive("heading",{level:1})}])},[t[18]||(t[18]=B(" Heading 1 ",-1)),e.editor.isActive("heading",{level:1})?(p(),b("i",ln)):I("",!0)],2),n("button",{onClick:t[2]||(t[2]=v(r=>w(2),["prevent"])),class:y(["block w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content flex items-center justify-between gap-1 text-[1.3rem]",{"font-semibold text-base-content":e.editor.isActive("heading",{level:2})}])},[t[19]||(t[19]=B(" Heading 2 ",-1)),e.editor.isActive("heading",{level:2})?(p(),b("i",rn)):I("",!0)],2),n("button",{onClick:t[3]||(t[3]=v(r=>w(3),["prevent"])),class:y(["block w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content flex items-center justify-between gap-1 text-[1.2rem]",{"font-semibold text-base-content":e.editor.isActive("heading",{level:3})}])},[t[20]||(t[20]=B(" Heading 3 ",-1)),e.editor.isActive("heading",{level:3})?(p(),b("i",on)):I("",!0)],2),n("button",{onClick:t[4]||(t[4]=v(r=>w(4),["prevent"])),class:y(["w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content text-xs flex items-center justify-between gap-1 text[1.1rem]",{"font-semibold text-base-content":e.editor.isActive("heading",{level:4})}])},[t[21]||(t[21]=B(" Heading 4 ",-1)),e.editor.isActive("heading",{level:4})?(p(),b("i",an)):I("",!0)],2),n("button",{onClick:t[5]||(t[5]=v(r=>w(5),["prevent"])),class:y(["w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content text-xs flex items-center justify-between gap-1",{"font-semibold text-base-content":e.editor.isActive("heading",{level:5})}])},[t[22]||(t[22]=B(" Heading 5 ",-1)),e.editor.isActive("heading",{level:5})?(p(),b("i",un)):I("",!0)],2)],544),[[te,d.value]])]),n("button",{onClick:t[7]||(t[7]=v(r=>e.editor.chain().focus().toggleBold().run(),["prevent"])),class:y(h(H)(e.editor.isActive("bold")))},[...t[23]||(t[23]=[n("i",{class:"fa-regular fa-bold","aria-label":"Bold"},null,-1)])],2),n("button",{onClick:t[8]||(t[8]=v(r=>e.editor.chain().focus().toggleItalic().run(),["prevent"])),class:y(h(H)(e.editor.isActive("italic")))},[...t[24]||(t[24]=[n("i",{class:"fa-regular fa-italic","aria-label":"Italic"},null,-1)])],2),n("button",{onClick:t[9]||(t[9]=v(r=>e.editor.chain().focus().toggleStrike().run(),["prevent"])),class:y(h(H)(e.editor.isActive("strike")))},[...t[25]||(t[25]=[n("i",{class:"fa-regular fa-strikethrough","aria-label":"Strikethrough"},null,-1)])],2),n("button",{onClick:t[10]||(t[10]=v(r=>e.editor.chain().focus().toggleUnderline().run(),["prevent"])),class:y(h(H)(e.editor.isActive("underline")))},[...t[26]||(t[26]=[n("i",{class:"fa-regular fa-underline","aria-label":"Underline"},null,-1)])],2),n("div",dn,[P(ge,{"current-color":c.value,icon:"fa-regular fa-font",title:"Text color",onSelect:a},null,8,["current-color"]),P(ge,{"current-color":f.value,icon:"fa-regular fa-fill",title:"Highlight color",onSelect:x},null,8,["current-color"])]),n("div",cn,[n("button",{onClick:t[11]||(t[11]=v(r=>i("openLink"),["prevent"])),class:y(h(H)(e.editor.isActive("link")))},[...t[27]||(t[27]=[n("i",{class:"fa-regular fa-link","aria-label":"Link"},null,-1)])],2),n("button",{onClick:t[12]||(t[12]=v(r=>e.editor.chain().focus().toggleBlockquote().run(),["prevent"])),class:y(h(H)(e.editor.isActive("blockquote")))},[...t[28]||(t[28]=[n("i",{class:"fa-regular fa-quote-right","aria-label":"Quote"},null,-1)])],2),n("div",fn,[n("button",{onClick:v(A,["prevent"]),class:y([h(H)(!1),"flex items-center gap-0.5"]),onBlur:L},[n("i",{class:y(m.value)},null,2),t[29]||(t[29]=n("i",{class:"fa-regular fa-chevron-down","aria-label":"Toggle paragraph styles"},null,-1))],34),O(n("div",{class:"absolute top-full left-0 mt-1 bg-base-100 shadow-lg rounded-lg py-1 z-50 min-w-[200px]",onMousedown:t[15]||(t[15]=v(()=>{},["prevent"]))},[n("button",{onClick:t[13]||(t[13]=v(r=>F("bullet"),["prevent"])),class:y(["block w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content text-xs flex items-center justify-between gap-1",{"text-semibold text-base-content":e.editor.isActive("bulletList")}])},[t[30]||(t[30]=n("div",{class:"flex gap-1 items-center"},[n("i",{class:"fa-regular fa-list-ul","aria-hidden":"true"}),B(" List ")],-1)),e.editor.isActive("bulletList")?(p(),b("i",gn)):I("",!0)],2),n("button",{onClick:t[14]||(t[14]=v(r=>F("ordered"),["prevent"])),class:y(["block w-full text-left px-3 py-2 hover:bg-base-200 text-neutral-content text-xs flex items-center justify-between gap-1",{"text-semibold text-base-content":e.editor.isActive("orderedList")}])},[t[31]||(t[31]=n("div",{class:"flex gap-1 items-center"},[n("i",{class:"fa-regular fa-list-ol","aria-hidden":"true"}),B(" Numbered list ")],-1)),e.editor.isActive("orderedList")?(p(),b("i",mn)):I("",!0)],2)],544),[[te,u.value]])])]),n("button",{onClick:v(g,["prevent"]),class:y(h(H)(!1)),title:"Clear formatting"},[...t[32]||(t[32]=[n("i",{class:"fa-regular fa-paint-roller","aria-label":"Clear formatting"},null,-1)])],2)],64))}}),bn={class:"bubble-menu bg-base-100 shadow rounded-2xl flex gap-0.5 items-center px-2 py-2"},hn={class:"bubble-menu bg-base-100 shadow rounded-2xl flex gap-0.5 items-center px-2 py-2"},vn={class:"bubble-menu bg-base-100 shadow rounded-2xl flex gap-0.5 items-center px-2 py-2"},yn={class:"bubble-menu bg-base-100 shadow rounded-2xl flex gap-0.5 items-center px-2 py-2"},xn={class:"bubble-menu bg-base-100 shadow rounded-2xl flex gap-0.5 items-center px-2 py-2"},wn={key:1,class:"text-neutral-content text-xs mt-2 flex items-center gap-5"},kn=["name","value"],Cn=K({__name:"Tiptap",props:{modelValue:{},content:{},gallery:{},mentions:{},fieldName:{default:"entry"}},setup(e){const l=ue(()=>re(()=>import("./GalleryDialog-B9joQH7N.js"),__vite__mapDeps([0,1,2,3,4]))),s=ue(()=>re(()=>import("./SourceEditor-DGWxyXMw.js"),__vite__mapDeps([5,1,3,6]))),i=e,d=S(i.content??i.modelValue??""),u=S([]),c=S(!1),f=S(!1),a=S(!1),x=D(()=>c.value&&!f.value&&m.value?.isEmpty),T=()=>{a.value=!0},C=()=>{m.value?.commands.setContent(d.value),a.value=!1,setTimeout(()=>{m.value?.commands.focus()},50)},w=S(null),k=o=>{u.value.find(r=>r.id===o.id)||u.value.push(o)},$=[Se.configure({link:!1,bulletList:!1,orderedList:!1,listItem:!1,listKeymap:!1}),Re.configure({placeholder:"Start writing..."}),Be.configure({openOnClick:!1,defaultProtocol:"https",HTMLAttributes:{class:"text-link"}}),De.configure({taskItem:{nested:!0}}),Ve.configure({resizable:!0}),Te,Pe.configure({}),je.configure({}),ft.configure({suggestion:Ft()}),Lt.configure({inline:!0,allowBase64:!1,resize:{enabled:!0,minWidth:20,minHeight:20,alwaysPreserveAspectRatio:!0}}),Mt,Tt,Ue.configure({persist:!0,HTMLAttributes:{class:"details"}}),$e,He,Ee,Ie,Ke.configure({multicolor:!0})];i.gallery&&$.push(At.configure({galleryUrl:i.gallery})),i.mentions&&$.push(We.configure({HTMLAttributes:{class:"mention"},suggestion:at(i.mentions,k),renderText({node:o}){const t=o.attrs.mention,r=o.attrs.label,M=o.attrs.id,E=o.attrs.config,R=t?.match(/\[([^:]+):(\d+)/),U=R?R[1]:null;if(U&&M){const z=u.value.find(X=>X.id===parseInt(M)),G=z?z.name:null,N=[`${U}:${M}`];return r&&G&&r!==G&&N.push(r),E&&N.push(E),`[${N.join("|")}]`}return t||`[${r}]`}}),dt.configure({entities:u}));const m=Oe({content:d.value,extensions:$,onFocus:()=>{c.value=!0},onBlur:()=>{c.value=!1},onUpdate:({editor:o})=>{d.value=o.getHTML().replace(/<table([^>]*) data-table-class="([^"]+)"([^>]*)>/g,'<table$1 class="$2"$3>'),!f.value&&!o.isEmpty&&(f.value=!0)},onSelectionUpdate:({editor:o})=>{o.isActive("mention")&&w.value?.syncLabel()},editorProps:{clipboardTextSerializer:o=>{let t="";return o.content.forEach(r=>{t+=F(r)}),t},handlePaste:(o,t,r)=>{const M=t.clipboardData?.getData("text/plain")||"",E=t.clipboardData?.getData("text/html")||"";if((E||M).match(/<iframe[^>]*src=["']([^"']+)["'][^>]*>/i)||M.includes("<iframe")){const z=E||M;return m.value?.commands.insertContent(z,{parseOptions:{preserveWhitespace:!1}}),!0}return/\[([a-zA-Z_]+):(\d+)(?:\|[^\]]+)?\]/.test(M)?(m.value?.commands.insertContent(M),!0):!1},handleKeyDown:(o,t)=>(t.ctrlKey||t.metaKey)&&t.key==="k"&&!o.state.selection.empty?(t.preventDefault(),L(),!0):!1}}),F=o=>{if(o.type.name==="mention")return A(o);if(o.isText)return o.text||"";let t="";return o.content&&o.content.forEach(r=>{t+=F(r)}),o.isBlock&&t&&(t+=`
`),t},A=o=>{const t=o.attrs.config,r=o.attrs.id,E=[`${o.attrs.type}:${r}`];return t&&E.push(t),`[${E.join("|")}]`},L=()=>{if(!m.value)return;const o=m.value.getAttributes("link").href||"",{to:t}=m.value.state.selection;m.value.chain().focus().setLink({href:o}).setTextSelection(t).run()},g=o=>{const t=[],r=[],M=/\[([a-zA-Z_]+):(\d+)(?:\|[^\]]+)?\]/g;let E;for(;(E=M.exec(o))!==null;){const R=E[1],U=parseInt(E[2],10);R==="post"?r.includes(U)||r.push(U):t.includes(U)||t.push(U)}return{entityIds:t,postIds:r}};return xe(()=>{if(window.addEventListener("tiptap:source-mode",T),i.mentions&&i.content){const{entityIds:o,postIds:t}=g(i.content);(o.length>0||t.length>0)&&axios.post(i.mentions,{entities:o,posts:t}).then(r=>{u.value=r.data,m.value?.commands.setContent(i.content)})}}),we(()=>{window.removeEventListener("tiptap:source-mode",T),m?.value.destroy()}),(o,t)=>(p(),b(j,null,[a.value?(p(),oe(h(s),{key:0,modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=r=>d.value=r),onExit:C},null,8,["modelValue"])):(p(),b(j,{key:1},[h(m)?(p(),b(j,{key:0},[P(h(q),{editor:h(m),"plugin-key":"mentionBubbleMenu","should-show":({editor:r})=>r.isActive("mention")},{default:V(()=>[n("div",bn,[P(St,{ref_key:"mentionBubbleRef",ref:w,editor:h(m),mentions:u.value},null,8,["editor","mentions"])])]),_:1},8,["editor","should-show"]),P(h(q),{editor:h(m),"plugin-key":"linkBubbleMenu","should-show":({editor:r})=>r.isActive("link")&&r.state.selection.empty},{default:V(()=>[n("div",hn,[P(Dt,{editor:h(m)},null,8,["editor"])])]),_:1},8,["editor","should-show"]),P(h(q),{editor:h(m),"plugin-key":"tableBubbleMenu","should-show":({editor:r})=>r.state.selection instanceof h(ae)},{default:V(()=>[n("div",vn,[P(jt,{editor:h(m)},null,8,["editor"])])]),_:1},8,["editor","should-show"]),P(h(q),{editor:h(m),"plugin-key":"imageBubbleMenu","should-show":({editor:r})=>r.isActive("image")},{default:V(()=>[n("div",yn,[P(zt,{editor:h(m)},null,8,["editor"])])]),_:1},8,["editor","should-show"]),P(h(q),{editor:h(m),"plugin-key":"textBubbleMenu","should-show":({editor:r})=>!(r.state.selection.empty||r.isActive("mention")||r.state.selection instanceof h(ae)||r.isActive("image"))},{default:V(()=>[n("div",xn,[P(pn,{editor:h(m),onOpenLink:L},null,8,["editor"])])]),_:1},8,["editor","should-show"])],64)):I("",!0),P(h(ze),{editor:h(m)},null,8,["editor"]),x.value?(p(),b("p",wn,[...t[1]||(t[1]=[n("span",null,[B(" Use "),n("kbd",null,"@"),B(" to reference entities ")],-1),n("span",null,[n("kbd",null,"/"),B(" for commands ")],-1)])])):I("",!0)],64)),n("input",{type:"hidden",name:i.fieldName,value:d.value},null,8,kn),e.gallery?(p(),oe(h(l),{key:2})):I("",!0)],64))}}),Tn=ie(Cn,[["__scopeId","data-v-ac1b8e2a"]]);export{Tn as default};

let p,v,d,i,c,l,a,y,r,m;const h=document.getElementById("subscribe-confirm"),L=()=>{f(),q(),I(),window.onEvent(function(){b()})},f=()=>{const t=document.getElementById("stripe-token");p=Stripe(t.value),v=p.elements()},b=()=>{var e;if(i=document.querySelector(".subscription-confirm-button"),document.getElementById("card-element")){if(!d){let s={base:{color:"#555555",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"14px","::placeholder":{color:"#777777"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}};d=v.create("card",{hidePostalCode:!0,style:s})}d.mount("#card-element")}(e=document.getElementById("subscription-confirm"))==null||e.addEventListener("submit",E),c=document.getElementById("coupon-check"),c&&(l=document.getElementById("coupon-success"),a=document.getElementById("coupon-invalid"),y=document.getElementById("coupon"),r=document.getElementById("coupon-validating"),m=document.querySelector(".paypal-coupon"),c.addEventListener("change",g),c.addEventListener("focusout",g));const n=document.querySelector('select[name="select-method"]');n&&n.addEventListener("change",S)},S=t=>{console.log("changing method to",t.target.value);const n=document.querySelector("#card-panel"),e=document.querySelector("#paypal-panel");t.target.value==="paypal"?(n.classList.add("hidden"),e.classList.remove("hidden")):(n.classList.remove("hidden"),e.classList.add("hidden"))},g=t=>{const n=t.target,e=n.value,s=n.dataset.url;e||(i.classList.remove("btn-disabled","loading"),i.disabled=!1),r.classList.remove("hidden"),fetch(s+"?coupon="+e).then(o=>o.json()).then(o=>{if(i.classList.remove("btn-disabled","loading"),i.disabled=!1,r.classList.add("hidden"),!o.valid){l.classList.add("hidden"),a.innerHTML=o.error,a.classList.remove("hidden"),y.value="",h.classList.remove("valid-coupon"),m.classList.add("hidden");return}document.getElementById("pricing-now").innerHTML=o.price,a.classList.add("hidden"),l.innerHTML=o.discount,l.classList.remove("hidden"),y.value=o.coupon,h.classList.add("valid-coupon"),m.classList.remove("hidden")}).catch(o=>{r.classList.add("hidden"),o.responseJSON&&(a.innerHTML=o.responseJSON.message,a.classList.remove("hidden")),m.classList.add("hidden")})},E=t=>{const n=t.target;t.preventDefault(),B(t);const e=document.querySelector('input[name="subscription-intent-token"]'),s=document.querySelector(".alert-error");s.classList.add("hidden");const o=document.querySelector('input[name="payment_id"]');if(o.value)return n.submit(),!1;p.confirmCardSetup(e.value,{payment_method:{card:d,billing_details:{name:document.querySelector('input[name="card-holder-name"]').value}}}).then((function(u){if(u.error)return i.classList.remove("disabled","loading"),i.disabled="",s.innerHTML=u.error.message,s.classList.remove("hidden"),!1;o.value=u.setupIntent.payment_method,n.submit()}).bind(void 0))},q=()=>{const t=document.getElementById("pricing-overview"),n=document.querySelector('[data-period="yearly"]'),e=document.querySelector('[data-period="monthly"]'),s=document.querySelectorAll("[data-period]");s==null||s.forEach(o=>{o.addEventListener("click",function(){this.dataset.period==="monthly"?(n.classList.remove("bg-base-100"),n.classList.add("text-neutral-content"),e.classList.add("bg-base-100"),e.classList.remove("text-neutral-content"),t.classList.remove("period-year"),t.classList.add("period-month")):this.dataset.period==="yearly"&&(e.classList.remove("bg-base-100"),e.classList.add("text-neutral-content"),n.classList.add("bg-base-100"),n.classList.remove("text-neutral-content"),t.classList.remove("period-month"),t.classList.add("period-year"))})})},B=t=>{const e=t.target.querySelector(".subscription-confirm-button");return e.classList.add("disabled","loading"),e.disabled=!0,!0},I=()=>{const t=document.querySelectorAll(".price-monthly"),n=document.querySelectorAll(".price-yearly");t.forEach(e=>{e.addEventListener("click",()=>{let s={item_id:e.dataset.id,item_name:e.dataset.name,item_price:e.dataset.price};console.log("log",s),gtag("event","select_item",{items:[s]})})}),n.forEach(e=>{e.addEventListener("click",()=>{let s={item_id:e.dataset.id,item_name:e.dataset.name,item_price:e.dataset.price};console.log("log",s),gtag("event","select_item",{items:[s]})})})};L();
